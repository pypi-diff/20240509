# Comparing `tmp/mapteksdk-1.6-py3-none-any.whl.zip` & `tmp/mapteksdk-1.7-py3-none-any.whl.zip`

## zipinfo {}

```diff
@@ -1,152 +1,178 @@
-Zip file size: 599701 bytes, number of entries: 150
--rw-rw-rw-  2.0 fat      624 b- defN 23-Oct-23 05:57 mapteksdk/__init__.py
--rw-rw-rw-  2.0 fat     4704 b- defN 23-Oct-23 05:57 mapteksdk/context_menu.py
--rw-rw-rw-  2.0 fat     6028 b- defN 23-Oct-23 05:57 mapteksdk/geometry.py
--rw-rw-rw-  2.0 fat    56176 b- defN 23-Oct-23 05:57 mapteksdk/operations.py
--rw-rw-rw-  2.0 fat     1255 b- defN 23-Oct-23 05:57 mapteksdk/overwrite_modes.py
--rw-rw-rw-  2.0 fat    36512 b- defN 23-Oct-23 05:57 mapteksdk/view.py
--rw-rw-rw-  2.0 fat     1175 b- defN 23-Oct-23 05:57 mapteksdk/capi/__init__.py
--rw-rw-rw-  2.0 fat    29118 b- defN 23-Oct-23 05:57 mapteksdk/capi/dataengine.py
--rw-rw-rw-  2.0 fat    52807 b- defN 23-Oct-23 05:57 mapteksdk/capi/drillholemodel.py
--rw-rw-rw-  2.0 fat     1679 b- defN 23-Oct-23 05:57 mapteksdk/capi/feedback.py
--rw-rw-rw-  2.0 fat     4636 b- defN 23-Oct-23 05:57 mapteksdk/capi/license.py
--rw-rw-rw-  2.0 fat     6458 b- defN 23-Oct-23 05:57 mapteksdk/capi/mcp.py
--rw-rw-rw-  2.0 fat   121047 b- defN 23-Oct-23 05:57 mapteksdk/capi/modelling.py
--rw-rw-rw-  2.0 fat     2076 b- defN 23-Oct-23 05:57 mapteksdk/capi/preference.py
--rw-rw-rw-  2.0 fat     2111 b- defN 23-Oct-23 05:57 mapteksdk/capi/reportwindow.py
--rw-rw-rw-  2.0 fat    11011 b- defN 23-Oct-23 05:57 mapteksdk/capi/scan.py
--rw-rw-rw-  2.0 fat     3335 b- defN 23-Oct-23 05:57 mapteksdk/capi/sdp.py
--rw-rw-rw-  2.0 fat     1346 b- defN 23-Oct-23 05:57 mapteksdk/capi/selection.py
--rw-rw-rw-  2.0 fat     2290 b- defN 23-Oct-23 05:57 mapteksdk/capi/system.py
--rw-rw-rw-  2.0 fat     7703 b- defN 23-Oct-23 05:57 mapteksdk/capi/topology.py
--rw-rw-rw-  2.0 fat     4747 b- defN 23-Oct-23 05:57 mapteksdk/capi/translation.py
--rw-rw-rw-  2.0 fat     5355 b- defN 23-Oct-23 05:57 mapteksdk/capi/types.py
--rw-rw-rw-  2.0 fat    15296 b- defN 23-Oct-23 05:57 mapteksdk/capi/util.py
--rw-rw-rw-  2.0 fat     2963 b- defN 23-Oct-23 05:57 mapteksdk/capi/viewer.py
--rw-rw-rw-  2.0 fat     8983 b- defN 23-Oct-23 05:57 mapteksdk/capi/visualisation.py
--rw-rw-rw-  2.0 fat     1512 b- defN 23-Oct-23 05:57 mapteksdk/capi/vulcan.py
--rw-rw-rw-  2.0 fat    11547 b- defN 23-Oct-23 05:57 mapteksdk/capi/wrapper_base.py
--rw-rw-rw-  2.0 fat     2768 b- defN 23-Oct-23 05:57 mapteksdk/common/__init__.py
--rw-rw-rw-  2.0 fat     7869 b- defN 23-Oct-23 05:57 mapteksdk/common/typing.py
--rw-rw-rw-  2.0 fat     2000 b- defN 23-Oct-23 05:57 mapteksdk/data/__init__.py
--rw-rw-rw-  2.0 fat    36031 b- defN 23-Oct-23 05:57 mapteksdk/data/annotations.py
--rw-rw-rw-  2.0 fat    64452 b- defN 23-Oct-23 05:57 mapteksdk/data/base.py
--rw-rw-rw-  2.0 fat    38749 b- defN 23-Oct-23 05:57 mapteksdk/data/blocks.py
--rw-rw-rw-  2.0 fat    21667 b- defN 23-Oct-23 05:57 mapteksdk/data/cells.py
--rw-rw-rw-  2.0 fat     4990 b- defN 23-Oct-23 05:57 mapteksdk/data/change_reasons.py
--rw-rw-rw-  2.0 fat    39993 b- defN 23-Oct-23 05:57 mapteksdk/data/colourmaps.py
--rw-rw-rw-  2.0 fat    35213 b- defN 23-Oct-23 05:57 mapteksdk/data/containers.py
--rw-rw-rw-  2.0 fat    12020 b- defN 23-Oct-23 05:57 mapteksdk/data/coordinate_systems.py
--rw-rw-rw-  2.0 fat    14132 b- defN 23-Oct-23 05:57 mapteksdk/data/edges.py
--rw-rw-rw-  2.0 fat     6239 b- defN 23-Oct-23 05:57 mapteksdk/data/ellipsoid.py
--rw-rw-rw-  2.0 fat     2687 b- defN 23-Oct-23 05:57 mapteksdk/data/errors.py
--rw-rw-rw-  2.0 fat    13404 b- defN 23-Oct-23 05:57 mapteksdk/data/facets.py
--rw-rw-rw-  2.0 fat    35833 b- defN 23-Oct-23 05:57 mapteksdk/data/filled_polygon.py
--rw-rw-rw-  2.0 fat    21286 b- defN 23-Oct-23 05:57 mapteksdk/data/geotechnical.py
--rw-rw-rw-  2.0 fat    23064 b- defN 23-Oct-23 05:57 mapteksdk/data/image_registration.py
--rw-rw-rw-  2.0 fat     4424 b- defN 23-Oct-23 05:57 mapteksdk/data/image_registration_interface.py
--rw-rw-rw-  2.0 fat    22187 b- defN 23-Oct-23 05:57 mapteksdk/data/images.py
--rw-rw-rw-  2.0 fat    10081 b- defN 23-Oct-23 05:57 mapteksdk/data/io.py
--rw-rw-rw-  2.0 fat    20056 b- defN 23-Oct-23 05:57 mapteksdk/data/objectid.py
--rw-rw-rw-  2.0 fat    15339 b- defN 23-Oct-23 05:57 mapteksdk/data/points.py
--rw-rw-rw-  2.0 fat     1069 b- defN 23-Oct-23 05:57 mapteksdk/data/primitive_type.py
--rw-rw-rw-  2.0 fat    14383 b- defN 23-Oct-23 05:57 mapteksdk/data/ribbons.py
--rw-rw-rw-  2.0 fat    10533 b- defN 23-Oct-23 05:57 mapteksdk/data/rotation.py
--rw-rw-rw-  2.0 fat    58052 b- defN 23-Oct-23 05:57 mapteksdk/data/scans.py
--rw-rw-rw-  2.0 fat     9343 b- defN 23-Oct-23 05:57 mapteksdk/data/units.py
--rw-rw-rw-  2.0 fat      771 b- defN 23-Oct-23 05:57 mapteksdk/data/primitives/__init__.py
--rw-rw-rw-  2.0 fat    13600 b- defN 23-Oct-23 05:57 mapteksdk/data/primitives/attribute_key.py
--rw-rw-rw-  2.0 fat    31898 b- defN 23-Oct-23 05:57 mapteksdk/data/primitives/block_properties.py
--rw-rw-rw-  2.0 fat    12630 b- defN 23-Oct-23 05:57 mapteksdk/data/primitives/cell_properties.py
--rw-rw-rw-  2.0 fat    11187 b- defN 23-Oct-23 05:57 mapteksdk/data/primitives/edge_properties.py
--rw-rw-rw-  2.0 fat    14345 b- defN 23-Oct-23 05:57 mapteksdk/data/primitives/facet_properties.py
--rw-rw-rw-  2.0 fat    26201 b- defN 23-Oct-23 05:57 mapteksdk/data/primitives/point_properties.py
--rw-rw-rw-  2.0 fat    35742 b- defN 23-Oct-23 05:57 mapteksdk/data/primitives/primitive_attributes.py
--rw-rw-rw-  2.0 fat     1156 b- defN 23-Oct-23 05:57 mapteksdk/geologycore/__init__.py
--rw-rw-rw-  2.0 fat    23637 b- defN 23-Oct-23 05:57 mapteksdk/geologycore/database.py
--rw-rw-rw-  2.0 fat     3438 b- defN 23-Oct-23 05:57 mapteksdk/geologycore/desurvey_method.py
--rw-rw-rw-  2.0 fat    27288 b- defN 23-Oct-23 05:57 mapteksdk/geologycore/drillholes.py
--rw-rw-rw-  2.0 fat    12021 b- defN 23-Oct-23 05:57 mapteksdk/geologycore/errors.py
--rw-rw-rw-  2.0 fat    27367 b- defN 23-Oct-23 05:57 mapteksdk/geologycore/fields.py
--rw-rw-rw-  2.0 fat    13584 b- defN 23-Oct-23 05:57 mapteksdk/geologycore/operations.py
--rw-rw-rw-  2.0 fat    61557 b- defN 23-Oct-23 05:57 mapteksdk/geologycore/tables.py
--rw-rw-rw-  2.0 fat      410 b- defN 23-Oct-23 05:57 mapteksdk/geologycore/internal/__init__.py
--rw-rw-rw-  2.0 fat     1922 b- defN 23-Oct-23 05:57 mapteksdk/geologycore/internal/constants.py
--rw-rw-rw-  2.0 fat    11722 b- defN 23-Oct-23 05:57 mapteksdk/geologycore/internal/tables_mixin.py
--rw-rw-rw-  2.0 fat    20992 b- defN 23-Oct-23 06:25 mapteksdk/internal/Logging.dll
--rw-rw-rw-  2.0 fat    16384 b- defN 23-Oct-23 06:25 mapteksdk/internal/LoggingInterface.dll
--rw-rw-rw-  2.0 fat    98304 b- defN 23-Oct-23 06:25 mapteksdk/internal/MaptekAccountBrokerConnector.dll
--rw-rw-rw-  2.0 fat    40448 b- defN 23-Oct-23 06:25 mapteksdk/internal/MaptekAccountBrokerInterfaces.dll
--rw-rw-rw-  2.0 fat    27136 b- defN 23-Oct-23 06:25 mapteksdk/internal/MaptekAccountBrokerServiceInterfaces.dll
--rw-rw-rw-  2.0 fat    83968 b- defN 23-Oct-23 06:25 mapteksdk/internal/MaptekBindingSupport.dll
--rw-rw-rw-  2.0 fat    11776 b- defN 23-Oct-23 06:25 mapteksdk/internal/MaptekWCFSupport.dll
--rw-rw-rw-  2.0 fat     8192 b- defN 23-Oct-23 06:25 mapteksdk/internal/NotificationInterface.dll
--rw-rw-rw-  2.0 fat     5632 b- defN 23-Oct-23 06:25 mapteksdk/internal/ResourceManagement.dll
--rw-rw-rw-  2.0 fat      449 b- defN 23-Oct-23 05:57 mapteksdk/internal/__init__.py
--rw-rw-rw-  2.0 fat     8533 b- defN 23-Oct-23 05:57 mapteksdk/internal/account.py
--rw-rw-rw-  2.0 fat    17689 b- defN 23-Oct-23 05:57 mapteksdk/internal/backends.py
--rw-rw-rw-  2.0 fat     1786 b- defN 23-Oct-23 05:57 mapteksdk/internal/before_undo_state.py
--rw-rw-rw-  2.0 fat     1876 b- defN 23-Oct-23 05:57 mapteksdk/internal/classproperty.py
--rw-rw-rw-  2.0 fat     3624 b- defN 23-Oct-23 05:57 mapteksdk/internal/colour_map_information.py
--rw-rw-rw-  2.0 fat    31139 b- defN 23-Oct-23 05:57 mapteksdk/internal/comms.py
--rw-rw-rw-  2.0 fat     3218 b- defN 23-Oct-23 05:57 mapteksdk/internal/compound_transaction_data.py
--rw-rw-rw-  2.0 fat    19058 b- defN 23-Oct-23 05:57 mapteksdk/internal/data_property.py
--rw-rw-rw-  2.0 fat     3951 b- defN 23-Oct-23 05:57 mapteksdk/internal/data_property_interface.py
--rw-rw-rw-  2.0 fat     3797 b- defN 23-Oct-23 05:57 mapteksdk/internal/lock.py
--rw-rw-rw-  2.0 fat     3375 b- defN 23-Oct-23 05:57 mapteksdk/internal/logger.py
--rw-rw-rw-  2.0 fat     2364 b- defN 23-Oct-23 05:57 mapteksdk/internal/mapping_view.py
--rw-rw-rw-  2.0 fat    16819 b- defN 23-Oct-23 05:57 mapteksdk/internal/mcp.py
--rw-rw-rw-  2.0 fat     3440 b- defN 23-Oct-23 05:57 mapteksdk/internal/normalise_selection.py
--rw-rw-rw-  2.0 fat     3291 b- defN 23-Oct-23 05:57 mapteksdk/internal/options.py
--rw-rw-rw-  2.0 fat     3995 b- defN 23-Oct-23 05:57 mapteksdk/internal/overwrite.py
--rw-rw-rw-  2.0 fat     3110 b- defN 23-Oct-23 05:57 mapteksdk/internal/path_helpers.py
--rw-rw-rw-  2.0 fat    12642 b- defN 23-Oct-23 05:57 mapteksdk/internal/qualifiers.py
--rw-rw-rw-  2.0 fat    16315 b- defN 23-Oct-23 05:57 mapteksdk/internal/rotation.py
--rw-rw-rw-  2.0 fat     5872 b- defN 23-Oct-23 05:57 mapteksdk/internal/serialisation.py
--rw-rw-rw-  2.0 fat     4620 b- defN 23-Oct-23 05:57 mapteksdk/internal/shared_operations.py
--rw-rw-rw-  2.0 fat     3098 b- defN 23-Oct-23 05:57 mapteksdk/internal/singular_data_property_read_only.py
--rw-rw-rw-  2.0 fat     2627 b- defN 23-Oct-23 05:57 mapteksdk/internal/singular_data_property_read_write.py
--rw-rw-rw-  2.0 fat     9765 b- defN 23-Oct-23 05:57 mapteksdk/internal/string_data_property.py
--rw-rw-rw-  2.0 fat    12639 b- defN 23-Oct-23 05:57 mapteksdk/internal/transaction.py
--rw-rw-rw-  2.0 fat     8432 b- defN 23-Oct-23 05:57 mapteksdk/internal/transaction_data.py
--rw-rw-rw-  2.0 fat    25429 b- defN 23-Oct-23 05:57 mapteksdk/internal/transaction_manager.py
--rw-rw-rw-  2.0 fat     1454 b- defN 23-Oct-23 05:57 mapteksdk/internal/transaction_request_data.py
--rw-rw-rw-  2.0 fat     8143 b- defN 23-Oct-23 05:57 mapteksdk/internal/two_sided_colouring_mixin.py
--rw-rw-rw-  2.0 fat     5725 b- defN 23-Oct-23 05:57 mapteksdk/internal/undo.py
--rw-rw-rw-  2.0 fat     8111 b- defN 23-Oct-23 05:57 mapteksdk/internal/util.py
--rw-rw-rw-  2.0 fat     3845 b- defN 23-Oct-23 05:57 mapteksdk/internal/view_data_property.py
--rw-rw-rw-  2.0 fat     3348 b- defN 23-Oct-23 05:57 mapteksdk/internal/writable_selection.py
--rw-rw-rw-  2.0 fat      674 b- defN 23-Oct-23 05:57 mapteksdk/labs/__init__.py
--rw-rw-rw-  2.0 fat     4279 b- defN 23-Oct-23 05:57 mapteksdk/labs/cells.py
--rw-rw-rw-  2.0 fat     5782 b- defN 23-Oct-23 05:57 mapteksdk/labs/view.py
--rw-rw-rw-  2.0 fat      155 b- defN 23-Oct-23 05:57 mapteksdk/pointstudio/__init__.py
--rw-rw-rw-  2.0 fat    28130 b- defN 23-Oct-23 05:57 mapteksdk/pointstudio/operations.py
--rw-rw-rw-  2.0 fat    90613 b- defN 23-Oct-23 05:57 mapteksdk/project/__init__.py
--rw-rw-rw-  2.0 fat     2339 b- defN 23-Oct-23 05:57 mapteksdk/project/errors.py
--rw-rw-rw-  2.0 fat    12091 b- defN 23-Oct-23 05:57 mapteksdk/project/selection.py
--rw-rw-rw-  2.0 fat     1081 b- defN 23-Oct-23 05:57 mapteksdk/workflows/__init__.py
--rw-rw-rw-  2.0 fat     2617 b- defN 23-Oct-23 05:57 mapteksdk/workflows/connector_type.py
--rw-rw-rw-  2.0 fat    19156 b- defN 23-Oct-23 05:57 mapteksdk/workflows/connector_types.py
--rw-rw-rw-  2.0 fat     3148 b- defN 23-Oct-23 05:57 mapteksdk/workflows/matching.py
--rw-rw-rw-  2.0 fat    43654 b- defN 23-Oct-23 05:57 mapteksdk/workflows/parser.py
--rw-rw-rw-  2.0 fat    12129 b- defN 23-Oct-23 05:57 mapteksdk/workflows/workflow_selection.py
--rw-rw-rw-  2.0 fat      257 b- defN 23-Oct-23 05:57 tests/helpers/__init__.py
--rw-rw-rw-  2.0 fat     3970 b- defN 23-Oct-23 05:57 tests/helpers/application.py
--rw-rw-rw-  2.0 fat    18670 b- defN 23-Oct-23 05:57 tests/helpers/assertions.py
--rw-rw-rw-  2.0 fat     1296 b- defN 23-Oct-23 05:57 tests/helpers/errors.py
--rw-rw-rw-  2.0 fat    12386 b- defN 23-Oct-23 05:57 tests/helpers/fixtures.py
--rw-rw-rw-  2.0 fat     6937 b- defN 23-Oct-23 05:57 tests/helpers/messages.py
--rw-rw-rw-  2.0 fat     4038 b- defN 23-Oct-23 05:57 tests/helpers/old_applications.py
--rw-rw-rw-  2.0 fat     8217 b- defN 23-Oct-23 05:57 tests/helpers/project.py
--rw-rw-rw-  2.0 fat     9924 b- defN 23-Oct-23 05:57 tests/helpers/replay_server.py
--rw-rw-rw-  2.0 fat     5090 b- defN 23-Oct-23 05:57 tests/helpers/request_response_server.py
--rw-rw-rw-  2.0 fat    18885 b- defN 23-Oct-23 05:57 tests/helpers/suites.py
--rw-rw-rw-  2.0 fat     3028 b- defN 23-Oct-23 05:57 tests/helpers/testdata.py
--rw-rw-rw-  2.0 fat     2847 b- defN 23-Oct-23 05:57 tests/helpers/undo.py
--rw-rw-rw-  2.0 fat     2728 b- defN 23-Oct-23 05:57 tests/helpers/util.py
--rw-rw-rw-  2.0 fat     1932 b- defN 23-Oct-23 05:57 tests/helpers/workflows.py
--rw-rw-rw-  2.0 fat     9172 b- defN 23-Oct-23 06:27 mapteksdk-1.6.dist-info/METADATA
--rw-rw-rw-  2.0 fat       92 b- defN 23-Oct-23 06:27 mapteksdk-1.6.dist-info/WHEEL
--rw-rw-rw-  2.0 fat       16 b- defN 23-Oct-23 06:27 mapteksdk-1.6.dist-info/top_level.txt
--rw-rw-r--  2.0 fat    13337 b- defN 23-Oct-23 06:27 mapteksdk-1.6.dist-info/RECORD
-150 files, 2205915 bytes uncompressed, 578707 bytes compressed:  73.8%
+Zip file size: 704747 bytes, number of entries: 176
+-rw-rw-rw-  2.0 fat      617 b- defN 24-May-01 01:15 mapteksdk/__init__.py
+-rw-rw-rw-  2.0 fat     4704 b- defN 24-May-01 01:15 mapteksdk/context_menu.py
+-rw-rw-rw-  2.0 fat     6028 b- defN 24-May-01 01:15 mapteksdk/geometry.py
+-rw-rw-rw-  2.0 fat    57529 b- defN 24-May-01 01:15 mapteksdk/operations.py
+-rw-rw-rw-  2.0 fat     1255 b- defN 24-May-01 01:15 mapteksdk/overwrite_modes.py
+-rw-rw-rw-  2.0 fat    42193 b- defN 24-May-01 01:15 mapteksdk/view.py
+-rw-rw-rw-  2.0 fat     1175 b- defN 24-May-01 01:15 mapteksdk/capi/__init__.py
+-rw-rw-rw-  2.0 fat    29770 b- defN 24-May-01 01:15 mapteksdk/capi/dataengine.py
+-rw-rw-rw-  2.0 fat    52807 b- defN 24-May-01 01:15 mapteksdk/capi/drillholemodel.py
+-rw-rw-rw-  2.0 fat     1679 b- defN 24-May-01 01:15 mapteksdk/capi/feedback.py
+-rw-rw-rw-  2.0 fat     6744 b- defN 24-May-01 01:15 mapteksdk/capi/license.py
+-rw-rw-rw-  2.0 fat     6458 b- defN 24-May-01 01:15 mapteksdk/capi/mcp.py
+-rw-rw-rw-  2.0 fat   121047 b- defN 24-May-01 01:15 mapteksdk/capi/modelling.py
+-rw-rw-rw-  2.0 fat     2076 b- defN 24-May-01 01:15 mapteksdk/capi/preference.py
+-rw-rw-rw-  2.0 fat     2111 b- defN 24-May-01 01:15 mapteksdk/capi/reportwindow.py
+-rw-rw-rw-  2.0 fat    11011 b- defN 24-May-01 01:15 mapteksdk/capi/scan.py
+-rw-rw-rw-  2.0 fat     3335 b- defN 24-May-01 01:15 mapteksdk/capi/sdp.py
+-rw-rw-rw-  2.0 fat     1346 b- defN 24-May-01 01:15 mapteksdk/capi/selection.py
+-rw-rw-rw-  2.0 fat     2290 b- defN 24-May-01 01:15 mapteksdk/capi/system.py
+-rw-rw-rw-  2.0 fat     7703 b- defN 24-May-01 01:15 mapteksdk/capi/topology.py
+-rw-rw-rw-  2.0 fat     4747 b- defN 24-May-01 01:15 mapteksdk/capi/translation.py
+-rw-rw-rw-  2.0 fat     5355 b- defN 24-May-01 01:15 mapteksdk/capi/types.py
+-rw-rw-rw-  2.0 fat    13635 b- defN 24-May-01 01:15 mapteksdk/capi/util.py
+-rw-rw-rw-  2.0 fat     2963 b- defN 24-May-01 01:15 mapteksdk/capi/viewer.py
+-rw-rw-rw-  2.0 fat     8983 b- defN 24-May-01 01:15 mapteksdk/capi/visualisation.py
+-rw-rw-rw-  2.0 fat     1512 b- defN 24-May-01 01:15 mapteksdk/capi/vulcan.py
+-rw-rw-rw-  2.0 fat    11547 b- defN 24-May-01 01:15 mapteksdk/capi/wrapper_base.py
+-rw-rw-rw-  2.0 fat     2768 b- defN 24-May-01 01:15 mapteksdk/common/__init__.py
+-rw-rw-rw-  2.0 fat     7869 b- defN 24-May-01 01:16 mapteksdk/common/typing.py
+-rw-rw-rw-  2.0 fat     2000 b- defN 24-May-01 01:15 mapteksdk/data/__init__.py
+-rw-rw-rw-  2.0 fat    36031 b- defN 24-May-01 01:15 mapteksdk/data/annotations.py
+-rw-rw-rw-  2.0 fat    64039 b- defN 24-May-01 01:15 mapteksdk/data/base.py
+-rw-rw-rw-  2.0 fat    38749 b- defN 24-May-01 01:15 mapteksdk/data/blocks.py
+-rw-rw-rw-  2.0 fat    21667 b- defN 24-May-01 01:15 mapteksdk/data/cells.py
+-rw-rw-rw-  2.0 fat     4990 b- defN 24-May-01 01:15 mapteksdk/data/change_reasons.py
+-rw-rw-rw-  2.0 fat    39993 b- defN 24-May-01 01:15 mapteksdk/data/colourmaps.py
+-rw-rw-rw-  2.0 fat    35213 b- defN 24-May-01 01:15 mapteksdk/data/containers.py
+-rw-rw-rw-  2.0 fat    12020 b- defN 24-May-01 01:15 mapteksdk/data/coordinate_systems.py
+-rw-rw-rw-  2.0 fat    14132 b- defN 24-May-01 01:15 mapteksdk/data/edges.py
+-rw-rw-rw-  2.0 fat     6239 b- defN 24-May-01 01:15 mapteksdk/data/ellipsoid.py
+-rw-rw-rw-  2.0 fat     2687 b- defN 24-May-01 01:15 mapteksdk/data/errors.py
+-rw-rw-rw-  2.0 fat    13404 b- defN 24-May-01 01:15 mapteksdk/data/facets.py
+-rw-rw-rw-  2.0 fat    35899 b- defN 24-May-01 01:15 mapteksdk/data/filled_polygon.py
+-rw-rw-rw-  2.0 fat    21286 b- defN 24-May-01 01:15 mapteksdk/data/geotechnical.py
+-rw-rw-rw-  2.0 fat    23064 b- defN 24-May-01 01:16 mapteksdk/data/image_registration.py
+-rw-rw-rw-  2.0 fat     4424 b- defN 24-May-01 01:15 mapteksdk/data/image_registration_interface.py
+-rw-rw-rw-  2.0 fat    22187 b- defN 24-May-01 01:16 mapteksdk/data/images.py
+-rw-rw-rw-  2.0 fat    10081 b- defN 24-May-01 01:15 mapteksdk/data/io.py
+-rw-rw-rw-  2.0 fat    19903 b- defN 24-May-01 01:15 mapteksdk/data/objectid.py
+-rw-rw-rw-  2.0 fat    15096 b- defN 24-May-01 01:15 mapteksdk/data/points.py
+-rw-rw-rw-  2.0 fat     1069 b- defN 24-May-01 01:15 mapteksdk/data/primitive_type.py
+-rw-rw-rw-  2.0 fat    14383 b- defN 24-May-01 01:15 mapteksdk/data/ribbons.py
+-rw-rw-rw-  2.0 fat    10533 b- defN 24-May-01 01:15 mapteksdk/data/rotation.py
+-rw-rw-rw-  2.0 fat    58052 b- defN 24-May-01 01:15 mapteksdk/data/scans.py
+-rw-rw-rw-  2.0 fat     9343 b- defN 24-May-01 01:15 mapteksdk/data/units.py
+-rw-rw-rw-  2.0 fat      771 b- defN 24-May-01 01:15 mapteksdk/data/primitives/__init__.py
+-rw-rw-rw-  2.0 fat    13600 b- defN 24-May-01 01:15 mapteksdk/data/primitives/attribute_key.py
+-rw-rw-rw-  2.0 fat    31898 b- defN 24-May-01 01:15 mapteksdk/data/primitives/block_properties.py
+-rw-rw-rw-  2.0 fat    12630 b- defN 24-May-01 01:15 mapteksdk/data/primitives/cell_properties.py
+-rw-rw-rw-  2.0 fat    11187 b- defN 24-May-01 01:15 mapteksdk/data/primitives/edge_properties.py
+-rw-rw-rw-  2.0 fat    14345 b- defN 24-May-01 01:15 mapteksdk/data/primitives/facet_properties.py
+-rw-rw-rw-  2.0 fat    26201 b- defN 24-May-01 01:15 mapteksdk/data/primitives/point_properties.py
+-rw-rw-rw-  2.0 fat    35742 b- defN 24-May-01 01:15 mapteksdk/data/primitives/primitive_attributes.py
+-rw-rw-rw-  2.0 fat     1167 b- defN 24-May-01 01:15 mapteksdk/geologycore/__init__.py
+-rw-rw-rw-  2.0 fat    23783 b- defN 24-May-01 01:15 mapteksdk/geologycore/database.py
+-rw-rw-rw-  2.0 fat     3438 b- defN 24-May-01 01:15 mapteksdk/geologycore/desurvey_method.py
+-rw-rw-rw-  2.0 fat    27288 b- defN 24-May-01 01:15 mapteksdk/geologycore/drillholes.py
+-rw-rw-rw-  2.0 fat    12387 b- defN 24-May-01 01:15 mapteksdk/geologycore/errors.py
+-rw-rw-rw-  2.0 fat    27367 b- defN 24-May-01 01:15 mapteksdk/geologycore/fields.py
+-rw-rw-rw-  2.0 fat    13620 b- defN 24-May-01 01:15 mapteksdk/geologycore/operations.py
+-rw-rw-rw-  2.0 fat    61322 b- defN 24-May-01 01:15 mapteksdk/geologycore/tables.py
+-rw-rw-rw-  2.0 fat      410 b- defN 24-May-01 01:15 mapteksdk/geologycore/internal/__init__.py
+-rw-rw-rw-  2.0 fat     1922 b- defN 24-May-01 01:15 mapteksdk/geologycore/internal/constants.py
+-rw-rw-rw-  2.0 fat    11722 b- defN 24-May-01 01:15 mapteksdk/geologycore/internal/tables_mixin.py
+-rw-rw-rw-  2.0 fat     8704 b- defN 24-May-01 01:38 mapteksdk/internal/AssemblySupport.dll
+-rw-rw-rw-  2.0 fat    16896 b- defN 24-May-01 01:38 mapteksdk/internal/BrokerConnector.dll
+-rw-rw-rw-  2.0 fat    22528 b- defN 24-May-01 01:38 mapteksdk/internal/DotNetSupport.dll
+-rw-rw-rw-  2.0 fat     7168 b- defN 24-May-01 01:38 mapteksdk/internal/ExceptionSupport.dll
+-rw-rw-rw-  2.0 fat    32256 b- defN 24-May-01 01:38 mapteksdk/internal/FileSupport.dll
+-rw-rw-rw-  2.0 fat    18944 b- defN 24-May-01 01:38 mapteksdk/internal/LoggingInterface.dll
+-rw-rw-rw-  2.0 fat   112128 b- defN 24-May-01 01:38 mapteksdk/internal/MaptekAccountBrokerConnector.dll
+-rw-rw-rw-  2.0 fat    53760 b- defN 24-May-01 01:38 mapteksdk/internal/MaptekAccountBrokerInterfaces.dll
+-rw-rw-rw-  2.0 fat    31744 b- defN 24-May-01 01:38 mapteksdk/internal/MaptekAccountBrokerServiceInterfaces.dll
+-rw-rw-rw-  2.0 fat   104448 b- defN 24-May-01 01:38 mapteksdk/internal/MaptekBindingSupport.dll
+-rw-rw-rw-  2.0 fat    42496 b- defN 24-May-01 01:38 mapteksdk/internal/MaptekTelemetry.dll
+-rw-rw-rw-  2.0 fat    17920 b- defN 24-May-01 01:38 mapteksdk/internal/MaptekWCFSupport.dll
+-rw-rw-rw-  2.0 fat     8192 b- defN 24-May-01 01:38 mapteksdk/internal/NotificationInterface.dll
+-rw-rw-rw-  2.0 fat    13824 b- defN 24-May-01 01:38 mapteksdk/internal/ProcessManagement.dll
+-rw-rw-rw-  2.0 fat     5632 b- defN 24-May-01 01:38 mapteksdk/internal/ResourceManagement.dll
+-rw-rw-rw-  2.0 fat      449 b- defN 24-May-01 01:15 mapteksdk/internal/__init__.py
+-rw-rw-rw-  2.0 fat     9058 b- defN 24-May-01 01:15 mapteksdk/internal/account.py
+-rw-rw-rw-  2.0 fat    27142 b- defN 24-May-01 01:15 mapteksdk/internal/backends.py
+-rw-rw-rw-  2.0 fat     1786 b- defN 24-May-01 01:15 mapteksdk/internal/before_undo_state.py
+-rw-rw-rw-  2.0 fat     1876 b- defN 24-May-01 01:15 mapteksdk/internal/classproperty.py
+-rw-rw-rw-  2.0 fat     3528 b- defN 24-May-01 01:15 mapteksdk/internal/colour_map_information.py
+-rw-rw-rw-  2.0 fat    19058 b- defN 24-May-01 01:15 mapteksdk/internal/data_property.py
+-rw-rw-rw-  2.0 fat     3951 b- defN 24-May-01 01:15 mapteksdk/internal/data_property_interface.py
+-rw-rw-rw-  2.0 fat     3797 b- defN 24-May-01 01:15 mapteksdk/internal/lock.py
+-rw-rw-rw-  2.0 fat     5758 b- defN 24-May-01 01:15 mapteksdk/internal/logger.py
+-rw-rw-rw-  2.0 fat     2364 b- defN 24-May-01 01:15 mapteksdk/internal/mapping_view.py
+-rw-rw-rw-  2.0 fat    18150 b- defN 24-May-01 01:15 mapteksdk/internal/mcp.py
+-rw-rw-rw-  2.0 fat     3452 b- defN 24-May-01 01:15 mapteksdk/internal/normalise_selection.py
+-rw-rw-rw-  2.0 fat     3631 b- defN 24-May-01 01:15 mapteksdk/internal/options.py
+-rw-rw-rw-  2.0 fat     3995 b- defN 24-May-01 01:15 mapteksdk/internal/overwrite.py
+-rw-rw-rw-  2.0 fat     3110 b- defN 24-May-01 01:15 mapteksdk/internal/path_helpers.py
+-rw-rw-rw-  2.0 fat     5877 b- defN 24-May-01 01:15 mapteksdk/internal/project.py
+-rw-rw-rw-  2.0 fat      600 b- defN 24-May-01 01:15 mapteksdk/internal/protocol.py
+-rw-rw-rw-  2.0 fat    14534 b- defN 24-May-01 01:15 mapteksdk/internal/qualifiers.py
+-rw-rw-rw-  2.0 fat    16315 b- defN 24-May-01 01:15 mapteksdk/internal/rotation.py
+-rw-rw-rw-  2.0 fat     6868 b- defN 24-May-01 01:15 mapteksdk/internal/serialisation.py
+-rw-rw-rw-  2.0 fat     4303 b- defN 24-May-01 01:15 mapteksdk/internal/serialised_text.py
+-rw-rw-rw-  2.0 fat     4620 b- defN 24-May-01 01:15 mapteksdk/internal/shared_operations.py
+-rw-rw-rw-  2.0 fat     3098 b- defN 24-May-01 01:15 mapteksdk/internal/singular_data_property_read_only.py
+-rw-rw-rw-  2.0 fat     2627 b- defN 24-May-01 01:15 mapteksdk/internal/singular_data_property_read_write.py
+-rw-rw-rw-  2.0 fat     9765 b- defN 24-May-01 01:15 mapteksdk/internal/string_data_property.py
+-rw-rw-rw-  2.0 fat    12401 b- defN 24-May-01 01:15 mapteksdk/internal/transaction.py
+-rw-rw-rw-  2.0 fat    18057 b- defN 24-May-01 01:15 mapteksdk/internal/transaction_base.py
+-rw-rw-rw-  2.0 fat     8976 b- defN 24-May-01 01:15 mapteksdk/internal/transaction_compound.py
+-rw-rw-rw-  2.0 fat    16989 b- defN 24-May-01 01:15 mapteksdk/internal/transaction_elemental.py
+-rw-rw-rw-  2.0 fat     1915 b- defN 24-May-01 01:15 mapteksdk/internal/transaction_errors.py
+-rw-rw-rw-  2.0 fat     6724 b- defN 24-May-01 01:15 mapteksdk/internal/transaction_manager.py
+-rw-rw-rw-  2.0 fat     7498 b- defN 24-May-01 01:15 mapteksdk/internal/transaction_messages.py
+-rw-rw-rw-  2.0 fat     9964 b- defN 24-May-01 01:15 mapteksdk/internal/transaction_mixins.py
+-rw-rw-rw-  2.0 fat     1757 b- defN 24-May-01 01:15 mapteksdk/internal/transaction_request_data.py
+-rw-rw-rw-  2.0 fat     1015 b- defN 24-May-01 01:15 mapteksdk/internal/transaction_state.py
+-rw-rw-rw-  2.0 fat     8143 b- defN 24-May-01 01:15 mapteksdk/internal/two_sided_colouring_mixin.py
+-rw-rw-rw-  2.0 fat     5823 b- defN 24-May-01 01:15 mapteksdk/internal/undo.py
+-rw-rw-rw-  2.0 fat     8111 b- defN 24-May-01 01:15 mapteksdk/internal/util.py
+-rw-rw-rw-  2.0 fat     3845 b- defN 24-May-01 01:15 mapteksdk/internal/view_data_property.py
+-rw-rw-rw-  2.0 fat     3572 b- defN 24-May-01 01:15 mapteksdk/internal/writable_selection.py
+-rw-rw-rw-  2.0 fat      935 b- defN 24-May-01 01:15 mapteksdk/internal/comms/__init__.py
+-rw-rw-rw-  2.0 fat    12397 b- defN 24-May-01 01:15 mapteksdk/internal/comms/base_message.py
+-rw-rw-rw-  2.0 fat     2386 b- defN 24-May-01 01:15 mapteksdk/internal/comms/default_factory.py
+-rw-rw-rw-  2.0 fat      803 b- defN 24-May-01 01:15 mapteksdk/internal/comms/errors.py
+-rw-rw-rw-  2.0 fat     2296 b- defN 24-May-01 01:15 mapteksdk/internal/comms/factory_protocol.py
+-rw-rw-rw-  2.0 fat     1534 b- defN 24-May-01 01:15 mapteksdk/internal/comms/inline_message.py
+-rw-rw-rw-  2.0 fat     3994 b- defN 24-May-01 01:15 mapteksdk/internal/comms/message.py
+-rw-rw-rw-  2.0 fat     2393 b- defN 24-May-01 01:15 mapteksdk/internal/comms/message_component_protocol.py
+-rw-rw-rw-  2.0 fat     1142 b- defN 24-May-01 01:15 mapteksdk/internal/comms/protocols.py
+-rw-rw-rw-  2.0 fat     3740 b- defN 24-May-01 01:15 mapteksdk/internal/comms/repeating_fields.py
+-rw-rw-rw-  2.0 fat     6618 b- defN 24-May-01 01:15 mapteksdk/internal/comms/request.py
+-rw-rw-rw-  2.0 fat     4599 b- defN 24-May-01 01:15 mapteksdk/internal/comms/sendable_message.py
+-rw-rw-rw-  2.0 fat     1486 b- defN 24-May-01 01:15 mapteksdk/internal/comms/sub_message.py
+-rw-rw-rw-  2.0 fat     6246 b- defN 24-May-01 01:15 mapteksdk/internal/comms/types.py
+-rw-rw-rw-  2.0 fat     2213 b- defN 24-May-01 01:15 mapteksdk/internal/comms/_factories/__init__.py
+-rw-rw-rw-  2.0 fat     2673 b- defN 24-May-01 01:15 mapteksdk/internal/comms/_factories/any_factory.py
+-rw-rw-rw-  2.0 fat     1751 b- defN 24-May-01 01:15 mapteksdk/internal/comms/_factories/compound_factory.py
+-rw-rw-rw-  2.0 fat     3257 b- defN 24-May-01 01:15 mapteksdk/internal/comms/_factories/message_component_base.py
+-rw-rw-rw-  2.0 fat     5601 b- defN 24-May-01 01:15 mapteksdk/internal/comms/_factories/message_factory.py
+-rw-rw-rw-  2.0 fat     7907 b- defN 24-May-01 01:15 mapteksdk/internal/comms/_factories/primitive_factory.py
+-rw-rw-rw-  2.0 fat     2655 b- defN 24-May-01 01:15 mapteksdk/internal/comms/_factories/repeating_field_factory.py
+-rw-rw-rw-  2.0 fat     4845 b- defN 24-May-01 01:15 mapteksdk/internal/comms/_factories/sequence_factory.py
+-rw-rw-rw-  2.0 fat     3170 b- defN 24-May-01 01:15 mapteksdk/internal/comms/_factories/serialisable_factory.py
+-rw-rw-rw-  2.0 fat     3534 b- defN 24-May-01 01:15 mapteksdk/internal/comms/_factories/union_factory.py
+-rw-rw-rw-  2.0 fat      674 b- defN 24-May-01 01:15 mapteksdk/labs/__init__.py
+-rw-rw-rw-  2.0 fat     4279 b- defN 24-May-01 01:15 mapteksdk/labs/cells.py
+-rw-rw-rw-  2.0 fat     5686 b- defN 24-May-01 01:15 mapteksdk/labs/view.py
+-rw-rw-rw-  2.0 fat      155 b- defN 24-May-01 01:15 mapteksdk/pointstudio/__init__.py
+-rw-rw-rw-  2.0 fat    28172 b- defN 24-May-01 01:15 mapteksdk/pointstudio/operations.py
+-rw-rw-rw-  2.0 fat    92970 b- defN 24-May-01 01:15 mapteksdk/project/__init__.py
+-rw-rw-rw-  2.0 fat     2339 b- defN 24-May-01 01:15 mapteksdk/project/errors.py
+-rw-rw-rw-  2.0 fat    13910 b- defN 24-May-01 01:15 mapteksdk/project/selection.py
+-rw-rw-rw-  2.0 fat     1081 b- defN 24-May-01 01:15 mapteksdk/workflows/__init__.py
+-rw-rw-rw-  2.0 fat     3056 b- defN 24-May-01 01:15 mapteksdk/workflows/connector_type.py
+-rw-rw-rw-  2.0 fat    19301 b- defN 24-May-01 01:15 mapteksdk/workflows/connector_types.py
+-rw-rw-rw-  2.0 fat     3389 b- defN 24-May-01 01:15 mapteksdk/workflows/errors.py
+-rw-rw-rw-  2.0 fat     3148 b- defN 24-May-01 01:15 mapteksdk/workflows/matching.py
+-rw-rw-rw-  2.0 fat    52884 b- defN 24-May-01 01:15 mapteksdk/workflows/parser.py
+-rw-rw-rw-  2.0 fat    12818 b- defN 24-May-01 01:15 mapteksdk/workflows/workflow_selection.py
+-rw-rw-rw-  2.0 fat      278 b- defN 24-May-01 01:15 mapteksdk/workflows/internal/__init__.py
+-rw-rw-rw-  2.0 fat     7132 b- defN 24-May-01 01:15 mapteksdk/workflows/internal/converters.py
+-rw-rw-rw-  2.0 fat     2996 b- defN 24-May-01 01:15 mapteksdk/workflows/internal/schema.py
+-rw-rw-rw-  2.0 fat     9064 b- defN 24-May-01 01:38 mapteksdk-1.7.dist-info/METADATA
+-rw-rw-rw-  2.0 fat       92 b- defN 24-May-01 01:38 mapteksdk-1.7.dist-info/WHEEL
+-rw-rw-rw-  2.0 fat       10 b- defN 24-May-01 01:38 mapteksdk-1.7.dist-info/top_level.txt
+-rw-rw-r--  2.0 fat    16185 b- defN 24-May-01 01:38 mapteksdk-1.7.dist-info/RECORD
+176 files, 2447477 bytes uncompressed, 679047 bytes compressed:  72.3%
```

## zipnote {}

```diff
@@ -216,15 +216,27 @@
 
 Filename: mapteksdk/geologycore/internal/constants.py
 Comment: 
 
 Filename: mapteksdk/geologycore/internal/tables_mixin.py
 Comment: 
 
-Filename: mapteksdk/internal/Logging.dll
+Filename: mapteksdk/internal/AssemblySupport.dll
+Comment: 
+
+Filename: mapteksdk/internal/BrokerConnector.dll
+Comment: 
+
+Filename: mapteksdk/internal/DotNetSupport.dll
+Comment: 
+
+Filename: mapteksdk/internal/ExceptionSupport.dll
+Comment: 
+
+Filename: mapteksdk/internal/FileSupport.dll
 Comment: 
 
 Filename: mapteksdk/internal/LoggingInterface.dll
 Comment: 
 
 Filename: mapteksdk/internal/MaptekAccountBrokerConnector.dll
 Comment: 
@@ -234,20 +246,26 @@
 
 Filename: mapteksdk/internal/MaptekAccountBrokerServiceInterfaces.dll
 Comment: 
 
 Filename: mapteksdk/internal/MaptekBindingSupport.dll
 Comment: 
 
+Filename: mapteksdk/internal/MaptekTelemetry.dll
+Comment: 
+
 Filename: mapteksdk/internal/MaptekWCFSupport.dll
 Comment: 
 
 Filename: mapteksdk/internal/NotificationInterface.dll
 Comment: 
 
+Filename: mapteksdk/internal/ProcessManagement.dll
+Comment: 
+
 Filename: mapteksdk/internal/ResourceManagement.dll
 Comment: 
 
 Filename: mapteksdk/internal/__init__.py
 Comment: 
 
 Filename: mapteksdk/internal/account.py
@@ -261,20 +279,14 @@
 
 Filename: mapteksdk/internal/classproperty.py
 Comment: 
 
 Filename: mapteksdk/internal/colour_map_information.py
 Comment: 
 
-Filename: mapteksdk/internal/comms.py
-Comment: 
-
-Filename: mapteksdk/internal/compound_transaction_data.py
-Comment: 
-
 Filename: mapteksdk/internal/data_property.py
 Comment: 
 
 Filename: mapteksdk/internal/data_property_interface.py
 Comment: 
 
 Filename: mapteksdk/internal/lock.py
@@ -297,23 +309,32 @@
 
 Filename: mapteksdk/internal/overwrite.py
 Comment: 
 
 Filename: mapteksdk/internal/path_helpers.py
 Comment: 
 
+Filename: mapteksdk/internal/project.py
+Comment: 
+
+Filename: mapteksdk/internal/protocol.py
+Comment: 
+
 Filename: mapteksdk/internal/qualifiers.py
 Comment: 
 
 Filename: mapteksdk/internal/rotation.py
 Comment: 
 
 Filename: mapteksdk/internal/serialisation.py
 Comment: 
 
+Filename: mapteksdk/internal/serialised_text.py
+Comment: 
+
 Filename: mapteksdk/internal/shared_operations.py
 Comment: 
 
 Filename: mapteksdk/internal/singular_data_property_read_only.py
 Comment: 
 
 Filename: mapteksdk/internal/singular_data_property_read_write.py
@@ -321,23 +342,41 @@
 
 Filename: mapteksdk/internal/string_data_property.py
 Comment: 
 
 Filename: mapteksdk/internal/transaction.py
 Comment: 
 
-Filename: mapteksdk/internal/transaction_data.py
+Filename: mapteksdk/internal/transaction_base.py
+Comment: 
+
+Filename: mapteksdk/internal/transaction_compound.py
+Comment: 
+
+Filename: mapteksdk/internal/transaction_elemental.py
+Comment: 
+
+Filename: mapteksdk/internal/transaction_errors.py
 Comment: 
 
 Filename: mapteksdk/internal/transaction_manager.py
 Comment: 
 
+Filename: mapteksdk/internal/transaction_messages.py
+Comment: 
+
+Filename: mapteksdk/internal/transaction_mixins.py
+Comment: 
+
 Filename: mapteksdk/internal/transaction_request_data.py
 Comment: 
 
+Filename: mapteksdk/internal/transaction_state.py
+Comment: 
+
 Filename: mapteksdk/internal/two_sided_colouring_mixin.py
 Comment: 
 
 Filename: mapteksdk/internal/undo.py
 Comment: 
 
 Filename: mapteksdk/internal/util.py
@@ -345,107 +384,146 @@
 
 Filename: mapteksdk/internal/view_data_property.py
 Comment: 
 
 Filename: mapteksdk/internal/writable_selection.py
 Comment: 
 
-Filename: mapteksdk/labs/__init__.py
+Filename: mapteksdk/internal/comms/__init__.py
 Comment: 
 
-Filename: mapteksdk/labs/cells.py
+Filename: mapteksdk/internal/comms/base_message.py
 Comment: 
 
-Filename: mapteksdk/labs/view.py
+Filename: mapteksdk/internal/comms/default_factory.py
 Comment: 
 
-Filename: mapteksdk/pointstudio/__init__.py
+Filename: mapteksdk/internal/comms/errors.py
 Comment: 
 
-Filename: mapteksdk/pointstudio/operations.py
+Filename: mapteksdk/internal/comms/factory_protocol.py
 Comment: 
 
-Filename: mapteksdk/project/__init__.py
+Filename: mapteksdk/internal/comms/inline_message.py
 Comment: 
 
-Filename: mapteksdk/project/errors.py
+Filename: mapteksdk/internal/comms/message.py
 Comment: 
 
-Filename: mapteksdk/project/selection.py
+Filename: mapteksdk/internal/comms/message_component_protocol.py
 Comment: 
 
-Filename: mapteksdk/workflows/__init__.py
+Filename: mapteksdk/internal/comms/protocols.py
 Comment: 
 
-Filename: mapteksdk/workflows/connector_type.py
+Filename: mapteksdk/internal/comms/repeating_fields.py
 Comment: 
 
-Filename: mapteksdk/workflows/connector_types.py
+Filename: mapteksdk/internal/comms/request.py
 Comment: 
 
-Filename: mapteksdk/workflows/matching.py
+Filename: mapteksdk/internal/comms/sendable_message.py
 Comment: 
 
-Filename: mapteksdk/workflows/parser.py
+Filename: mapteksdk/internal/comms/sub_message.py
 Comment: 
 
-Filename: mapteksdk/workflows/workflow_selection.py
+Filename: mapteksdk/internal/comms/types.py
+Comment: 
+
+Filename: mapteksdk/internal/comms/_factories/__init__.py
+Comment: 
+
+Filename: mapteksdk/internal/comms/_factories/any_factory.py
+Comment: 
+
+Filename: mapteksdk/internal/comms/_factories/compound_factory.py
+Comment: 
+
+Filename: mapteksdk/internal/comms/_factories/message_component_base.py
+Comment: 
+
+Filename: mapteksdk/internal/comms/_factories/message_factory.py
+Comment: 
+
+Filename: mapteksdk/internal/comms/_factories/primitive_factory.py
+Comment: 
+
+Filename: mapteksdk/internal/comms/_factories/repeating_field_factory.py
+Comment: 
+
+Filename: mapteksdk/internal/comms/_factories/sequence_factory.py
+Comment: 
+
+Filename: mapteksdk/internal/comms/_factories/serialisable_factory.py
 Comment: 
 
-Filename: tests/helpers/__init__.py
+Filename: mapteksdk/internal/comms/_factories/union_factory.py
 Comment: 
 
-Filename: tests/helpers/application.py
+Filename: mapteksdk/labs/__init__.py
+Comment: 
+
+Filename: mapteksdk/labs/cells.py
+Comment: 
+
+Filename: mapteksdk/labs/view.py
+Comment: 
+
+Filename: mapteksdk/pointstudio/__init__.py
+Comment: 
+
+Filename: mapteksdk/pointstudio/operations.py
 Comment: 
 
-Filename: tests/helpers/assertions.py
+Filename: mapteksdk/project/__init__.py
 Comment: 
 
-Filename: tests/helpers/errors.py
+Filename: mapteksdk/project/errors.py
 Comment: 
 
-Filename: tests/helpers/fixtures.py
+Filename: mapteksdk/project/selection.py
 Comment: 
 
-Filename: tests/helpers/messages.py
+Filename: mapteksdk/workflows/__init__.py
 Comment: 
 
-Filename: tests/helpers/old_applications.py
+Filename: mapteksdk/workflows/connector_type.py
 Comment: 
 
-Filename: tests/helpers/project.py
+Filename: mapteksdk/workflows/connector_types.py
 Comment: 
 
-Filename: tests/helpers/replay_server.py
+Filename: mapteksdk/workflows/errors.py
 Comment: 
 
-Filename: tests/helpers/request_response_server.py
+Filename: mapteksdk/workflows/matching.py
 Comment: 
 
-Filename: tests/helpers/suites.py
+Filename: mapteksdk/workflows/parser.py
 Comment: 
 
-Filename: tests/helpers/testdata.py
+Filename: mapteksdk/workflows/workflow_selection.py
 Comment: 
 
-Filename: tests/helpers/undo.py
+Filename: mapteksdk/workflows/internal/__init__.py
 Comment: 
 
-Filename: tests/helpers/util.py
+Filename: mapteksdk/workflows/internal/converters.py
 Comment: 
 
-Filename: tests/helpers/workflows.py
+Filename: mapteksdk/workflows/internal/schema.py
 Comment: 
 
-Filename: mapteksdk-1.6.dist-info/METADATA
+Filename: mapteksdk-1.7.dist-info/METADATA
 Comment: 
 
-Filename: mapteksdk-1.6.dist-info/WHEEL
+Filename: mapteksdk-1.7.dist-info/WHEEL
 Comment: 
 
-Filename: mapteksdk-1.6.dist-info/top_level.txt
+Filename: mapteksdk-1.7.dist-info/top_level.txt
 Comment: 
 
-Filename: mapteksdk-1.6.dist-info/RECORD
+Filename: mapteksdk-1.7.dist-info/RECORD
 Comment: 
 
 Zip file comment:
```

## mapteksdk/__init__.py

```diff
@@ -1,13 +1,13 @@
 """Package which allows Python Scripts to interact with Maptek applications.
 
 This allows Python scripts to access, edit and interact with applications
 built on the Maptek Development Framework (MDF). This includes products like
-PointStudio, Vulcan GeologyCore, BlastLogic, Evolution as well as potential
-to expand to other products like Sentry, PerfectDig and laser scanner Controller
+PointStudio, GeologyCore, BlastLogic, Evolution as well as potential to expand
+to other products like Sentry, PerfectDig and laser scanner Controller
 software.
 
 """
 ###############################################################################
 #
 # (C) Copyright 2020, Maptek Pty Ltd. All rights reserved.
 #
```

## mapteksdk/operations.py

```diff
@@ -11,46 +11,58 @@
 import enum
 import logging
 import pathlib
 import typing
 
 import numpy
 
+from mapteksdk.internal.comms import default_factory
 from mapteksdk.internal.qualifiers import (
-  QualifierSet, Qualifiers, Qualifier, InstanceTypes)
+  QualifierSet, Qualifiers)
 from mapteksdk.internal.transaction import (request_transaction,
                                             RequestTransactionWithInputs,
                                             TransactionRequest)
 from mapteksdk.internal.serialisation import Icon
 from mapteksdk.internal.util import default_type_error_message
-from mapteksdk.internal.transaction_manager import (
-  TransactionManager, TransactionCancelledError, TransactionFailedError)
-from mapteksdk.internal.transaction_data import (
-  StringTransactionData, DoubleTransactionData, BooleanTransactionData,
-  PathTransactionData)
-from mapteksdk.internal.compound_transaction_data import (
-  CoordinatePickTransactionData, PrimitivePickTransactionData)
-from mapteksdk.internal.comms import SerialisedText
+from mapteksdk.internal.transaction_base import TransactionBase
+from mapteksdk.internal.transaction_compound import (
+  CoordinatePickTransaction,
+  PrimitivePickTransaction,
+  QuestionTransaction,
+)
+from mapteksdk.internal.transaction_elemental import (
+  StringTransaction,
+  Integer64STransaction,
+  DoubleTransaction,
+  BooleanTransaction,
+  FileTransaction,
+  DirectoryTransaction,
+  CommandTransaction,
+)
+from mapteksdk.internal.transaction_errors import (
+  TransactionCancelledError,
+  TransactionFailedError,
+)
+from mapteksdk.internal.transaction_manager import TransactionManager
 from mapteksdk.view import ViewController
 from mapteksdk.capi import Mcpd, Topology, Translation
-from mapteksdk.capi.types import T_ObjectHandle
 from mapteksdk.data import DataObject, ObjectID
 from mapteksdk.workflows import WorkflowSelection
 
 if typing.TYPE_CHECKING:
   import numpy.typing as npt
 
   from mapteksdk.common.typing import PointArrayLike, FacetArrayLike
-  from mapteksdk.internal.transaction_data import TransactionData
-
-  TransactionDataT = typing.TypeVar("TransactionDataT", bound=TransactionData)
 
   ObjectT = typing.TypeVar('ObjectT', bound=DataObject)
   """Type hint used for arguments which are subclasses of DataObject."""
 
+  T = typing.TypeVar("T")
+  TransactionT = typing.TypeVar("TransactionT", bound=TransactionBase)
+
 LOGGER = logging.getLogger("mapteksdk.operations")
 
 _DEFAULT_COORDINATE_PICK_LABEL = "Select a coordinate"
 """Default coordinate pick label.
 
 This is used for both the label and the support label.
 
@@ -224,54 +236,110 @@
   """Class which can uniquely identify a selected primitive.
 
   Includes the object the primitive exists in, the type of the primitive
   and the index of that primitive in the object.
 
   Parameters
   ----------
-  path
-    The path to the object containing the primitive.
+  oid
+    The object ID of the object which the primitive is a part of.
   primitive_type
     The type of primitive selected.
   index
     Index of the selected primitive in the object.
 
   """
   def __init__(
-      self, path: str, primitive_type: SelectablePrimitiveType, index: int):
+      self, oid: ObjectID, primitive_type: SelectablePrimitiveType, index: int):
     if not isinstance(primitive_type, SelectablePrimitiveType):
       raise TypeError(default_type_error_message(
         argument_name="primitive_type",
         actual_value=primitive_type,
         required_type=SelectablePrimitiveType
       ))
 
-    self.__path = path
+    self.__oid = oid
     self.__primitive_type = primitive_type
     self.__index = index
 
   def __str__(self):
-    return (f"Object: '{self.__path}' {self.__primitive_type.name} at "
+    return (f"Object: '{self.path}' {self.__primitive_type.name} at "
             f"index: {self.__index}")
 
   @property
+  def oid(self) -> ObjectID:
+    """The Object ID of the object with the primitive."""
+    return self.__oid
+
+  @property
   def path(self) -> str:
     """Path to the object containing the selected primitive."""
-    return self.__path
+    return self.__oid.path
 
   @property
   def primitive_type(self) -> SelectablePrimitiveType:
     """The type of primitive which was selected."""
     return self.__primitive_type
 
   @property
   def index(self) -> int:
     """The index of the selected primitive in the primitive array."""
     return self.__index
 
+
+class Option:
+  """An option for a multi-choice question.
+
+  Parameters
+  ----------
+  title
+    The title for this option. Typically this will be a single word
+    description of this option (e.g. "Continue" or "Cancel").
+  message
+    The message for this option. This should be a short sentence describing
+    this option.
+  icon
+    The icon to display for this operation. This is Icon.okay by default.
+  """
+  def __init__(
+      self,
+      title: str,
+      message: str,
+      icon: str | Icon | None=None) -> None:
+    if icon is None:
+      icon = Icon.okay()
+    if not isinstance(icon, Icon):
+      icon = Icon(icon)
+
+    self.__title = title
+    self.__message = message
+    self.__icon = icon
+
+  @property
+  def title(self) -> str:
+    """The title of this option."""
+    return self.__title
+
+  @property
+  def message(self) -> str:
+    """A short description of this option."""
+    return self.__message
+
+  @property
+  def icon(self) -> Icon:
+    """The Icon of this option."""
+    return self.__icon
+
+  def _setup(self, transaction: CommandTransaction):
+    """Set up this option to be sent to the application."""
+    transaction.title = self.title
+    transaction.message = self.message
+    transaction.icon = self.icon
+
+
 @typing.overload
 def open_new_view(
     objects: typing.Optional[list[ObjectID[DataObject]]]=None,
     wait: typing.Literal[True]=True
     ) -> ViewController:
   ...
 
@@ -619,47 +687,33 @@
         try:
           return numpy.array(result.strip("()").split(","),
                             dtype=ctypes.c_double)
         except ValueError as error:
           raise PickFailedError("Coordinate") from error
   else:
     try:
-      pick_transaction = CoordinatePickTransactionData()
-      pick_transaction.add_qualifiers([
-        Qualifiers.instance_type(InstanceTypes.SEQUENCE),
-        Qualifiers.title("Python"),
-      ])
-
-      coordinate = pick_transaction.coordinate
-      coordinate.x = ctypes.c_double(0.0)
-      coordinate.y = ctypes.c_double(0.0)
-      coordinate.z = ctypes.c_double(0.0)
-      # The default label, support label and help text will be translated to
-      # the user's language.
-      coordinate.add_qualifiers([
-        Qualifiers.instance_type(InstanceTypes.IMPERATIVE),
-        Qualifiers.label(
-          SerialisedText(_DEFAULT_COORDINATE_PICK_LABEL)
-          if label is None else label
-        ),
-        Qualifiers.support_label(
-          SerialisedText(_DEFAULT_COORDINATE_PICK_LABEL)
-          if support_label is None else support_label
-        ),
-        Qualifiers.help(
-          SerialisedText(_DEFAULT_COORDINATE_PICK_HELP)
-          if help_text is None else help_text
-        ),
-        Qualifiers.world_pick_hint()
-      ])
-
-      return numpy.array(_request_transaction_and_wait_for_result(
-        CoordinatePickTransactionData,
-        pick_transaction
-      ), dtype=ctypes.c_double)
+      def setup_transaction(transaction: CoordinatePickTransaction):
+        transaction.set_label(
+          label or _DEFAULT_COORDINATE_PICK_LABEL
+        )
+        transaction.set_support_label(
+          support_label or _DEFAULT_COORDINATE_PICK_LABEL
+        )
+        transaction.set_help(
+          help_text or _DEFAULT_COORDINATE_PICK_HELP
+        )
+        transaction.coordinate = [0.0, 0.0, 0.0]
+      def read_result(transaction: CoordinatePickTransaction) -> numpy.ndarray:
+        return transaction.coordinate
+
+      return _request_transaction_and_wait(
+        CoordinatePickTransaction,
+        setup_transaction,
+        read_result
+      )
     except OperationFailedError as error:
       raise PickFailedError("Coordinate", "failed") from error
     except OperationCancelledError as error:
       raise PickCancelledError("Coordinate") from error
 
   raise PickFailedError("Coordinate")
 
@@ -911,14 +965,22 @@
   ...     end = read_object.points[edge[1]]
   ...     write_report("Selected Edge", f"{start} to {end}")
 
   """
   if Mcpd().version < (1, 3):
     raise TooOldForOperation((1, 3), Mcpd().version)
 
+  if not isinstance(primitive_type, SelectablePrimitiveType):
+    raise TypeError(
+      default_type_error_message(
+        "primitive_type",
+        primitive_type,
+        SelectablePrimitiveType
+      )
+    )
   if label is not None and support_label is None:
     support_label = label
 
   print(f"Select a {primitive_type.name} in the running application.")
   if Mcpd().version < (1, 8):
     if locate_on:
       raise TooOldForOperation((1, 8), Mcpd().version)
@@ -960,61 +1022,40 @@
           index = int(result[2])
           return Primitive(result[0], type_id, index)
         except IndexError as error:
           # This will occur if the pick is cancelled.
           raise PickFailedError(primitive_type.name) from error
   else:
     try:
-      pick_transaction = PrimitivePickTransactionData()
-      pick_transaction.add_qualifiers([
-        Qualifiers.instance_type(InstanceTypes.SEQUENCE),
-        Qualifiers.title("Python"),
-      ])
-
-      primitive = pick_transaction.primitive
-      primitive.index = ctypes.c_uint32(0)
-      primitive.owner = ctypes.c_uint64(0)
-      primitive.primitive_type = ctypes.c_int32(0)
-      # The default label, support label and help text will be translated to
-      # the user's language.
-      primitive.add_qualifiers([
-        Qualifiers.instance_type(InstanceTypes.IMPERATIVE),
-        Qualifiers.label(
-        SerialisedText(
-          _DEFAULT_PRIMITIVE_PICK_LABEL, primitive_type.name.title())
-          if label is None else label),
-        Qualifiers.support_label(
-        SerialisedText(
-          _DEFAULT_PRIMITIVE_PICK_LABEL, primitive_type.name.title())
-          if support_label is None else support_label),
-        Qualifiers.help(SerialisedText(
-          _DEFAULT_PRIMITIVE_PICK_HELP, primitive_type.name.title())
-          if help_text is None else help_text),
-        Qualifiers.primitive_type(primitive_type)
-      ])
-
-      if locate_on:
-        for oid in locate_on:
-          primitive.add_qualifier(
-            Qualifiers.locate_on(oid)
-          )
-
-      result = _request_transaction_and_wait_for_result(
-        PrimitivePickTransactionData,
-        pick_transaction
-      )
-
-      owner = ObjectID(T_ObjectHandle(result[0]))
-      type_id = SelectablePrimitiveType(result[1])
-      index = result[2]
-
-      return Primitive(
-        owner.path,
-        primitive_type,
-        index
+      def setup_transaction(transaction: PrimitivePickTransaction):
+        transaction.set_primitive_type(primitive_type)
+        transaction.set_label(
+          label or _DEFAULT_PRIMITIVE_PICK_LABEL
+        )
+        transaction.set_support_label(
+          support_label or _DEFAULT_PRIMITIVE_PICK_LABEL
+        )
+        transaction.set_help(
+          help_text or _DEFAULT_PRIMITIVE_PICK_HELP
+        )
+
+        if locate_on:
+          transaction.add_locate_on_objects(locate_on)
+
+      def read_result(transaction: PrimitivePickTransaction) -> Primitive:
+        return Primitive(
+          transaction.owner_id,
+          primitive_type,
+          transaction.index
+        )
+
+      return _request_transaction_and_wait(
+        PrimitivePickTransaction,
+        setup_transaction,
+        read_result
       )
     except OperationFailedError as error:
       raise PickFailedError("Coordinate", "failed") from error
     except OperationCancelledError as error:
       raise PickCancelledError("Coordinate") from error
   raise PickFailedError(primitive_type.name)
 
@@ -1038,28 +1079,29 @@
 
   >>> from mapteksdk.project import Project
   >>> import mapteksdk.operations as operations
   >>> project = Project()
   >>> operations.write_report(
   ...     'My Script', 'Completed filtering in 1.5 seconds')
   """
-  request = TransactionRequest()
+  factory = default_factory.default_factory(Mcpd())
+  request = TransactionRequest(factory)
   request.transaction = 'mdf::uiC_Report'
   request.qualifiers = QualifierSet()
 
   if Mcpd().version <= (1, 3):
     title_qualifier = Qualifiers.label(label)
   else:
     title_qualifier = Qualifiers.title(label)
 
   request.qualifiers.values = [
     title_qualifier,
     Qualifiers.message(message),
   ]
-  request.send(destination='appServer')
+  request.send('appServer')
 
 
 def show_message(
     title: str, message: str, severity: Severity=Severity.INFORMATION):
   """Display a popup message box in the application.
 
   Note that message boxes can be disruptive to the user and should
@@ -1236,15 +1278,17 @@
   ValueError
     If title is longer than 255 characters.
   """
   title_length = len(title)
   if title_length >= 255:
     raise ValueError("Title must not be more than 255 characters. "
                      f"Length: {title_length}")
-  request = TransactionRequest()
+
+  factory = default_factory.default_factory(Mcpd())
+  request = TransactionRequest(factory)
 
   if severity is Severity.INFORMATION:
     transaction = "mdf::uiS_InformationMessage"
   elif severity is Severity.WARNING:
     transaction = "mdf::uiS_WarningMessage"
   elif severity is Severity.ERROR:
     transaction = "mdf::uiS_ErrorMessage"
@@ -1264,15 +1308,15 @@
     Qualifiers.message(message),
     ]
 
   if toast:
     qualifiers.append(Qualifiers.toast())
 
   request.qualifiers.values = qualifiers
-  request.send(destination='appServer')
+  request.send('appServer')
 
 
 def request_string(
     label: str,
     *,
     title: str="Python",
     initial_value: str | None=None,
@@ -1325,40 +1369,38 @@
   """
   if Mcpd().version < (1, 8):
     raise TooOldForOperation(
       minimum_version=(1, 8),
       current_version=Mcpd().version
     )
 
-  actual_value = StringTransactionData()
-  actual_value.data = initial_value or ""
-  actual_value.add_qualifiers([
-    Qualifiers.label(label),
-    Qualifiers.title(title),
-    # The instance_type qualifier is used to find the factory for creating
-    # the ui representation.
-    Qualifiers.instance_type(InstanceTypes.IMPERATIVE),
-  ])
-
-  if choices:
-    choice_list = [str(x) for x in choices]
-
-    # The initial value must be specified if there are choice values.
-    # Default it to the first item in choice values.
-    if initial_value is None:
-      initial_value = choice_list[0]
-    if initial_value not in choice_list:
-      raise ValueError(
-        "Initial value must be one of the choice values."
-      )
-    actual_value.add_qualifier(Qualifiers.choice_values(choice_list))
-
-  return _request_transaction_and_wait_for_result(
-    StringTransactionData,
-    actual_value
+  def setup_string_transaction(transaction: StringTransaction):
+    nonlocal initial_value
+    transaction.title = title
+    transaction.label = label
+
+    if choices:
+      choice_list = [str(x) for x in choices]
+
+      # The initial value must be specified if there are choice values.
+      # Default it to the first item in choice values.
+      if initial_value is None:
+        initial_value = choice_list[0]
+      if initial_value not in choice_list:
+        raise ValueError(
+          "Initial value must be one of the choice values."
+        )
+      transaction.choices = choice_list
+    if initial_value:
+      transaction.value = initial_value or ""
+
+  return _request_transaction_and_wait(
+    StringTransaction,
+    setup_string_transaction,
+    lambda transaction: transaction.value
   )
 
 
 def request_float(label: str, *, initial_value: float=0.0) -> float:
   """Request a float.
 
   This creates a window in the connected application into which the user can
@@ -1385,25 +1427,23 @@
     If the operation failed to complete.
   """
   if Mcpd().version < (1, 8):
     raise TooOldForOperation(
       minimum_version=(1, 8),
       current_version=Mcpd().version
     )
-  actual_value = DoubleTransactionData()
-  actual_value.data = ctypes.c_double(initial_value)
-  actual_value.add_qualifiers([
-    Qualifiers.label(label),
-    # The instance_type qualifier is used to find the factory for creating
-    # the ui representation.
-    Qualifiers.instance_type(InstanceTypes.IMPERATIVE),
-  ])
-  return _request_transaction_and_wait_for_result(
-    DoubleTransactionData,
-    actual_value
+
+  def setup(transaction: DoubleTransaction):
+    transaction.value = initial_value
+    transaction.label = label
+
+  return _request_transaction_and_wait(
+    DoubleTransaction,
+    setup,
+    lambda transaction: transaction.value
   )
 
 
 def request_integer(label: str, *, initial_value: int=0) -> int:
   """Request an integer.
 
   This creates a window in the connected application into which the user can
@@ -1432,29 +1472,42 @@
     If the operation failed to complete.
   """
   if Mcpd().version < (1, 8):
     raise TooOldForOperation(
       minimum_version=(1, 8),
       current_version=Mcpd().version
     )
-  # :HACK: Requesting an integer directly doesn't handle having a null
-  # parent on the C++ side. To avoid needing to change the C++ code, this
-  # emulates an integer request using a float request.
-  actual_value = DoubleTransactionData()
-  actual_value.data = ctypes.c_double(initial_value)
-  actual_value.add_qualifiers([
-    Qualifiers.label(label),
-    Qualifiers.instance_type(InstanceTypes.IMPERATIVE),
-    # Format the field to show zero decimal places (i.e. An integer)
-    Qualifiers.markup(".0f"),
-  ])
-  return int(_request_transaction_and_wait_for_result(
-    DoubleTransactionData,
-    actual_value
-  ))
+
+  # I think it looks better with the else because the two implementations
+  # are at the same indentation level.
+  # pylint: disable=no-else-return
+  if Mcpd().version < (1, 9):
+    # Prior to API version 1.9, requesting an integer directly doesn't handle
+    # having a null parent on the C++ side. Thus this needs to request a
+    # double with integer formatting.
+    def setup_double(transaction: DoubleTransaction):
+      transaction.value = initial_value
+      transaction.label = label
+      transaction.set_markup(".0f")
+
+    return _request_transaction_and_wait(
+      DoubleTransaction,
+      setup_double,
+      lambda transaction: int(transaction.value)
+    )
+  else:
+    def setup_integer(transaction: Integer64STransaction):
+      transaction.value = initial_value
+      transaction.label = label
+
+    return _request_transaction_and_wait(
+      Integer64STransaction,
+      setup_integer,
+      lambda transaction: int(transaction.value)
+    )
 
 
 def ask_question(question: str, *, title: str="Python") -> bool:
   """Ask a yes/no question.
 
   This creates a window with a "Yes" and a "No" button.
 
@@ -1477,37 +1530,103 @@
   """
   if Mcpd().version < (1, 8):
     raise TooOldForOperation(
       minimum_version=(1, 8),
       current_version=Mcpd().version
     )
 
-  actual_value = BooleanTransactionData()
-  actual_value.data = False
+  def setup(transaction: BooleanTransaction):
+    transaction.title = title
+    transaction.label = question
 
-  actual_value.add_qualifiers([
-    Qualifiers.label(question),
-    Qualifiers.title(title),
-    # The instance_type qualifier is used to find the factory for creating
-    # the ui representation.
-    Qualifiers.instance_type(InstanceTypes.IMPERATIVE),
-  ])
   try:
-    return _request_transaction_and_wait_for_result(
-      BooleanTransactionData,
-      actual_value
+    return _request_transaction_and_wait(
+      BooleanTransaction,
+      setup,
+      lambda transaction: transaction.value
     )
   except OperationCancelledError:
     # If the user clicks "No", then instead of sending a TransactionConfirm
     # message with a value of False, the server sends a TransactionCancel
     # message. The transaction converts this into an error, so catch the
     # error and return False.
     return False
 
 
+
+def multi_choice_question(
+    *args: Option,
+    title: str = "Python",
+    message: str = "Choose one",
+    icon: typing.Optional[Icon] = None) -> Option:
+  """Generate a multi-choice question window in the application.
+
+  Each option is displayed to the user and they can select one. The selected
+  option is returned by the function.
+
+  Parameters
+  ----------
+  args
+    The options to display to the user.
+  title
+    The title for the window which presents the options to the user. This
+    should ideally be only one word.
+    This is "Python" by default.
+  message
+    The message to display above the options presented to the user. This
+    should add additional clarification regarding what the user is choosing.
+  icon
+    The icon to display on the window containing the options.
+    This will be Icon.information() by default.
+
+  Returns
+  -------
+  Option
+    The option passed to args which the user selected.
+
+  Raises
+  ------
+  OperationCancelledError
+    If the user cancels the dialog.
+  ValueError
+    If no options are passed or if there are more options than the connected
+    application supports.
+    For the 2023.X series of applications, the maximum number of options is 5.
+  """
+  option_count = len(args)
+  if option_count == 0:
+    raise ValueError(
+      "At least one option must be specified."
+    )
+  if option_count >= 6:
+    raise ValueError(
+      f"{option_count} choices are not supported. "
+      "The maximum number of options is five."
+    )
+  def setup(transaction: QuestionTransaction):
+    transaction.title = title
+    transaction.message = message
+    transaction.icon = icon or Icon("Information")
+    for option in args:
+      transaction.add_response(
+        # pylint: disable=protected-access
+        option._setup
+      )
+
+  def read_result(transaction: QuestionTransaction):
+    return transaction.selected_index
+
+  index = _request_transaction_and_wait(
+    QuestionTransaction,
+    setup,
+    read_result
+  )
+  return args[index]
+
+
 def request_file(
     *,
     title: typing.Optional[str]=None,
     save: bool=False,
     extensions: typing.Optional[dict[str, str | typing.Sequence[str]]]=None,
     exclude_all_files_filter: bool = False
 ) -> pathlib.Path:
@@ -1614,42 +1733,40 @@
   to save, set the save parameter to True.
 
   >>> save_path = request_file(save=True)
   >>> with save_path.open(mode="w") as save_file:
   ...     # Save the file here.
   ...     pass
   """
-  qualifiers = [
-    Qualifiers.instance_type(InstanceTypes.IMPERATIVE),
-    Qualifiers.file_only(),
-  ]
-
-  if title:
-    qualifiers.append(
-      Qualifiers.title(title)
-    )
-  if save:
-    qualifiers.append(Qualifiers.as_save())
-  else:
-    qualifiers.append(Qualifiers.as_load())
-  if extensions is not None:
-    if Translation().version < (1, 10):
-      raise TooOldForOperation(
-        minimum_version=(1, 10),
-        current_version=Mcpd().version
-      )
-    qualifiers.append(
-      Qualifiers.file_filter(extensions)
-    )
-    if exclude_all_files_filter:
-      qualifiers.append(
-        Qualifiers.exclude_all_files_filter()
+  def setup(transaction: FileTransaction):
+    if title:
+      transaction.title = title
+    if save:
+      transaction.set_dialog_type(transaction.DialogType.SAVE)
+    else:
+      transaction.set_dialog_type(transaction.DialogType.LOAD)
+    if extensions:
+      if Translation().version < (1, 10):
+        raise TooOldForOperation(
+          minimum_version=(1, 10),
+          current_version=Mcpd().version
+        )
+      transaction.set_file_filter(
+        extensions,
+        exclude_all_files_filter
       )
 
-  return __request_file_path(qualifiers)
+  def read_result(transaction: FileTransaction) -> pathlib.Path:
+    return transaction.path
+
+  return _request_transaction_and_wait(
+    FileTransaction,
+    setup,
+    read_result
+  )
 
 
 def request_directory(*, title: typing.Optional[str]=None) -> pathlib.Path:
   """Creates an open directory dialog in the connected application.
 
   This does not read the contents of the directory. It only returns the path
   to the directory.
@@ -1661,98 +1778,57 @@
     no effect for applications with Project.version (1, 8) or lower.
 
   Returns
   -------
   pathlib.Path
     The path to the selected directory.
   """
-  qualifiers = [
-    Qualifiers.instance_type(InstanceTypes.IMPERATIVE),
-    Qualifiers.directory_only(),
-    Qualifiers.as_load(),
-  ]
-
-  if title is not None:
-    qualifiers.append(Qualifiers.title(title))
-
-  return __request_file_path(qualifiers)
+  def setup(transaction: DirectoryTransaction):
+    if title:
+      transaction.title = title
+
+  def read_result(transaction: DirectoryTransaction) -> pathlib.Path:
+    return transaction.path
+
+  return _request_transaction_and_wait(
+    DirectoryTransaction,
+    setup,
+    read_result
+  )
 
 
 def _decode_selection(outputs):
   """Function for decoding the selection from the transaction output."""
   for output in outputs.value:
     if output['idPath'] == 'selection':
       selection_string = output.get('value', '')
       break
   else:
     selection_string = ''
 
   return WorkflowSelection(selection_string)
 
 
-def _request_transaction_and_wait_for_result(
-    data_type: type[TransactionDataT],
-    initial_value: TransactionDataT) -> typing.Any:
-  """Request a Transaction with the transaction manager and returns the result.
-
-  Parameters
-  ----------
-  data_type
-    Data type of the transaction to request.
-  qualifiers
-    Qualifiers to pass to the transaction.
-  initial_value
-    Initial values to place in the panel.
-
-  Returns
-  -------
-  Any
-    The result of the transaction request.
-
-  Raises
-  ------
-  OperationCancelledError
-    If the user cancelled the operation.
-  OperationFailedError
-    If the operation failed to complete.
-  """
-  with TransactionManager() as manager, manager.create_transaction(
-      data_type=data_type,
-      initial_value=initial_value,
-      server_name="uiServer"
-      ) as transaction:
+def _request_transaction_and_wait(
+    transaction_type: type[TransactionT],
+    setup_transaction: typing.Callable[[TransactionT], None],
+    read_result: typing.Callable[[TransactionT], T]
+) -> T:
+  factory = default_factory.default_factory(Mcpd())
+  with TransactionManager(factory) as manager, manager.create_transaction(
+    transaction_type,
+  ) as transaction:
+    setup_transaction(transaction)
     try:
       transaction.send()
-      response = transaction.wait_for_value()
+      transaction.wait(manager.default_timeout)
+      return read_result(transaction)
     # These except statements raise from None because the inner exception
     # is not intended to be user facing.
     except TransactionCancelledError as error:
       LOGGER.info(error)
       raise OperationCancelledError(
         "The operation was cancelled by the user.") from None
     except TransactionFailedError as error:
       LOGGER.info(error)
       raise OperationFailedError(
         "The operation failed for unknown reasons.") from None
-    return response.data
-
-
-def __request_file_path(qualifiers: typing.Sequence[Qualifier]) -> pathlib.Path:
-  """Internal implementing of requesting a file or directory.
-
-  Parameters
-  ----------
-  qualifiers
-    Qualifiers to use when creating the file dialog.
-  """
-  if Mcpd().version < (1, 8):
-    raise TooOldForOperation(
-      minimum_version=(1, 8),
-      current_version=Mcpd().version
-    )
-  actual_value = PathTransactionData.invalid_path()
-  actual_value.add_qualifiers(qualifiers)
-
-  return _request_transaction_and_wait_for_result(
-    PathTransactionData,
-    actual_value
-  )
```

## mapteksdk/view.py

```diff
@@ -18,32 +18,85 @@
 ###############################################################################
 
 import copy
 import ctypes
 import enum
 import typing
 
+from mapteksdk.capi import Mcpd
 from mapteksdk.capi.viewer import Viewer, ViewerErrorCodes
 from mapteksdk.data import ObjectID, DataObject
 from mapteksdk.data.base import Extent
 from mapteksdk.geometry import Plane
-from mapteksdk.internal.comms import (InlineMessage, Message, Request,
-                                      request_no_body)
-from mapteksdk.internal.serialisation import FixedInteger32Mixin
+from mapteksdk.internal.comms import (
+  InlineMessage,
+  Message,
+  Request,
+  Response,
+  Double,
+  Int32s,
+  Int16u,
+  Int32u,
+  Factory,
+  default_factory,
+)
+from mapteksdk.internal.serialisation import (
+  FixedInteger32Mixin,
+  FixedInteger32uMixin
+)
 from mapteksdk.internal.normalise_selection import normalise_selection
 
+
+Point: "typing.TypeAlias" = typing.Tuple[Double, Double, Double]
+"""Tuple representing a point."""
+
+
+def request_no_body(
+  message_name: str,
+  response_type: typing.Type[Response],
+  factory: Factory,
+) -> Request:
+  """Create a request class with no body.
+
+  Parameters
+  ----------
+  message_name
+    The name of a message.
+  response_type
+    The type of response this request should expect.
+  factory
+    The factory the request will use to construct itself.
+
+  Returns
+  -------
+  type[Request]
+    A request with the specified message name and body.
+  """
+  class NoBody(Request):
+    """A request without a body."""
+    @classmethod
+    def message_name(cls) -> str:
+      return message_name
+
+    @classmethod
+    def response_type(cls) -> typing.Type[Response]:
+      return response_type
+
+  return NoBody(factory)
+
+
 class ViewNoLongerExists(RuntimeError):
   """Exception for when a view is expected but it no longer exists.
 
   The most common occurrence for this exception is when the view has been
   closed.
   """
 
 
-class ObjectFilter:
+class ObjectFilter(FixedInteger32uMixin, enum.IntEnum):
   """Describes different ways to filter what objects are returned by
   a ViewController."""
 
   DEFAULT = 0
   """Default - return all object except transient and background objects but
   ignoring visibility, and selection
 
@@ -57,14 +110,75 @@
 
   HIDDEN_ONLY = 1 << 1
   """Only return objects that are hidden in the view."""
 
   SELECTED_ONLY = 1 << 2
   """Only return objects that are selected and are in the view."""
 
+  def from_bytes(
+      self,
+      # pylint: disable=redefined-builtin
+      bytes,
+      byteorder = "big",
+      *,
+      signed = False):
+    """Return the integer represented by the given array of bytes.
+
+    bytes
+        Holds the array of bytes to convert. The argument must either
+        support the buffer protocol or be an iterable object
+        producing bytes. Bytes and bytearray are examples of built-in
+        objects that support the buffer protocol.
+    byteorder
+        The byte order used to represent the integer. If byteorder is
+        'big', the most significant byte is at the beginning of the
+        byte array. If byteorder is 'little', the most significant
+        byte is at the end of the byte array. To request the native
+        byte order of the host system, use 'sys.byteorder' as the
+        byte order value. Default is to use 'big'.
+    signed
+        Indicates whether two's complement is used to represent the integer.
+    """
+    # :HACK: There is a mismatched quotation mark in the docstring in the
+    # standard library for this function, which results in the
+    # sphinx documentation failing to build.
+    # Overwrite the function to fix the docstring.
+    return super().from_bytes(bytes, byteorder, signed=signed) # type: ignore
+
+  def to_bytes(
+      self,
+      length = 1,
+      byteorder = "big",
+      *,
+      signed = False):
+    """Return an array of bytes representing an integer.
+
+    Parameters
+    ----------
+    length
+      Length of bytes object to use. An OverflowError is raised if the
+      integer is not representable with the given number of bytes.
+      Default is length 1.
+    byteorder
+      The byte order used to represent the integer.
+      If byteorder is 'big', the most significant byte is at the beginning
+      of the byte array. If byteorder is 'little', the most significant byte
+      is at the end of the byte array. To request the native byte order of
+      the host system, use 'sys.byteorder' as the byte order value.
+      Default is to use 'big'.
+    signed
+      Determines whether two's complement is used to represent the integer.
+      If signed is False and a negative integer is given, an OverflowError
+      is raised.
+    """
+    # :HACK: There is a mismatched quotation mark in the docstring in the
+    # standard library for this function, which results in the
+    # sphinx documentation failing to build.
+    # Overwrite the function to fix the docstring.
+    return super().to_bytes(length, byteorder, signed=signed)
 
 class SectionMode(enum.IntEnum):
   """Enumeration of the available section modes.
   """
 
   NO_MODE = 0
   """No section mode is active."""
@@ -360,43 +474,50 @@
       raise ValueError(error_message)
 
     self.server_name = server_name.value.decode('utf-8')
 
     # Like the DataObject class provide the ability to query the ID of the
     # view controller.
     self.id = view_id
+    self._factory = default_factory.default_factory(Mcpd())
 
   def __repr__(self):
     return type(self).__name__ + f'({self.id}, "{self.server_name}")'
 
   @property
   def window_title(self) -> str:
     """Return the window title.
 
     This is the name of the view window as seen in the application.
     """
 
     class WindowTitle(Request):
       """Defines message for querying what window title of a view."""
 
-      class Response(Message):
+      class WindowResponse(Response):
         """The response containing the window title."""
         title: str
 
-      message_name: typing.ClassVar[str] = 'WindowTitle'
-      response_type = Response
+      @classmethod
+      def message_name(cls) -> str:
+        return 'WindowTitle'
+
+      @classmethod
+      def response_type(cls) -> typing.Type[Response]:
+        return cls.WindowResponse
 
       view_name: str
 
-    request = WindowTitle()
+    request = WindowTitle(self._factory)
     request.view_name = self.server_name
 
     # The viewer server doesn't know its title as its the uiServer that
     # is responsible for that.
-    response = request.send(destination='uiServer')
+    response: WindowTitle.WindowResponse = request.send(
+      'uiServer') # type: ignore
     return response.title
 
   def close(self):
     """Close the view.
 
     Avoid closing views that you didn't open, as such avoid closing the view
     if it came from a non-empty active view. This is because you may close a
@@ -416,30 +537,30 @@
     >>> project = Project()
     >>> view = operations.open_new_view()
     >>> input('Press enter to finish')
     >>> view.close()
     """
     class DestroyView(Message):
       """This message destroys (closes) the view."""
-      message_name: typing.ClassVar[str] = 'DestroyView'
+      @classmethod
+      def message_name(cls) -> str:
+        return 'DestroyView'
 
-    DestroyView().send(destination=self.server_name)
+    DestroyView(self._factory).send(self.server_name)
 
-  def scene_extents(view) -> Extent:
+  def scene_extents(self) -> Extent:
     """Return the scene extents of this view."""
-    point_type = typing.Tuple[ctypes.c_double, ctypes.c_double,
-                              ctypes.c_double]
-
-    class Response(Message):
-        """The response with the extents for the scene."""
-        minimum: point_type
-        maximum: point_type
-
-    request = request_no_body('SceneExtent', Response)
-    response: Response = request.send(destination=view.server_name)
+    class SceneResponse(Response):
+      """The response with the extents for the scene."""
+      minimum: Point
+      maximum: Point
+
+    request = request_no_body('SceneExtent', SceneResponse, self._factory)
+    response: SceneResponse = request.send(
+      self.server_name) # type: ignore
     return Extent(response.minimum, response.maximum)
 
   def objects_in_view(
       self,
       object_filter: ObjectFilter=ObjectFilter.DEFAULT
       ) -> typing.List[ObjectID]:
     """Return a list of objects that are in the the view.
@@ -463,29 +584,35 @@
     # This should ideally handle values of the form: [Surface, Polygon,
     # Polyline]
     # However receiving a message containing it would be problematic as its
     # not easy to map it back.
 
     class ObjectsInView(Request):
       """Defines message for querying what objects are in a view."""
-      class Response(Message):
+      class InViewResponse(Response):
         """The response back with what objects are in a view."""
         objects: typing.List[ObjectID[DataObject]]
 
-      message_name: typing.ClassVar[str] = 'ObjectsInView'
-      response_type = Response
+      @classmethod
+      def message_name(cls) -> str:
+        return 'ObjectsInView'
+
+      @classmethod
+      def response_type(cls) -> typing.Type[Response]:
+        return cls.InViewResponse
 
-      object_filter: ctypes.c_uint32  # ObjectFilter
-      type_filter: typing.List[ctypes.c_uint16]
+      object_filter: ObjectFilter
+      type_filter: typing.List[Int16u]
 
-    request = ObjectsInView()
+    request = ObjectsInView(self._factory)
     request.object_filter = object_filter
     request.type_filter = []
 
-    response = request.send(destination=self.server_name)
+    response: ObjectsInView.InViewResponse = request.send(
+      self.server_name) # type: ignore
     return response.objects
 
   def add_objects(
       self,
       objects: typing.Iterable[typing.Union[ObjectID, DataObject, str]]):
     """Adds the provided objects to the view.
 
@@ -493,23 +620,25 @@
     ----------
     objects
       A list of IDs of objects to add to the view.
     """
 
     class AddObjects(Message):
       """Message for the viewer for adding objects to it."""
-      message_name: typing.ClassVar[str] = 'AddObjects'
+      @classmethod
+      def message_name(cls) -> str:
+        return 'AddObjects'
 
       objects: typing.List[ObjectID[DataObject]]
-      drop_point: typing.Tuple[ctypes.c_double, ctypes.c_double] = (
+      drop_point: typing.Tuple[Double, Double] = (
         float('NaN'), float('NaN'))
 
-    request = AddObjects()
-    request.objects = normalise_selection(objects)
-    request.send(destination=self.server_name)
+    request = AddObjects(self._factory)
+    request.objects = list(normalise_selection(objects))
+    request.send(self.server_name)
 
   def add_object(self, object_to_add: typing.Union[ObjectID, DataObject, str]):
     """Add a single object to the view.
 
     Parameters
     ----------
     object_to_add
@@ -529,21 +658,23 @@
     ----------
     objects
       A list of IDs of objects to remove from the view.
     """
 
     class RemoveObjects(Message):
       """Message for the viewer for removing objects from it."""
-      message_name: typing.ClassVar[str] = 'RemoveObjects'
+      @classmethod
+      def message_name(cls) -> str:
+        return 'RemoveObjects'
 
       objects: typing.List[ObjectID[DataObject]]
 
-    request = RemoveObjects()
-    request.objects = normalise_selection(objects)
-    request.send(destination=self.server_name)
+    request = RemoveObjects(self._factory)
+    request.objects = list(normalise_selection(objects))
+    request.send(self.server_name)
 
   def remove_object(
       self, object_to_remove: typing.Union[ObjectID, DataObject, str]):
     """Remove a single object from the view.
 
     Parameters
     ----------
@@ -565,29 +696,33 @@
     objects
       A list of IDs of objects to hide.
     """
 
     if Viewer().version >= (1, 1):
       class HideObjects(Message):
         """Message for the viewer for hiding objects."""
-        message_name: typing.ClassVar[str] = 'HideObjects'
+        @classmethod
+        def message_name(cls) -> str:
+          return 'HideObjects'
 
         objects: typing.List[ObjectID[DataObject]]
-        mouse: typing.Tuple[ctypes.c_double, ctypes.c_double] = (
+        mouse: typing.Tuple[Double, Double] = (
           float('NaN'), float('NaN'))
     else:
       class HideObjects(Message):
         """Message for the viewer for hiding objects."""
-        message_name: typing.ClassVar[str] = 'HideObjects'
+        @classmethod
+        def message_name(cls) -> str:
+          return 'HideObjects'
 
         objects: typing.List[ObjectID[DataObject]]
 
-    request = HideObjects()
-    request.objects = normalise_selection(objects)
-    request.send(destination=self.server_name)
+    request = HideObjects(self._factory)
+    request.objects = list(normalise_selection(objects))
+    request.send(self.server_name)
 
   def hide_object(
       self, object_to_hide: typing.Union[ObjectID, DataObject, str]):
     """Hide a single object in the view.
 
     Parameters
     ----------
@@ -608,21 +743,23 @@
     ----------
     objects
       A list of IDs of objects to hide.
     """
 
     class ShowObjects(Message):
       """Message for the viewer for showing objects."""
-      message_name: typing.ClassVar[str] = 'ShowObjects'
+      @classmethod
+      def message_name(cls) -> str:
+        return 'ShowObjects'
 
       objects: typing.List[ObjectID[DataObject]]
 
-    request = ShowObjects()
-    request.objects = normalise_selection(objects)
-    request.send(destination=self.server_name)
+    request = ShowObjects(self._factory)
+    request.objects = list(normalise_selection(objects))
+    request.send(self.server_name)
 
   def show_object(
       self, object_to_show: typing.Union[ObjectID, DataObject, str]):
     """Show a single hidden object in the view.
 
     Parameters
     ----------
@@ -689,90 +826,101 @@
     See Also
     --------
     remove_objects : To remove the object from the view.
     promote_transient_objects : To promote transient objects.
     """
     class AddTransientGeometry(Message):
       """Message for the viewer for adding  transient objects to it."""
-      message_name: typing.ClassVar[str] = 'AddTransientGeometry'
+      @classmethod
+      def message_name(cls) -> str:
+        return 'AddTransientGeometry'
       objects: typing.List[ObjectID[DataObject]]
       settings: TransientGeometrySettings
 
-    request = AddTransientGeometry()
-    request.objects = normalise_selection(objects)
+    request = AddTransientGeometry(self._factory)
+    request.objects = list(normalise_selection(objects))
     request.settings = settings
-    request.send(destination=self.server_name)
+    request.send(self.server_name)
 
   def promote_transient_object(
       self,
-      object: typing.Union[ObjectID, DataObject, str]):
+      data_object: typing.Union[ObjectID, DataObject, str]):
     """Promote a transient object to being a permanent object.
 
     This is relevant to the view only, to ensure the geometry persists it
     should be added to the project.
     """
-    self.promote_transient_objects([object])
+    self.promote_transient_objects([data_object])
 
   def promote_transient_objects(
       self,
       objects: typing.Iterable[typing.Union[ObjectID, DataObject, str]]):
     """Promote transient objects to being permanent objects.
 
     This is relevant to the view only, to ensure the objects persists they
     should be added to the project.
     """
     class PromoteTransientGeometry(Message):
       """Message for the viewer for adding  transient objects to it."""
-      message_name: typing.ClassVar[str] = 'PromoteTransientGeometry'
+      @classmethod
+      def message_name(cls) -> str:
+        return 'PromoteTransientGeometry'
       objects: typing.List[ObjectID[DataObject]]
 
-    request = PromoteTransientGeometry()
-    request.objects = normalise_selection(objects)
-    request.send(destination=self.server_name)
+    request = PromoteTransientGeometry(self._factory)
+    request.objects = list(normalise_selection(objects))
+    request.send(self.server_name)
 
   def transient_objects_in_view(self) -> \
       typing.List[typing.Tuple[ObjectID[DataObject], TransientGeometrySettings]]:
     """
     Return the transient objects that are in the the view and their settings.
 
     Returns
     -------
     list
       A list of each transient object and their corresponding settings.
     """
     class TransientObjectsInView(Request):
       """Message for the viewer for querying transient objects in it."""
-      class Response(Message):
+      class TransientResponse(Response):
         """The response back with what transient objects are in a view."""
         object_groups: typing.List[typing.List[ObjectID[DataObject]]]
         settings: typing.List[TransientGeometrySettings]
 
-      message_name: typing.ClassVar[str] = 'TransientObjectsInView'
-      response_type = Response
-
-    request = TransientObjectsInView()
-    response = request.send(destination=self.server_name)
+      @classmethod
+      def message_name(cls) -> str:
+        return 'TransientObjectsInView'
+
+      @classmethod
+      def response_type(cls) -> typing.Type[Response]:
+        return cls.TransientResponse
+
+    request = TransientObjectsInView(self._factory)
+    response: TransientObjectsInView.TransientResponse = request.send(
+      self.server_name) # type: ignore
 
     # Flatten out the list also known as de-grouping them as the objects were
     # grouped together.
     result = []
     for objects, settings in zip(response.object_groups, response.settings):
       for transient_object in objects:
         result.append((transient_object, copy.deepcopy(settings)))
     return result
 
   def action_plane_section_widths(self) -> typing.Tuple[float, float]:
     """Return the widths of the section in this view."""
-    class Response(Message):
+    class SectionWidthResponse(Response):
       """The response containing the section widths."""
-      back: ctypes.c_double
-      front: ctypes.c_double
+      back: Double
+      front: Double
 
-    request = request_no_body('ActionPlaneSectionWidths', Response)
-    response: Response = request.send(destination=self.server_name)
+    request = request_no_body('ActionPlaneSectionWidths', SectionWidthResponse, self._factory)
+    response: SectionWidthResponse = request.send(
+      self.server_name) # type: ignore
     return (response.back, response.front)
 
   def set_action_plane_section_widths(
       self, back_width: float, front_width: float):
     """Change the section width of the view.
 
     This will only take affect if view's section mode is not
@@ -791,31 +939,34 @@
     --------
     action_plane_section_mode : Query the current section mode
     set_action_plane_section_mode : Set the current section modes (enable
         sectioning)
     """
     class SetActionPlaneSectionWidths(Message):
       """Message for changing the section width."""
-      message_name = 'SetActionPlaneSectionWidths'
-      back: ctypes.c_double
-      front: ctypes.c_double
+      @classmethod
+      def message_name(cls) -> str:
+        return 'SetActionPlaneSectionWidths'
+      back: Double
+      front: Double
 
-    message = SetActionPlaneSectionWidths()
+    message = SetActionPlaneSectionWidths(self._factory)
     message.back = back_width
     message.front = front_width
-    message.send(destination=self.server_name)
+    message.send(self.server_name)
 
   def action_plane_section_mode(self) -> SectionMode:
     """Return the current selection mode of this view."""
-    class Response(Message):
+    class SectionModeResponse(Response):
       """The response containing the section mode."""
-      section_mode: ctypes.c_int32  # vwrE_SectionMode.
+      section_mode: Int32s  # vwrE_SectionMode.
 
-    request = request_no_body('ActionPlaneSectionMode', Response)
-    response: Response = request.send(destination=self.server_name)
+    request = request_no_body('ActionPlaneSectionMode', SectionModeResponse, self._factory)
+    response: SectionModeResponse = request.send(
+      self.server_name) # type: ignore
     return SectionMode(response.section_mode)
 
   def set_action_plane_section_mode(self, section_mode: SectionMode):
     """Change the view's section mode to the mode given.
 
     Parameters
     ----------
@@ -840,62 +991,66 @@
     >>> from mapteksdk.view import SectionMode
     >>> project = Project()
     >>> view = active_view()
     >>> view.set_action_plane_section_mode(SectionMode.NO_MODE)
     """
     class SetActionPlaneSectionMode(Message):
       """Message for changing the section mode."""
-      message_name = 'SetActionPlaneSectionMode'
-      section_mode: ctypes.c_int32
+      @classmethod
+      def message_name(cls) -> str:
+        return 'SetActionPlaneSectionMode'
+      section_mode: Int32s
 
-    message = SetActionPlaneSectionMode()
+    message = SetActionPlaneSectionMode(self._factory)
     message.section_mode = section_mode
-    message.send(destination=self.server_name)
+    message.send(self.server_name)
+
+  def action_plane(self) -> Plane:
+    """Return the action plane in this view."""
+    class ActionPlaneResponse(Response):
+      """The response containing the action plane and more."""
+      action_plane: _ActionPlane
 
-  def set_action_plane(view, plane: Plane):
+    request = request_no_body('ActionPlane', ActionPlaneResponse, self._factory)
+    response: ActionPlaneResponse = request.send(
+      self.server_name) # type: ignore
+
+    return response.action_plane.plane
+
+  def set_action_plane(self, plane: Plane):
     """Set the action plane in this view.
 
     Parameters
     ----------
     plane
       The plane to use for the action plane.
     """
     class SetActionPlane(Message):
       """The message to set the action plane of the view this is sent to."""
-      message_name = 'SetActionPlane'
-
-      # Define the coefficients of a plane equation.
-      plane_coefficient_a: ctypes.c_double
-      plane_coefficient_b: ctypes.c_double
-      plane_coefficient_c: ctypes.c_double
-      plane_coefficient_d: ctypes.c_double
-
-      visualisation_centroid_x: ctypes.c_double = float('NaN')
-      visualisation_centroid_y: ctypes.c_double = float('NaN')
-      visualisation_centroid_z: ctypes.c_double = float('NaN')
-
-      grid_orientation_x: ctypes.c_double = float('NaN')
-      grid_orientation_y: ctypes.c_double = float('NaN')
-      grid_orientation_z: ctypes.c_double = float('NaN')
-
-    message = SetActionPlane()
-    message.plane_coefficient_a = plane.coefficient_a
-    message.plane_coefficient_b = plane.coefficient_b
-    message.plane_coefficient_c = plane.coefficient_c
-    message.plane_coefficient_d = plane.coefficient_d
-    message.send(destination=view.server_name)
+      @classmethod
+      def message_name(cls) -> str:
+        return 'SetActionPlane'
+
+      action_plane: _ActionPlane
+
+    message = SetActionPlane(self._factory)
+    message.action_plane = _ActionPlane()
+    message.action_plane.plane = plane
+    message.send(self.server_name)
 
   def action_plane_section_step_distance(self) -> float:
     """The distance that the action plane will move if it is stepped by."""
-    class Response(Message):
+    class StepDistanceResponse(Response):
       """The response containing the step distance."""
-      step_distance: ctypes.c_double
+      step_distance: Double
 
-    request = request_no_body('ActionPlaneSectionStepDistance', Response)
-    response: Response = request.send(destination=self.server_name)
+    request = request_no_body(
+      'ActionPlaneSectionStepDistance', StepDistanceResponse, self._factory)
+    response: StepDistanceResponse = request.send(
+      self.server_name) # type: ignore
     return response.step_distance
 
   def set_action_plane_section_step_distance(self, step_distance: float):
     """Change the section step distance of the view.
 
     Parameters
     ----------
@@ -905,20 +1060,22 @@
     See Also
     --------
     step_action_plane_section_forwards : Step forwards by the last distance.
     step_action_plane_section_backwards : Step backwards by the last distance.
     """
     class SetStepDistance(Message):
       """Message for changing the section step distance."""
-      message_name = 'SetActionPlaneSectionStepDistance'
-      step_distance: ctypes.c_double
+      @classmethod
+      def message_name(cls) -> str:
+        return 'SetActionPlaneSectionStepDistance'
+      step_distance: Double
 
-    message = SetStepDistance()
+    message = SetStepDistance(self._factory)
     message.step_distance = step_distance
-    message.send(destination=self.server_name)
+    message.send(self.server_name)
 
   def step_action_plane_section_forwards(self):
     """Step (moves) the action plane forwards.
 
     The distance the plane will move is based on the last set step distance for
     the view.
 
@@ -952,81 +1109,91 @@
 
     When changing the background colour, the alpha is optional and
     the colour may be given as either a tuple, list or ndarray.
     """
 
     class RequestBackgroundColour(Request):
       """Query background colour of a view window."""
-      class Response(Message):
+      class BackgroundColourResponse(Response):
         """Response to a request background colour request"""
-        colour: ctypes.c_uint32
+        colour: Int32u
 
-      message_name: typing.ClassVar[str] = 'BackgroundColour'
-      response_type: typing.ClassVar[type] = Response
-
-    request = RequestBackgroundColour()
-    response = request.send(destination=self.server_name)
+      @classmethod
+      def message_name(cls) -> str:
+        return 'BackgroundColour'
+
+      @classmethod
+      def response_type(cls) -> type[BackgroundColourResponse]:
+        return cls.BackgroundColourResponse
+
+    request = RequestBackgroundColour(self._factory)
+    response: RequestBackgroundColour.BackgroundColourResponse = request.send(
+      self.server_name) # type: ignore
 
     alpha = (response.colour >> 24) & 0xFF
     blue = (response.colour >> 16) & 0xFF
     green = (response.colour >> 8) & 0xFF
     red = response.colour & 0xFF
 
     return (red, green, blue, alpha)
 
   @background_colour.setter
-  def background_colour(self, new_colour: typing.Iterable[int]):
+  def background_colour(self, new_colour: typing.Sequence[int]):
     # This could be useful when detecting if really dark coloured objects are
     # in the view and switching the background so it is lighter colour to
     # give contrast between foreground and background.
     #
     # It could also be possible to implement a night-light like application
     # which reduces specific colours used in the background as the time of day
     # changes.
 
     class SetBackgroundColour(Message):
       """Sets the background colour of a view window."""
-      message_name: typing.ClassVar[str] = 'SetBackgroundColour'
+      @classmethod
+      def message_name(cls) -> str:
+        return 'SetBackgroundColour'
 
-      colour: ctypes.c_uint32
+      colour: Int32u
 
     red, green, blue = new_colour[:3]
     if len(new_colour) == 4:
       alpha = new_colour[3]
     else:
       alpha = 255
 
     # Colour encoded as a 32-bit integer. This more than likely needs
     # to be packaged up as part of the comms module.
     colour = (alpha << 24) | (blue << 16) | (green << 8) | (red << 0)
 
-    message = SetBackgroundColour()
+    message = SetBackgroundColour(self._factory)
     message.colour = colour
-    message.send(destination=self.server_name)
+    message.send(self.server_name)
 
   def _start_camera_transition(self, transition_time: float):
     """Enables the camera to smoothly transition to a new state
 
     Parameters
     ----------
     transition_time
       The time the transition should last in seconds.
     """
     class StartTransition(Message):
       """Tells the viewer that it will be transitioning the camera to a new
       location.
       """
-      message_name: typing.ClassVar[str] = 'StartTransition'
+      @classmethod
+      def message_name(cls) -> str:
+        return 'StartTransition'
 
-      axes_transition_mode: ctypes.c_int32 = 2
-      transition_time: ctypes.c_double
+      axes_transition_mode: Int32s = 2
+      transition_time: Double
 
-    message = StartTransition()
+    message = StartTransition(self._factory)
     message.transition_time = transition_time
-    message.send(destination=self.server_name)
+    message.send(self.server_name)
 
   def _step_action_plane_section(self, direction: SectionStepDirection):
     """Step the action plane section in the given direction.
 
     The distance the plane will move is based on the last set step distance for
     the view.
 
@@ -1034,13 +1201,51 @@
     ----------
     direction
       The direction to step the section.
     """
     class StepActionPlaneSection(Message):
       """Message that causes the view to step the action plane in a direction.
       """
-      message_name = 'StepActionPlaneSection'
-      step_direction: ctypes.c_int32
+      @classmethod
+      def message_name(cls) -> str:
+        return 'StepActionPlaneSection'
+      step_direction: Int32s
 
-    message = StepActionPlaneSection()
+    message = StepActionPlaneSection(self._factory)
     message.step_direction = direction
-    message.send(destination=self.server_name)
+    message.send(self.server_name)
+
+
+class _ActionPlane(InlineMessage):
+  """An action plane is a plane set in a view.
+
+  It is used for digitising points and describing the plane to use for
+  quickly setting up clip plane sectioning data.
+  """
+  plane_coefficient_a: Double
+  plane_coefficient_b: Double
+  plane_coefficient_c: Double
+  plane_coefficient_d: Double
+
+  visualisation_centroid_x: Double = float('NaN')
+  visualisation_centroid_y: Double = float('NaN')
+  visualisation_centroid_z: Double = float('NaN')
+
+  grid_orientation_x: Double = float('NaN')
+  grid_orientation_y: Double = float('NaN')
+  grid_orientation_z: Double = float('NaN')
+
+  @property
+  def plane(self) -> Plane:
+    """The plane portion of the action plane."""
+    return Plane(self.plane_coefficient_a,
+                 self.plane_coefficient_b,
+                 self.plane_coefficient_c,
+                 self.plane_coefficient_d)
+
+  @plane.setter
+  def plane(self, plane: Plane):
+    """The plane portion of the action plane."""
+    self.plane_coefficient_a = plane.coefficient_a
+    self.plane_coefficient_b = plane.coefficient_b
+    self.plane_coefficient_c = plane.coefficient_c
+    self.plane_coefficient_d = plane.coefficient_d
```

## mapteksdk/capi/dataengine.py

```diff
@@ -270,14 +270,31 @@
 
   def TypeIsA(self, object_type, type_index):
     """Wrapper for checking the type of an object."""
     if type_index is None:
       return False
     return self.dll.DataEngineTypeIsA(object_type, type_index)
 
+  def RootContainer(self) -> T_ObjectHandle:
+    """Return the object handle for the root container.
+
+    It is not valid to call this function without first creating or opening
+    a DataEngine.
+    """
+    # Older versions of the software will most likely cause the Python process
+    # to crash. This is a sign that the mapteksdk developers made a mistake
+    # rather than the end user or the end user managed find an untested path
+    # that avoided opening the DataEngine.
+    object_handle = self.dll.DataEngineRootContainer()
+
+    if not object_handle:
+      raise CApiUnknownError(self.dll.DataEngineErrorMessage())
+
+    return object_handle
+
   def CancelObjectCommit(self, edit_handle):
     """Handles backwards compatibility by ignoring the cancel."""
     if self.version < (1, 6):
       # Do nothing, ignore the cancel in older versions.
       self.log.warning("Cannot cancel the commit of an object due to old "
                        "application version. Some changes may still be "
                        "committed.")
```

## mapteksdk/capi/license.py

```diff
@@ -10,17 +10,28 @@
 #
 # (C) Copyright 2020, Maptek Pty Ltd. All rights reserved.
 #
 ###############################################################################
 
 # pylint: disable=line-too-long
 import ctypes
+import enum
 from .util import singleton
 from .wrapper_base import WrapperBase
 
+
+class ReturnValues(enum.IntEnum):
+  """Represents possible return values for functions in mdf_license.dll."""
+  NONE_FOUND_ERROR = -4
+  BUFFER_TO_SMALL_ERROR = -3
+  OTHER_ERROR = -1
+  FAILURE = 0
+  SUCCESS = 1
+
+
 @singleton
 class License(WrapperBase):
   """License - wrapper for mdf_license.dll"""
   def __init__(self):
     super().__init__("mdf_license", "mapteksdk.capi.license")
 
   @staticmethod
@@ -42,14 +53,62 @@
         ctypes.byref(supported_format_size))
 
     if result != 1:
       raise ValueError('Could not determine supported licence format.')
 
     return bytearray(supported_format.value).decode('utf-8')
 
+  def host_id(self) -> str:
+    """Return a unique identifier for this machine (host).
+
+    Raises
+    ------
+    ValueError
+      If the host ID could not be found.
+    """
+    def check_for_errors(return_value):
+      if return_value == ReturnValues.NONE_FOUND_ERROR:
+        raise ValueError("No host ID found.")
+      if return_value == ReturnValues.OTHER_ERROR:
+        raise ValueError("Unable to determine host ID.")
+      return return_value
+
+    next_version_function = getattr(
+      self.dll, 'LicenceSystemHostIdNewestVersion', None)
+
+    # IF this function exists it means SystemHostId() requires the version.
+    if next_version_function:
+      host_id_version = next_version_function()
+      host_id_function = lambda host_id, size: self.SystemHostId(
+        host_id, size, host_id_version)
+    else:
+      host_id_function = self.SystemHostId
+
+    host_id_size = 4
+    host_id = ctypes.create_string_buffer(host_id_size)
+
+    expected_host_id_size = host_id_function(host_id, host_id_size)
+    check_for_errors(expected_host_id_size)
+    if expected_host_id_size and expected_host_id_size != host_id_size:
+      # If the buffer was the wrong size, try again with the right size.
+      host_id = ctypes.create_string_buffer(expected_host_id_size)
+      expected_host_id_size = host_id_function(host_id, expected_host_id_size)
+      check_for_errors(expected_host_id_size)
+    return bytearray(host_id.value).decode('utf-8')
+
+  def host_id_version(self) -> int:
+    """Returns the newest host ID version supported by the loaded DLL."""
+    newest_version_function = getattr(
+      self.dll, 'LicenceSystemHostIdNewestVersion', None)
+    if newest_version_function:
+      return newest_version_function()
+
+    # If the function is not in the DLL it means the DLL uses version 0.
+    return 0
+
   def capi_functions(self):
     return [
       # Functions changed in version 0.
       # Format:
       # "name" : (return_type, arg_types)
       {"LicenceGetFormat" : (ctypes.c_int64, [ctypes.c_char_p, ctypes.POINTER(ctypes.c_uint32), ]),
        "LicenceGetFormatOfLicenceString" : (ctypes.c_int64, [ctypes.c_char_p, ctypes.c_uint32, ctypes.c_char_p, ctypes.POINTER(ctypes.c_uint32), ]),
@@ -72,9 +131,12 @@
        "LicenceGetLastError" : (ctypes.c_int64, [ctypes.POINTER(ctypes.c_void_p), ctypes.POINTER(ctypes.c_void_p), ]),
        "LicenceGetFeatures" : (ctypes.c_int64, [ctypes.c_char_p, ctypes.c_uint32, ctypes.c_char_p, ctypes.POINTER(ctypes.c_uint32), ctypes.c_uint64, ]),
        "LicenceRemoveExpiredTpmLicences" : (ctypes.c_int64, [ctypes.c_uint64, ]),
        "LicenceRemoveExpiredDongleLicences" : (ctypes.c_int64, [ctypes.c_char_p, ctypes.c_uint32, ctypes.c_uint64, ]),
        "LicenceGetHaspDriverVersion" : (ctypes.c_int64, [ctypes.c_char_p, ctypes.POINTER(ctypes.c_uint32), ]),},
       # Functions changed in version 1.
       {"LicenceCApiVersion" : (ctypes.c_uint32, None),
-       "LicenceCApiMinorVersion" : (ctypes.c_uint32, None),}
+       "LicenceCApiMinorVersion" : (ctypes.c_uint32, None),
+       "LicenceSystemHostIdNewestVersion" : (ctypes.c_int32, None),
+      }
     ]
+
```

## mapteksdk/capi/util.py

```diff
@@ -14,27 +14,15 @@
 from __future__ import annotations
 
 import ctypes
 import enum
 import logging
 import os
 import pathlib
-import sys
-import typing
 
-USING_PYTHON_37 = sys.version_info[:2] == (3, 7)
-
-# pylint: disable=protected-access
-if typing.TYPE_CHECKING:
-  if USING_PYTHON_37:
-    # This type doesn't exist in Python 3.7.
-    DLL_DIRECTORY = None
-  else:
-    DLL_DIRECTORY = os._AddedDllDirectory
-# pylint: enable=protected-access
 
 class DllDirectoryState(enum.Enum):
   """Enum representing the state of the DLL directories."""
   NOT_SET = enum.auto()
   """The directories to load DLLs from have not been set.
 
   This is the state before the script has connected to an application
@@ -71,15 +59,15 @@
     explicitly loaded DLLs.
   * In practice, this includes at least 40 MDF DLLs and an unknown number
     of operating system DLLs.
   * Because most loaded DLLs cannot be unloaded, the SDK makes no effort
     to unload them.
   * This makes it impossible to disconnect from one application
     (e.g. PointStudio) and then connect to another application (e.g.
-    Vulcan GeologyCore or a different version of PointStudio) because
+    GeologyCore or a different version of PointStudio) because
     it would attempt to use the DLLs loaded from the original application
     which are incompatible. (Even if the explicitly loaded DLLs were unloaded
     first, it still would not work because it would attempt to satisfy
     the dependencies of the explicitly loaded DLLs with the dependencies
     loaded for the original application, resulting in a mix of incompatible
     DLLs from both applications)
   * It is however possible to connect to the same application or a different
@@ -91,33 +79,21 @@
 _DLL_DIRECTORIES: list[pathlib.Path] = []
 """List of paths to directories to load DLLs from.
 
 The SDK will only explicitly load DLLs from these paths. Earlier paths in the
 list will be searched first.
 """
 
-_DEPENDENCY_DLL_DIRECTORY: DLL_DIRECTORY | None = None
-"""An additional directory to load DLL dependencies from.
+_DEPENDENCY_DIRECTORIES: list | None = None
+"""List of objects returned by os.add_dll_directories().
 
-In Python 3.8 and newer, the dependency search order is as follows:
-1: The directory containing the DLL (from _DLL_DIRECTORIES).
-2: This directory.
-3: The operating system.
-
-If the dependency cannot be found in any of these places, an error will be
-raised.
-
-Notes
------
-* This is only set during testing and when connecting to an application
-  compiled from source. This enables DLLs in the eureka shlib directory
-  to load DLLs from the mdf shlib directory.
-* This is only used in Python 3.8 and newer.
-* This is only stored to allow for disposing of the DLL directory when
-  it is no longer needed.
+os.add_dll_directories() is called on each path in _DLL_DIRECTORIES and this
+list contains these objects. These are closed when disconnecting from the
+application, preventing further loading of DLLs from the directories in
+_DLL_DIRECTORIES.
 """
 
 _REMEMBERED_DLL_PATH: str | None = None
 """The path passed to register_dll_directory().
 
 After disconnecting from one application, it is only valid for the script
 to reconnect to the same application or a different instance of that application
@@ -255,26 +231,26 @@
 def register_dll_directory(base_path: str):
   """Registers a DLL directory.
 
   This handles the differences between installed applications versus
   applications compiled from source.
   """
   # pylint: disable=global-statement
-  global _DEPENDENCY_DLL_DIRECTORY
+  global _DEPENDENCY_DIRECTORIES
   global _REMEMBERED_DLL_PATH
   global _DLL_STATUS
 
   # Disallow connecting to multiple applications at once.
   if _DLL_STATUS is DllDirectoryState.SET:
     raise MultipleApplicationConnectionsError(
       "Cannot connect to an application because the script is already "
       "connected to an application.")
 
   # The SDK cannot disconnect from one application (e.g. PointStudio) and
-  # then connect to another application (e.g. Vulcan GeologyCore).
+  # then connect to another application (e.g. GeologyCore).
   if (_DLL_STATUS is DllDirectoryState.CLEARED
         and _REMEMBERED_DLL_PATH != base_path):
     raise MultipleApplicationConnectionsError(
       "Cannot connect to multiple different applications in one script")
 
   logger.debug("Loading dlls from %s", base_path)
 
@@ -287,71 +263,53 @@
     _DLL_DIRECTORIES.append(shlib_path)
 
     # Also add the eureka shlib folder to the search path. This is needed
     # to be able to find the drillhole model C API.
     eureka_path = shlib_path / ".." / ".." / "eureka" / "shlib"
     if eureka_path.is_dir():
       _DLL_DIRECTORIES.append(eureka_path)
-
-    # :TRICKY: In Python 3.8 and newer, the dependencies of a DLL will be
-    # loaded from the same directory as the DLL. The DLLs in the eureka
-    # (and potentially other non-mdf shlib directories in the future) will need
-    # to load dependencies from the mdf shlib directory.
-    # To allow this, add the mdf shlib directory to the list of directories
-    # to load dependencies from.
-    try:
-      _DEPENDENCY_DLL_DIRECTORY = os.add_dll_directory(shlib_path)
-    except AttributeError:
-      # :TODO: SDK-506: os.add_dll_directory is new in Python 3.8.
-      # When dropping 3.7 support, this try except block can be
-      # removed.
-      pass
   elif base.is_dir():
     # The application is installed. The base path can be added without
     # modification.
     _DLL_DIRECTORIES.append(base)
   else:
     error = FileNotFoundError(
       "Failed to locate folder containing required DLLs. "
       f"Searched:\n{shlib_path}\nand\n{base}")
     error.searched_paths = [base, shlib_path]
     raise error
 
-  # Only update PATH if running in Python 3.7 and the first time setting
-  # the DLL directory.
-  if (USING_PYTHON_37 and _DLL_STATUS is DllDirectoryState.NOT_SET):
-    # In Python 3.7, dependencies for DLLs are searched for in the PATH
-    # environment variable. For the DLLs to be able to find their dependencies,
-    # the dll paths must be added to PATH.
-    add_dll_directories_to_path()
+  _DEPENDENCY_DIRECTORIES = [
+    os.add_dll_directory(str(path)) for path in _DLL_DIRECTORIES
+  ]
 
   _REMEMBERED_DLL_PATH = base_path
   _DLL_STATUS = DllDirectoryState.SET
 
 def disable_dll_loading():
   """Disable loading DLLs from the application.
 
   This should be called when disconnecting from an application.
   """
   # pylint: disable=global-statement
   global _DLL_DIRECTORIES
-  global _DEPENDENCY_DLL_DIRECTORY
+  global _DEPENDENCY_DIRECTORIES
   global _DLL_STATUS
   _DLL_DIRECTORIES = []
-  if _DEPENDENCY_DLL_DIRECTORY:
-    _DEPENDENCY_DLL_DIRECTORY.close()
-    _DEPENDENCY_DLL_DIRECTORY = None
+  if _DEPENDENCY_DIRECTORIES is not None:
+    for directory in _DEPENDENCY_DIRECTORIES:
+      directory.close()
+    _DEPENDENCY_DIRECTORIES = None
   _DLL_STATUS = DllDirectoryState.CLEARED
 
 def add_dll_directories_to_path():
   """Add the DLL directories to the PATH environment variable.
 
-  This is required for DLL discovery in Python 3.7. It is also used to work
-  around bugs in DLLs where they do not use the DLL search directories to
-  load DLLs.
+  This is used used to work around bugs in DLLs where they do not
+  use the DLL search directories to load DLLs.
 
   This will only add the DLL directories to PATH once.
   """
   # pylint: disable=global-statement
   global _HAS_ADDED_DLL_DIRECTORIES_TO_PATH
   if _HAS_ADDED_DLL_DIRECTORIES_TO_PATH:
     return
```

## mapteksdk/data/base.py

```diff
@@ -43,40 +43,22 @@
 from .errors import (
   CannotSaveInReadOnlyModeError, ReadOnlyError, AlreadyAssociatedError,
   NonOrphanRasterError)
 from .objectid import ObjectID
 from .primitive_type import PrimitiveType
 
 if typing.TYPE_CHECKING:
-  import sys
-
   from .images import Raster
   from .colourmaps import ColourMap
   from .primitives.attribute_key import AttributeKey
 
-  if sys.version_info >= (3, 11):
-    from typing import Self
-  else:
-    Self = typing.Any
-
 # pylint: disable=too-many-lines
 # pylint: disable=too-many-instance-attributes
 log = logging.getLogger("mapteksdk.data")
 
-try:
-  final = typing.final
-except AttributeError:
-  # :TODO: SDK-506 typing.final was added to the typing module in
-  # Python 3.8. When dropping support for Python 3.7, this try
-  # catch can be removed.
-  # pylint: disable=invalid-name
-  def final(f):
-    """Empty decorator to replace final in Python 3.7."""
-    return f
-
 _NO_COORDINATE_SYSTEM: typing.Literal[
   "NO_COORDINATE_SYSTEM"] = "NO_COORDINATE_SYSTEM"
 """Placeholder representing the absence of a coordinate system."""
 
 ObjectAttributeTypes = typing.Union[
   None, typing.Type[None], ctypes.c_bool, ctypes.c_int8, ctypes.c_uint8,
   ctypes.c_int16, ctypes.c_uint16, ctypes.c_int32, ctypes.c_uint32,
@@ -412,15 +394,15 @@
     """
     raise NotImplementedError(
       "_extra_invalidate_properties must be implemented on child classes"
     )
 
   # Child classes should place their child-specific function in _save()
   # instead of overwriting or overriding save().
-  @final
+  @typing.final
   def save(self) -> ChangeReasons:
     """Save the changes made to the object.
 
     Generally a user does not need to call this function, because it is called
     automatically at the end of a with block using Project.new() or
     Project.edit().
 
@@ -528,15 +510,15 @@
       if self.__lock_type is LockType.READWRITE:
         log.debug("Closed object for writing: %s of type %s",
                   self.__id, self.__derived_type_name)
       else:
         log.debug("Closed object for reading: %s of type %s",
                   self.__id, self.__derived_type_name)
 
-  def __enter__(self) -> Self:
+  def __enter__(self) -> typing.Self:
     return self
 
   def __exit__(self, exc_type, exc_value, traceback):
     """Close the object. See close()"""
     self.close()
 
   @property
@@ -1266,15 +1248,15 @@
     child class. This is called during _save(), which in turn is called
     during save().
     """
     raise NotImplementedError
 
   # Child classes of topology should implement _save_topology()
   # instead of overwriting or overriding _save_topology().
-  @final
+  @typing.final
   def _save(self):
     self._save_topology()
     self.__coordinate_system.save()
     # :TRICKY: Saving the colour map information must be done after saving
     # all of the topology because it may require a call to reconcile changes,
     # which could discard unsaved changes (e.g. If the colour map was saved
     # with the primitive attributes, then for Surfaces it would result in a
```

## mapteksdk/data/filled_polygon.py

```diff
@@ -573,14 +573,15 @@
       self.__point_attributes.save_attributes()
     if self.__edge_attributes is not None:
       self.__edge_attributes.save_attributes()
     if self.__point_colours.are_values_cached:
       c_colour = (ctypes.c_uint8 * 4)()
       c_colour[:] = self.__point_colours.values
       Modelling().SetUniformPointColour(self._lock.lock, c_colour)
+      Modelling().SetUniformEdgeColour(self._lock.lock, c_colour)
 
   def _remove_points(self, point_indices: typing.Sequence[int]):
     """Remove the points at the given indices of the points array.
 
     This will also update the edges array to ensure that each loop is still
     fully connected. However, it is the caller's responsibility to ensure
     that the deletion will not result in any loops with less than three
```

## mapteksdk/data/objectid.py

```diff
@@ -15,14 +15,15 @@
 
 import ctypes
 import typing
 
 from ..capi.util import get_string, CApiDllLoadFailureError
 from ..capi.types import T_ObjectHandle
 from ..capi import DataEngine
+from ..internal.comms import Int64u
 from ..internal.util import default_type_error_message
 
 T = typing.TypeVar("T", covariant=True)
 
 class ObjectID(typing.Generic[T]):
   """ObjectID used to identify and represent an object.
 
@@ -46,15 +47,15 @@
   ...     if object_id:
   ...         print("Object ID is not the null object ID.")
   ...     else:
   ...         print("The given object ID is null")
   """
   # Specifies the underlying storage type of this class for the communication
   # system.
-  storage_type = T_ObjectHandle
+  storage_type = Int64u
 
   def __init__(self, handle=None):
     if handle is None:
       self.__handle = T_ObjectHandle(0)
     elif isinstance(handle, T_ObjectHandle):
       self.__handle = handle
     else:
@@ -62,33 +63,27 @@
         default_type_error_message(
           argument_name="handle",
           actual_value=handle,
           required_type=T_ObjectHandle
         ))
 
   @classmethod
-  def convert_from(cls, storage_value):
+  def convert_from(cls, value):
     """Convert from the underlying value (of storage type) to this type.
 
     This is used by the communication system.
     """
-    return cls(T_ObjectHandle(storage_value))
+    return cls(T_ObjectHandle(value))
 
-  @classmethod
-  def convert_to(cls, value):
+  def convert_to(self):
     """Convert to the underlying value.
 
     This is used by the communication system.
     """
-    if isinstance(value, cls):
-      return value.handle
-    if isinstance(value, T_ObjectHandle):
-      return value
-
-    raise TypeError('The value was not an ObjectID.')
+    return self.handle.value
 
   @classmethod
   def _from_string(cls, oid_string):
     """Constructs an ObjectID instance from a valid Object ID string
     in the form of 'OID(I##, C##, T##)' (e.g. 'OID(I123, C33, T22)').
 
     Newer applications no longer have the type index in the object ID
```

## mapteksdk/data/points.py

```diff
@@ -14,21 +14,16 @@
 ###############################################################################
 
 from __future__ import annotations
 
 from contextlib import contextmanager
 import logging
 import typing
-import warnings
 
-with warnings.catch_warnings():
-  warnings.filterwarnings("ignore",category=DeprecationWarning)
-  # pandas depends on dateutil which function that was deprecated in Python
-  # 3.12 and a new version hasn't been released yet.
-  import pandas as pd
+import pandas as pd
 
 from ..capi import Modelling
 from ..internal.lock import LockType
 from .base import Topology
 from .primitives import PointProperties, PointDeletionProperties
 from .objectid import ObjectID
 # pylint: disable=too-many-lines
```

## mapteksdk/geologycore/__init__.py

```diff
@@ -1,11 +1,11 @@
-"""Functionality specific to Vulcan GeologyCore.
+"""Functionality specific to GeologyCore.
 
 The contents of this module are not guaranteed to function unless the connected
-application is Vulcan GeologyCore.
+application is GeologyCore.
 
 """
 ###############################################################################
 #
 # (C) Copyright 2022, Maptek Pty Ltd. All rights reserved.
 #
 ###############################################################################
@@ -15,10 +15,10 @@
 from .errors import (DatabaseVersionNotSupportedError, TableNotFoundError,
                      FieldTypeNotSupportedError, DataTypeNotSupportedError,
                      DuplicateFieldTypeError, FieldNotFoundError,
                      DuplicateFieldNameError, OrphanDrillholeError,
                      EmptyTableError, DuplicateTableTypeError,
                      MissingRequiredFieldsError, DeletedFieldError,
                      UnitNotSupportedError, FieldDoesNotSupportUnitsError,
-                     DesurveyMethodNotSupportedError)
+                     DesurveyMethodNotSupportedError, DuplicateTableNameError)
 from .fields import DrillholeFieldType
 from .tables import (DrillholeTableType, BaseDrillholeTable)
```

## mapteksdk/geologycore/database.py

```diff
@@ -9,15 +9,16 @@
 import json
 import math
 import typing
 
 from .desurvey_method import DesurveyMethod
 from .drillholes import Drillhole
 from .errors import (
-  DatabaseLoadError, DuplicateTableTypeError, DesurveyMethodNotSupportedError)
+  DatabaseLoadError, DuplicateTableTypeError, DesurveyMethodNotSupportedError,
+  DuplicateTableNameError)
 from .internal.constants import DATABASE_CONSTANTS
 from .internal.tables_mixin import TablesMixin
 from .tables import (DrillholeTableType, BaseTableInformation,
                      CollarTableInformation, AssayTableInformation,
                      SurveyTableInformation, GeologyTableInformation,
                      QualityTableInformation, DownholeTableInformation,
                      CustomTableInformation)
@@ -552,14 +553,19 @@
     such a table through this function.
     """
     self._raise_if_read_only("add a new table")
 
     # Ensure the existing tables are loaded.
     self._load_tables()
 
+    if table_name in self._tables_by_name:
+      raise DuplicateTableNameError(
+        table_name=table_name
+      )
+
     if table_type is DrillholeTableType.UNKNOWN:
       raise ValueError(
         f"Creating tables of '{table_type}' is not supported. "
         f"Use '{DrillholeTableType.OTHER}' for non built-in tables.")
 
     try:
       table_class = self._table_type_to_class()[table_type]
```

## mapteksdk/geologycore/errors.py

```diff
@@ -374,14 +374,28 @@
   def __init__(self, table_type: DrillholeTableType):
     self.table_type = table_type
     super().__init__(
       f"Cannot add table of type: '{table_type}'. A table with that type "
       "already exists in the database.")
 
 
+class DuplicateTableNameError(Exception):
+  """Error raised when adding a table with the same name as an existing table.
+
+  Parameters
+  ----------
+  table_name
+    The name of the duplicate table.
+  """
+  def __init__(self, table_name: str) -> None:
+    super().__init__(
+      f"There is already a table called: '{table_name}'")
+    self.table_name = table_name
+
+
 class DeletedFieldError(Exception):
   """Error raised when attempting to use a field after it has been deleted."""
   def __init__(self, field: FieldInformation):
     self.field = field
     super().__init__(
       f"The '{field.name}' field has been deleted.")
```

## mapteksdk/geologycore/operations.py

```diff
@@ -1,22 +1,24 @@
-"""Operations available in Vulcan GeologyCore.
+"""Operations available in GeologyCore.
 
 Operations exposes functionality from within an application that can be
 invoked from Python functions. These typically correspond to menu items that
 are available in the application, but their inputs can be populated from Python
 without requiring the user to fill them out.
 
 """
 
 ###############################################################################
 #
 # (C) Copyright 2021, Maptek Pty Ltd. All rights reserved.
 #
 ###############################################################################
 
+import typing
+
 from mapteksdk.common import convert_to_rgba
 from mapteksdk.capi.mcp import Mcpd as McpDll
 from mapteksdk.internal.transaction import (request_transaction,
                                             RequestTransactionWithInputs)
 # pylint: disable=unused-import
 # Import general operations so that they can be imported from this module.
 from mapteksdk.operations import (TooOldForOperation,
@@ -85,28 +87,28 @@
                      'should be RELIMIT_TO_POLYGON')
 
   if edge_constraints and \
       output_option is not TriangulationOutput.SPLIT_ALONG_EDGE_CONSTRAINTS:
     raise ValueError('If providing the edges for edge constraints, the '
                      'output_option should be SPLIT_ALONG_EDGE_CONSTRAINTS')
 
-  inputs = [
+  inputs: list[tuple[str, typing.Any]] = [
     ('selection',
      RequestTransactionWithInputs.format_selection(
        scans + (edge_constraints or []))),
   ]
 
   if destination:
     inputs.append(('destination', destination))
 
   # The properties were renamed between GeologyCore 2023.1 (API 1.9) and
   # 2023.2 (API 1.10).
   if McpDll().version >= (1, 10):
     if trim_edges_to_maximum_length is None:
-        inputs.append(('trimLargeTriangles', 'false'))
+      inputs.append(('trimLargeTriangles', 'false'))
     else:
       inputs.extend([
         ('trimLargeTriangles', 'true'),
         ('trimLargeTriangles/boundaryEdgesOnly', 'true'),
         ('trimLargeTriangles/maximumEdgeLength',
         str(trim_edges_to_maximum_length)),
       ])
```

## mapteksdk/geologycore/tables.py

```diff
@@ -20,20 +20,15 @@
 import enum
 from itertools import chain
 import logging
 import warnings
 import typing
 
 import numpy as np
-
-with warnings.catch_warnings():
-  warnings.filterwarnings("ignore",category=DeprecationWarning)
-  # pandas depends on dateutil which function that was deprecated in Python
-  # 3.12 and a new version hasn't been released yet.
-  import pandas as pd
+import pandas as pd
 
 from ..capi.drillholemodel import DrillholeModel
 from ..data.units import DistanceUnit, AngleUnit, NO_UNIT
 from ..internal.lock import ObjectClosedError
 from ..internal.util import default_type_error_message
 from .errors import (TooManyFieldsError, TooManyFieldsWarning,
                      FieldNotFoundError, TableMismatchError,
@@ -457,16 +452,16 @@
       index = int(index)
 
     if not isinstance(name, str):
       raise TypeError(default_type_error_message("field_name", name, str))
 
     # :TRICKY: This check is only performed at the UI level when adding a
     # field in the application. The database has no issues storing fields with
-    # duplicate names, however Vulcan GeologyCore and the SDK don't support
-    # them well.
+    # duplicate names, however GeologyCore and the SDK don't support them
+    # well.
     if name in self._fields_by_name:
       raise DuplicateFieldNameError(name)
 
     if not isinstance(description, str):
       raise TypeError(
         default_type_error_message("description", description, str))
```

## mapteksdk/internal/LoggingInterface.dll

### pedump {}

```diff
@@ -1,106 +1,106 @@
 
 COFF Header:
 	                Machine: 0x014c
 	               Sections: 0x0003
-	             Time stamp: 0x5e79a7b3
+	             Time stamp: 0x65eaa812
 	Pointer to Symbol Table: 0x00000000
 	   	   Symbol Count: 0x00000000
 	   Optional Header Size: 0x00e0
 	   	Characteristics: 0x2022
 
 PE Header:
 	         Magic (0x010b): 0x010b
 	             LMajor (6): 0x30
 	             LMinor (0): 0x00
-	              Code Size: 0x00003800
+	              Code Size: 0x00004200
 	  Initialized Data Size: 0x00000600
 	Uninitialized Data Size: 0x00000000
-	        Entry Point RVA: 0x000057fa
+	        Entry Point RVA: 0x00006052
 	 	  Code Base RVA: 0x00002000
-		  Data Base RVA: 0x00006000
+		  Data Base RVA: 0x00008000
 
 
 NT Header:
 	   Image Base (0x400000): 0x10000000
 	Section Alignment (8192): 0x00002000
 	   File Align (512/4096): 0x00000200
 	            OS Major (4): 0x0004
 	            OS Minor (0): 0x0000
 	  	  User Major (0): 0x0000
 	  	  User Minor (0): 0x0000
 	  	Subsys major (4): 0x0006
 	  	Subsys minor (0): 0x0000
 	 	       Reserverd: 0x00000000
-	 	      Image Size: 0x0000a000
+	 	      Image Size: 0x0000c000
 	 	     Header Size: 0x00000200
 	            Checksum (0): 0x00000000
 	               Subsystem: 0x0003
 	           DLL Flags (0): 0x8560
 	 Stack Reserve Size (1M): 0x00100000
 	Stack commit Size (4096): 0x00001000
 	  Heap Reserve Size (1M): 0x00100000
 	 Heap Commit Size (4096): 0x00001000
 	      Loader flags (0x1): 0x00000000
 	   Data Directories (16): 0x00000010
 
 Data directories:
 	     Export Table: 0x00000000 [0x00000000]
-	     Import Table: 0x000057a8 [0x0000004f]
-	   Resource Table: 0x00006000 [0x000003e4]
+	     Import Table: 0x00005fff [0x0000004f]
+	   Resource Table: 0x00008000 [0x000003f0]
 	  Exception Table: 0x00000000 [0x00000000]
 	Certificate Table: 0x00000000 [0x00000000]
-	      Reloc Table: 0x00008000 [0x0000000c]
-	            Debug: 0x00005670 [0x0000001c]
+	      Reloc Table: 0x0000a000 [0x0000000c]
+	            Debug: 0x00005e84 [0x00000038]
 	        Copyright: 0x00000000 [0x00000000]
 	       Global Ptr: 0x00000000 [0x00000000]
 	        TLS Table: 0x00000000 [0x00000000]
 	Load Config Table: 0x00000000 [0x00000000]
 	     Bound Import: 0x00000000 [0x00000000]
 	              IAT: 0x00002000 [0x00000008]
 	Delay Import Desc: 0x00000000 [0x00000000]
 	       CLI Header: 0x00002008 [0x00000048]
 
 	Name: .text
-	   Virtual Size: 0x00003800
+	   Virtual Size: 0x00004058
 	Virtual Address: 0x00002000
-	  Raw Data Size: 0x00003800
+	  Raw Data Size: 0x00004200
 	   Raw Data Ptr: 0x00000200
 	      Reloc Ptr: 0x00000000
 	     LineNo Ptr: 0x00000000
 	    Reloc Count: 0x0000
 	     Line Count: 0x0000
 	Flags: code, exec, read, 
 
 	Name: .rsrc
-	   Virtual Size: 0x000003e4
-	Virtual Address: 0x00006000
+	   Virtual Size: 0x000003f0
+	Virtual Address: 0x00008000
 	  Raw Data Size: 0x00000400
-	   Raw Data Ptr: 0x00003a00
+	   Raw Data Ptr: 0x00004400
 	      Reloc Ptr: 0x00000000
 	     LineNo Ptr: 0x00000000
 	    Reloc Count: 0x0000
 	     Line Count: 0x0000
 	Flags: data, read, 
 
 	Name: .reloc
 	   Virtual Size: 0x0000000c
-	Virtual Address: 0x00008000
+	Virtual Address: 0x0000a000
 	  Raw Data Size: 0x00000200
-	   Raw Data Ptr: 0x00003e00
+	   Raw Data Ptr: 0x00004800
 	      Reloc Ptr: 0x00000000
 	     LineNo Ptr: 0x00000000
 	    Reloc Count: 0x0000
 	     Line Count: 0x0000
 	Flags: data, discard, read, 
 
           CLI header size: 72
          Runtime required: 2.5
                     Flags: ilonly, 32/64, no-trackdebug, notsigned
-	         Metadata: 0x00002808 [0x00002e68]
+	         Metadata: 0x00002974 [0x00003510]
 	Entry Point Token: 0x00000000
 	     Resources at: 0x00000000 [0x00000000]
 	   Strong Name at: 0x00000000 [0x00000000]
 	  Code Manager at: 0x00000000 [0x00000000]
 	  VTableFixups at: 0x00000000 [0x00000000]
 	     EAT jumps at: 0x00000000 [0x00000000]
 
@@ -109,31 +109,33 @@
 Public key: none
 
 Metadata header:
            Version: 1.1
     Version string: v4.0.30319
 
 Metadata pointers:
-	Tables (#~): 0x0000006c - 0x00001838 [6092 == 0x000017cc]
-	    Strings: 0x00001838 - 0x00002928 [4336 == 0x000010f0]
-	       Blob: 0x00002a54 - 0x00002e68 [1044 == 0x00000414]
-	User string: 0x00002928 - 0x00002a44 [284 == 0x0000011c]
-	       GUID: 0x00002a44 - 0x00002a54 [16 == 0x00000010]
+	Tables (#~): 0x0000006c - 0x00001bfc [7056 == 0x00001b90]
+	    Strings: 0x00001bfc - 0x00002eb4 [4792 == 0x000012b8]
+	       Blob: 0x00002fd4 - 0x00003510 [1340 == 0x0000053c]
+	User string: 0x00002eb4 - 0x00002fc4 [272 == 0x00000110]
+	       GUID: 0x00002fc4 - 0x00002fd4 [16 == 0x00000010]
 Rows:
-Table Module: 1 records (10 bytes, at ad4)
-Table TypeRef: 43 records (6 bytes, at ade)
-Table TypeDef: 20 records (14 bytes, at be0)
-Table Field: 50 records (6 bytes, at cf8)
-Table Method: 144 records (14 bytes, at e24)
-Table Param: 180 records (6 bytes, at 1604)
-Table InterfaceImpl: 6 records (4 bytes, at 1a3c)
-Table MemberRef: 56 records (6 bytes, at 1a54)
-Table Constant: 28 records (6 bytes, at 1ba4)
-Table CustomAttribute: 129 records (6 bytes, at 1c4c)
-Table StandaloneSig: 5 records (2 bytes, at 1f52)
-Table PropertyMap: 9 records (4 bytes, at 1f5c)
-Table Property: 37 records (6 bytes, at 1f80)
-Table MethodSemantics: 64 records (6 bytes, at 205e)
-Table TypeSpec: 2 records (2 bytes, at 21de)
-Table Assembly: 1 records (22 bytes, at 21e2)
-Table AssemblyRef: 3 records (20 bytes, at 21f8)
-Table MethodSpec: 2 records (4 bytes, at 2234)
+Table Module: 1 records (10 bytes, at c48)
+Table TypeRef: 52 records (6 bytes, at c52)
+Table TypeDef: 21 records (14 bytes, at d8a)
+Table Field: 47 records (6 bytes, at eb0)
+Table Method: 167 records (14 bytes, at fca)
+Table Param: 207 records (6 bytes, at 18ec)
+Table InterfaceImpl: 6 records (4 bytes, at 1dc6)
+Table MemberRef: 75 records (6 bytes, at 1dde)
+Table Constant: 22 records (6 bytes, at 1fa0)
+Table CustomAttribute: 146 records (6 bytes, at 2024)
+Table StandaloneSig: 6 records (2 bytes, at 2390)
+Table PropertyMap: 9 records (4 bytes, at 239c)
+Table Property: 43 records (6 bytes, at 23c0)
+Table MethodSemantics: 73 records (6 bytes, at 24c2)
+Table TypeSpec: 5 records (2 bytes, at 2678)
+Table Assembly: 1 records (22 bytes, at 2682)
+Table AssemblyRef: 6 records (20 bytes, at 2698)
+Table NestedClass: 2 records (4 bytes, at 2710)
+Table GenericParam: 4 records (8 bytes, at 2718)
+Table MethodSpec: 13 records (4 bytes, at 2738)
```

## mapteksdk/internal/MaptekAccountBrokerConnector.dll

### pedump {}

```diff
@@ -1,106 +1,95 @@
 
 COFF Header:
-	                Machine: 0x014c
-	               Sections: 0x0003
-	             Time stamp: 0x5e79a7c1
+	                Machine: 0x8664
+	               Sections: 0x0002
+	             Time stamp: 0x65eaa81f
 	Pointer to Symbol Table: 0x00000000
 	   	   Symbol Count: 0x00000000
-	   Optional Header Size: 0x00e0
+	   Optional Header Size: 0x00f0
 	   	Characteristics: 0x2022
 
 PE Header:
-	         Magic (0x010b): 0x010b
+	         Magic (0x010b): 0x020b
 	             LMajor (6): 0x30
 	             LMinor (0): 0x00
-	              Code Size: 0x00017600
-	  Initialized Data Size: 0x00000800
+	              Code Size: 0x0001ae00
+	  Initialized Data Size: 0x00000600
 	Uninitialized Data Size: 0x00000000
-	        Entry Point RVA: 0x00019596
+	        Entry Point RVA: 0x00000000
 	 	  Code Base RVA: 0x00002000
-		  Data Base RVA: 0x0001a000
+		  Data Base RVA: 0x80000000
 
 
 NT Header:
-	   Image Base (0x400000): 0x10000000
+	   Image Base (0x400000): 0x80000000
 	Section Alignment (8192): 0x00002000
 	   File Align (512/4096): 0x00000200
 	            OS Major (4): 0x0004
 	            OS Minor (0): 0x0000
 	  	  User Major (0): 0x0000
 	  	  User Minor (0): 0x0000
 	  	Subsys major (4): 0x0006
 	  	Subsys minor (0): 0x0000
 	 	       Reserverd: 0x00000000
-	 	      Image Size: 0x0001e000
+	 	      Image Size: 0x00020000
 	 	     Header Size: 0x00000200
 	            Checksum (0): 0x00000000
 	               Subsystem: 0x0003
 	           DLL Flags (0): 0x8560
-	 Stack Reserve Size (1M): 0x00100000
-	Stack commit Size (4096): 0x00001000
+	 Stack Reserve Size (1M): 0x00400000
+	Stack commit Size (4096): 0x00004000
 	  Heap Reserve Size (1M): 0x00100000
-	 Heap Commit Size (4096): 0x00001000
+	 Heap Commit Size (4096): 0x00002000
 	      Loader flags (0x1): 0x00000000
 	   Data Directories (16): 0x00000010
 
 Data directories:
 	     Export Table: 0x00000000 [0x00000000]
-	     Import Table: 0x00019544 [0x0000004f]
-	   Resource Table: 0x0001a000 [0x00000414]
+	     Import Table: 0x00000000 [0x00000000]
+	   Resource Table: 0x0001e000 [0x00000450]
 	  Exception Table: 0x00000000 [0x00000000]
 	Certificate Table: 0x00000000 [0x00000000]
-	      Reloc Table: 0x0001c000 [0x0000000c]
-	            Debug: 0x0001940c [0x0000001c]
+	      Reloc Table: 0x00000000 [0x00000000]
+	            Debug: 0x0001cac4 [0x00000038]
 	        Copyright: 0x00000000 [0x00000000]
 	       Global Ptr: 0x00000000 [0x00000000]
 	        TLS Table: 0x00000000 [0x00000000]
 	Load Config Table: 0x00000000 [0x00000000]
 	     Bound Import: 0x00000000 [0x00000000]
-	              IAT: 0x00002000 [0x00000008]
+	              IAT: 0x00000000 [0x00000000]
 	Delay Import Desc: 0x00000000 [0x00000000]
-	       CLI Header: 0x00002008 [0x00000048]
+	       CLI Header: 0x00002000 [0x00000048]
 
 	Name: .text
-	   Virtual Size: 0x0001759c
+	   Virtual Size: 0x0001ac3f
 	Virtual Address: 0x00002000
-	  Raw Data Size: 0x00017600
+	  Raw Data Size: 0x0001ae00
 	   Raw Data Ptr: 0x00000200
 	      Reloc Ptr: 0x00000000
 	     LineNo Ptr: 0x00000000
 	    Reloc Count: 0x0000
 	     Line Count: 0x0000
 	Flags: code, exec, read, 
 
 	Name: .rsrc
-	   Virtual Size: 0x00000414
-	Virtual Address: 0x0001a000
+	   Virtual Size: 0x00000450
+	Virtual Address: 0x0001e000
 	  Raw Data Size: 0x00000600
-	   Raw Data Ptr: 0x00017800
+	   Raw Data Ptr: 0x0001b000
 	      Reloc Ptr: 0x00000000
 	     LineNo Ptr: 0x00000000
 	    Reloc Count: 0x0000
 	     Line Count: 0x0000
 	Flags: data, read, 
 
-	Name: .reloc
-	   Virtual Size: 0x0000000c
-	Virtual Address: 0x0001c000
-	  Raw Data Size: 0x00000200
-	   Raw Data Ptr: 0x00017e00
-	      Reloc Ptr: 0x00000000
-	     LineNo Ptr: 0x00000000
-	    Reloc Count: 0x0000
-	     Line Count: 0x0000
-	Flags: data, discard, read, 
-
           CLI header size: 72
          Runtime required: 2.5
                     Flags: ilonly, 32/64, no-trackdebug, notsigned
-	         Metadata: 0x000090b4 [0x00010358]
+	         Metadata: 0x0000a06c [0x00012a58]
 	Entry Point Token: 0x00000000
 	     Resources at: 0x00000000 [0x00000000]
 	   Strong Name at: 0x00000000 [0x00000000]
 	  Code Manager at: 0x00000000 [0x00000000]
 	  VTableFixups at: 0x00000000 [0x00000000]
 	     EAT jumps at: 0x00000000 [0x00000000]
 
@@ -109,36 +98,35 @@
 Public key: none
 
 Metadata header:
            Version: 1.1
     Version string: v4.0.30319
 
 Metadata pointers:
-	Tables (#~): 0x0000006c - 0x00005e8c [24096 == 0x00005e20]
-	    Strings: 0x00005e8c - 0x0000b7d4 [22856 == 0x00005948]
-	       Blob: 0x0000e6d8 - 0x00010358 [7296 == 0x00001c80]
-	User string: 0x0000b7d4 - 0x0000e6c8 [12020 == 0x00002ef4]
-	       GUID: 0x0000e6c8 - 0x0000e6d8 [16 == 0x00000010]
+	Tables (#~): 0x0000006c - 0x000072fc [29328 == 0x00007290]
+	    Strings: 0x000072fc - 0x0000d668 [25452 == 0x0000636c]
+	       Blob: 0x0001048c - 0x00012a58 [9676 == 0x000025cc]
+	User string: 0x0000d668 - 0x0001047c [11796 == 0x00002e14]
+	       GUID: 0x0001047c - 0x0001048c [16 == 0x00000010]
 Rows:
-Table Module: 1 records (10 bytes, at 7394)
-Table TypeRef: 183 records (6 bytes, at 739e)
-Table TypeDef: 81 records (14 bytes, at 77e8)
-Table Field: 349 records (6 bytes, at 7c56)
-Table Method: 633 records (14 bytes, at 8484)
-Table Param: 318 records (6 bytes, at a722)
-Table InterfaceImpl: 29 records (4 bytes, at ae96)
-Table MemberRef: 459 records (6 bytes, at af0a)
-Table Constant: 26 records (6 bytes, at b9cc)
-Table CustomAttribute: 318 records (6 bytes, at ba68)
-Table StandaloneSig: 116 records (2 bytes, at c1dc)
-Table EventMap: 3 records (4 bytes, at c2c4)
-Table Event: 13 records (6 bytes, at c2d0)
-Table PropertyMap: 17 records (4 bytes, at c31e)
-Table Property: 166 records (6 bytes, at c362)
-Table MethodSemantics: 257 records (6 bytes, at c746)
-Table MethodImpl: 1 records (6 bytes, at cd4c)
-Table TypeSpec: 91 records (2 bytes, at cd52)
-Table Assembly: 1 records (22 bytes, at ce08)
-Table AssemblyRef: 11 records (20 bytes, at ce1e)
-Table NestedClass: 56 records (4 bytes, at cefa)
-Table GenericParam: 6 records (8 bytes, at cfda)
-Table MethodSpec: 77 records (4 bytes, at d00a)
+Table Module: 1 records (10 bytes, at 8348)
+Table TypeRef: 195 records (6 bytes, at 8352)
+Table TypeDef: 106 records (14 bytes, at 87e4)
+Table Field: 423 records (6 bytes, at 8db0)
+Table Method: 812 records (14 bytes, at 979a)
+Table Param: 412 records (6 bytes, at c402)
+Table InterfaceImpl: 30 records (4 bytes, at cdaa)
+Table MemberRef: 487 records (6 bytes, at ce22)
+Table Constant: 19 records (6 bytes, at d98c)
+Table CustomAttribute: 390 records (6 bytes, at d9fe)
+Table StandaloneSig: 166 records (2 bytes, at e322)
+Table EventMap: 3 records (4 bytes, at e46e)
+Table Event: 15 records (6 bytes, at e47a)
+Table PropertyMap: 18 records (4 bytes, at e4d4)
+Table Property: 190 records (6 bytes, at e51c)
+Table MethodSemantics: 294 records (6 bytes, at e990)
+Table TypeSpec: 104 records (2 bytes, at f074)
+Table Assembly: 1 records (22 bytes, at f144)
+Table AssemblyRef: 16 records (20 bytes, at f15a)
+Table NestedClass: 81 records (4 bytes, at f29a)
+Table GenericParam: 5 records (8 bytes, at f3de)
+Table MethodSpec: 88 records (4 bytes, at f406)
```

## mapteksdk/internal/MaptekAccountBrokerInterfaces.dll

### pedump {}

```diff
@@ -1,106 +1,106 @@
 
 COFF Header:
 	                Machine: 0x014c
 	               Sections: 0x0003
-	             Time stamp: 0x5e79a7bf
+	             Time stamp: 0x65eaa81b
 	Pointer to Symbol Table: 0x00000000
 	   	   Symbol Count: 0x00000000
 	   Optional Header Size: 0x00e0
-	   	Characteristics: 0x2102
+	   	Characteristics: 0x2122
 
 PE Header:
 	         Magic (0x010b): 0x010b
-	             LMajor (6): 0x08
+	             LMajor (6): 0x30
 	             LMinor (0): 0x00
-	              Code Size: 0x00009400
+	              Code Size: 0x0000c800
 	  Initialized Data Size: 0x00000800
 	Uninitialized Data Size: 0x00000000
-	        Entry Point RVA: 0x0000b27e
+	        Entry Point RVA: 0x0000e6ce
 	 	  Code Base RVA: 0x00002000
 		  Data Base RVA: 0x00000000
 
 
 NT Header:
 	   Image Base (0x400000): 0x00400000
 	Section Alignment (8192): 0x00002000
 	   File Align (512/4096): 0x00000200
 	            OS Major (4): 0x0004
 	            OS Minor (0): 0x0000
 	  	  User Major (0): 0x0000
 	  	  User Minor (0): 0x0000
-	  	Subsys major (4): 0x0004
+	  	Subsys major (4): 0x0006
 	  	Subsys minor (0): 0x0000
 	 	       Reserverd: 0x00000000
-	 	      Image Size: 0x00010000
+	 	      Image Size: 0x00014000
 	 	     Header Size: 0x00000200
 	            Checksum (0): 0x00000000
 	               Subsystem: 0x0003
 	           DLL Flags (0): 0x8560
 	 Stack Reserve Size (1M): 0x00100000
 	Stack commit Size (4096): 0x00001000
 	  Heap Reserve Size (1M): 0x00100000
 	 Heap Commit Size (4096): 0x00001000
 	      Loader flags (0x1): 0x00000000
 	   Data Directories (16): 0x00000010
 
 Data directories:
 	     Export Table: 0x00000000 [0x00000000]
-	     Import Table: 0x0000b224 [0x00000057]
-	   Resource Table: 0x0000c000 [0x00000600]
+	     Import Table: 0x0000e679 [0x00000052]
+	   Resource Table: 0x00010000 [0x00000450]
 	  Exception Table: 0x00000000 [0x00000000]
 	Certificate Table: 0x00000000 [0x00000000]
-	      Reloc Table: 0x0000e000 [0x0000000c]
-	            Debug: 0x0000b17c [0x0000001c]
+	      Reloc Table: 0x00012000 [0x0000000c]
+	            Debug: 0x0000e584 [0x00000038]
 	        Copyright: 0x00000000 [0x00000000]
 	       Global Ptr: 0x00000000 [0x00000000]
 	        TLS Table: 0x00000000 [0x00000000]
 	Load Config Table: 0x00000000 [0x00000000]
 	     Bound Import: 0x00000000 [0x00000000]
 	              IAT: 0x00002000 [0x00000008]
 	Delay Import Desc: 0x00000000 [0x00000000]
 	       CLI Header: 0x00002008 [0x00000048]
 
 	Name: .text
-	   Virtual Size: 0x00009284
+	   Virtual Size: 0x0000c6d4
 	Virtual Address: 0x00002000
-	  Raw Data Size: 0x00009400
+	  Raw Data Size: 0x0000c800
 	   Raw Data Ptr: 0x00000200
 	      Reloc Ptr: 0x00000000
 	     LineNo Ptr: 0x00000000
 	    Reloc Count: 0x0000
 	     Line Count: 0x0000
 	Flags: code, exec, read, 
 
 	Name: .rsrc
-	   Virtual Size: 0x00000600
-	Virtual Address: 0x0000c000
+	   Virtual Size: 0x00000450
+	Virtual Address: 0x00010000
 	  Raw Data Size: 0x00000600
-	   Raw Data Ptr: 0x00009600
+	   Raw Data Ptr: 0x0000ca00
 	      Reloc Ptr: 0x00000000
 	     LineNo Ptr: 0x00000000
 	    Reloc Count: 0x0000
 	     Line Count: 0x0000
 	Flags: data, read, 
 
 	Name: .reloc
 	   Virtual Size: 0x0000000c
-	Virtual Address: 0x0000e000
+	Virtual Address: 0x00012000
 	  Raw Data Size: 0x00000200
-	   Raw Data Ptr: 0x00009c00
+	   Raw Data Ptr: 0x0000d000
 	      Reloc Ptr: 0x00000000
 	     LineNo Ptr: 0x00000000
 	    Reloc Count: 0x0000
 	     Line Count: 0x0000
 	Flags: data, discard, read, 
 
           CLI header size: 72
          Runtime required: 2.5
                     Flags: ilonly, 32/64, no-trackdebug, notsigned
-	         Metadata: 0x00002b7c [0x00008600]
+	         Metadata: 0x000031f0 [0x0000b394]
 	Entry Point Token: 0x00000000
 	     Resources at: 0x00000000 [0x00000000]
 	   Strong Name at: 0x00000000 [0x00000000]
 	  Code Manager at: 0x00000000 [0x00000000]
 	  VTableFixups at: 0x00000000 [0x00000000]
 	     EAT jumps at: 0x00000000 [0x00000000]
 
@@ -109,33 +109,34 @@
 Public key: none
 
 Metadata header:
            Version: 1.1
     Version string: v4.0.30319
 
 Metadata pointers:
-	Tables (#~): 0x0000006c - 0x00003fa4 [16184 == 0x00003f38]
-	    Strings: 0x00003fa4 - 0x00007c40 [15516 == 0x00003c9c]
-	       Blob: 0x00007cb4 - 0x00008600 [2380 == 0x0000094c]
-	User string: 0x00007c40 - 0x00007ca4 [100 == 0x00000064]
-	       GUID: 0x00007ca4 - 0x00007cb4 [16 == 0x00000010]
+	Tables (#~): 0x0000006c - 0x000060a0 [24628 == 0x00006034]
+	    Strings: 0x000060a0 - 0x0000a34c [17068 == 0x000042ac]
+	       Blob: 0x0000a454 - 0x0000b394 [3904 == 0x00000f40]
+	User string: 0x0000a34c - 0x0000a444 [248 == 0x000000f8]
+	       GUID: 0x0000a444 - 0x0000a454 [16 == 0x00000010]
 Rows:
-Table Module: 1 records (10 bytes, at e50)
-Table TypeRef: 49 records (6 bytes, at e5a)
-Table TypeDef: 53 records (14 bytes, at f80)
-Table Field: 142 records (6 bytes, at 1266)
-Table Method: 413 records (14 bytes, at 15ba)
-Table Param: 193 records (6 bytes, at 2c50)
-Table InterfaceImpl: 19 records (4 bytes, at 30d6)
-Table MemberRef: 45 records (6 bytes, at 3122)
-Table Constant: 43 records (6 bytes, at 3230)
-Table CustomAttribute: 491 records (6 bytes, at 3332)
-Table StandaloneSig: 1 records (2 bytes, at 3eb4)
-Table EventMap: 1 records (4 bytes, at 3eb6)
-Table Event: 6 records (6 bytes, at 3eba)
-Table PropertyMap: 37 records (4 bytes, at 3ede)
-Table Property: 216 records (6 bytes, at 3f72)
-Table MethodSemantics: 341 records (6 bytes, at 4482)
-Table TypeSpec: 5 records (2 bytes, at 4c80)
-Table Assembly: 1 records (22 bytes, at 4c8a)
-Table AssemblyRef: 6 records (20 bytes, at 4ca0)
-Table GenericParam: 1 records (8 bytes, at 4d18)
+Table Module: 1 records (10 bytes, at 14c8)
+Table TypeRef: 61 records (6 bytes, at 14d2)
+Table TypeDef: 84 records (14 bytes, at 1640)
+Table Field: 213 records (6 bytes, at 1ad8)
+Table Method: 640 records (14 bytes, at 1fd6)
+Table Param: 319 records (6 bytes, at 42d6)
+Table InterfaceImpl: 20 records (4 bytes, at 4a50)
+Table MemberRef: 64 records (6 bytes, at 4aa0)
+Table Constant: 46 records (6 bytes, at 4c20)
+Table CustomAttribute: 794 records (6 bytes, at 4d34)
+Table StandaloneSig: 7 records (2 bytes, at 5fd0)
+Table EventMap: 1 records (4 bytes, at 5fde)
+Table Event: 7 records (6 bytes, at 5fe2)
+Table PropertyMap: 62 records (4 bytes, at 600c)
+Table Property: 302 records (6 bytes, at 6104)
+Table MethodSemantics: 490 records (6 bytes, at 6818)
+Table TypeSpec: 7 records (2 bytes, at 7394)
+Table Assembly: 1 records (22 bytes, at 73a2)
+Table AssemblyRef: 10 records (20 bytes, at 73b8)
+Table GenericParam: 1 records (8 bytes, at 7480)
+Table MethodSpec: 2 records (4 bytes, at 7488)
```

## mapteksdk/internal/MaptekAccountBrokerServiceInterfaces.dll

### pedump {}

```diff
@@ -1,106 +1,95 @@
 
 COFF Header:
-	                Machine: 0x014c
-	               Sections: 0x0003
-	             Time stamp: 0x5e79a7c0
+	                Machine: 0x8664
+	               Sections: 0x0002
+	             Time stamp: 0x65eaa81d
 	Pointer to Symbol Table: 0x00000000
 	   	   Symbol Count: 0x00000000
-	   Optional Header Size: 0x00e0
+	   Optional Header Size: 0x00f0
 	   	Characteristics: 0x2022
 
 PE Header:
-	         Magic (0x010b): 0x010b
+	         Magic (0x010b): 0x020b
 	             LMajor (6): 0x30
 	             LMinor (0): 0x00
-	              Code Size: 0x00006000
-	  Initialized Data Size: 0x00000800
+	              Code Size: 0x00007400
+	  Initialized Data Size: 0x00000600
 	Uninitialized Data Size: 0x00000000
-	        Entry Point RVA: 0x00007f7a
+	        Entry Point RVA: 0x00000000
 	 	  Code Base RVA: 0x00002000
-		  Data Base RVA: 0x00008000
+		  Data Base RVA: 0x80000000
 
 
 NT Header:
-	   Image Base (0x400000): 0x10000000
+	   Image Base (0x400000): 0x80000000
 	Section Alignment (8192): 0x00002000
 	   File Align (512/4096): 0x00000200
 	            OS Major (4): 0x0004
 	            OS Minor (0): 0x0000
 	  	  User Major (0): 0x0000
 	  	  User Minor (0): 0x0000
 	  	Subsys major (4): 0x0006
 	  	Subsys minor (0): 0x0000
 	 	       Reserverd: 0x00000000
 	 	      Image Size: 0x0000c000
 	 	     Header Size: 0x00000200
 	            Checksum (0): 0x00000000
 	               Subsystem: 0x0003
 	           DLL Flags (0): 0x8560
-	 Stack Reserve Size (1M): 0x00100000
-	Stack commit Size (4096): 0x00001000
+	 Stack Reserve Size (1M): 0x00400000
+	Stack commit Size (4096): 0x00004000
 	  Heap Reserve Size (1M): 0x00100000
-	 Heap Commit Size (4096): 0x00001000
+	 Heap Commit Size (4096): 0x00002000
 	      Loader flags (0x1): 0x00000000
 	   Data Directories (16): 0x00000010
 
 Data directories:
 	     Export Table: 0x00000000 [0x00000000]
-	     Import Table: 0x00007f28 [0x0000004f]
-	   Resource Table: 0x00008000 [0x00000450]
+	     Import Table: 0x00000000 [0x00000000]
+	   Resource Table: 0x0000a000 [0x00000490]
 	  Exception Table: 0x00000000 [0x00000000]
 	Certificate Table: 0x00000000 [0x00000000]
-	      Reloc Table: 0x0000a000 [0x0000000c]
-	            Debug: 0x00007df0 [0x0000001c]
+	      Reloc Table: 0x00000000 [0x00000000]
+	            Debug: 0x0000922c [0x00000038]
 	        Copyright: 0x00000000 [0x00000000]
 	       Global Ptr: 0x00000000 [0x00000000]
 	        TLS Table: 0x00000000 [0x00000000]
 	Load Config Table: 0x00000000 [0x00000000]
 	     Bound Import: 0x00000000 [0x00000000]
-	              IAT: 0x00002000 [0x00000008]
+	              IAT: 0x00000000 [0x00000000]
 	Delay Import Desc: 0x00000000 [0x00000000]
-	       CLI Header: 0x00002008 [0x00000048]
+	       CLI Header: 0x00002000 [0x00000048]
 
 	Name: .text
-	   Virtual Size: 0x00005f80
+	   Virtual Size: 0x000073a7
 	Virtual Address: 0x00002000
-	  Raw Data Size: 0x00006000
+	  Raw Data Size: 0x00007400
 	   Raw Data Ptr: 0x00000200
 	      Reloc Ptr: 0x00000000
 	     LineNo Ptr: 0x00000000
 	    Reloc Count: 0x0000
 	     Line Count: 0x0000
 	Flags: code, exec, read, 
 
 	Name: .rsrc
-	   Virtual Size: 0x00000450
-	Virtual Address: 0x00008000
+	   Virtual Size: 0x00000490
+	Virtual Address: 0x0000a000
 	  Raw Data Size: 0x00000600
-	   Raw Data Ptr: 0x00006200
+	   Raw Data Ptr: 0x00007600
 	      Reloc Ptr: 0x00000000
 	     LineNo Ptr: 0x00000000
 	    Reloc Count: 0x0000
 	     Line Count: 0x0000
 	Flags: data, read, 
 
-	Name: .reloc
-	   Virtual Size: 0x0000000c
-	Virtual Address: 0x0000a000
-	  Raw Data Size: 0x00000200
-	   Raw Data Ptr: 0x00006800
-	      Reloc Ptr: 0x00000000
-	     LineNo Ptr: 0x00000000
-	    Reloc Count: 0x0000
-	     Line Count: 0x0000
-	Flags: data, discard, read, 
-
           CLI header size: 72
          Runtime required: 2.5
                     Flags: ilonly, 32/64, no-trackdebug, notsigned
-	         Metadata: 0x00002670 [0x00005780]
+	         Metadata: 0x000026dc [0x00006b50]
 	Entry Point Token: 0x00000000
 	     Resources at: 0x00000000 [0x00000000]
 	   Strong Name at: 0x00000000 [0x00000000]
 	  Code Manager at: 0x00000000 [0x00000000]
 	  VTableFixups at: 0x00000000 [0x00000000]
 	     EAT jumps at: 0x00000000 [0x00000000]
 
@@ -109,29 +98,29 @@
 Public key: none
 
 Metadata header:
            Version: 1.1
     Version string: v4.0.30319
 
 Metadata pointers:
-	Tables (#~): 0x0000006c - 0x00002b5c [10992 == 0x00002af0]
-	    Strings: 0x00002b5c - 0x00005088 [9516 == 0x0000252c]
-	       Blob: 0x0000509c - 0x00005780 [1764 == 0x000006e4]
-	User string: 0x00005088 - 0x0000508c [4 == 0x00000004]
-	       GUID: 0x0000508c - 0x0000509c [16 == 0x00000010]
+	Tables (#~): 0x0000006c - 0x000033e8 [13180 == 0x0000337c]
+	    Strings: 0x000033e8 - 0x00005fa0 [11192 == 0x00002bb8]
+	       Blob: 0x00005fb4 - 0x00006b50 [2972 == 0x00000b9c]
+	User string: 0x00005fa0 - 0x00005fa4 [4 == 0x00000004]
+	       GUID: 0x00005fa4 - 0x00005fb4 [16 == 0x00000010]
 Rows:
-Table Module: 1 records (10 bytes, at 934)
-Table TypeRef: 48 records (6 bytes, at 93e)
-Table TypeDef: 21 records (14 bytes, at a5e)
-Table Field: 116 records (6 bytes, at b84)
-Table Method: 254 records (14 bytes, at e3c)
-Table Param: 211 records (6 bytes, at 1c20)
-Table InterfaceImpl: 2 records (4 bytes, at 2112)
-Table MemberRef: 19 records (6 bytes, at 211a)
-Table Constant: 27 records (6 bytes, at 218c)
-Table CustomAttribute: 447 records (6 bytes, at 222e)
-Table PropertyMap: 15 records (4 bytes, at 2ca8)
-Table Property: 90 records (6 bytes, at 2ce4)
-Table MethodSemantics: 180 records (6 bytes, at 2f00)
-Table TypeSpec: 1 records (2 bytes, at 3338)
-Table Assembly: 1 records (22 bytes, at 333a)
-Table AssemblyRef: 6 records (20 bytes, at 3350)
+Table Module: 1 records (10 bytes, at 9a0)
+Table TypeRef: 79 records (6 bytes, at 9aa)
+Table TypeDef: 20 records (14 bytes, at b84)
+Table Field: 120 records (6 bytes, at c9c)
+Table Method: 294 records (14 bytes, at f6c)
+Table Param: 287 records (6 bytes, at 1f80)
+Table InterfaceImpl: 6 records (4 bytes, at 263a)
+Table MemberRef: 20 records (6 bytes, at 2652)
+Table Constant: 24 records (6 bytes, at 26ca)
+Table CustomAttribute: 574 records (6 bytes, at 275a)
+Table PropertyMap: 16 records (4 bytes, at 34ce)
+Table Property: 97 records (6 bytes, at 350e)
+Table MethodSemantics: 194 records (6 bytes, at 3754)
+Table TypeSpec: 1 records (2 bytes, at 3be0)
+Table Assembly: 1 records (22 bytes, at 3be2)
+Table AssemblyRef: 10 records (20 bytes, at 3bf8)
```

## mapteksdk/internal/MaptekBindingSupport.dll

### pedump {}

```diff
@@ -1,106 +1,106 @@
 
 COFF Header:
 	                Machine: 0x014c
 	               Sections: 0x0003
-	             Time stamp: 0x5e79a7bb
+	             Time stamp: 0x65eaa816
 	Pointer to Symbol Table: 0x00000000
 	   	   Symbol Count: 0x00000000
 	   Optional Header Size: 0x00e0
-	   	Characteristics: 0x2102
+	   	Characteristics: 0x2122
 
 PE Header:
 	         Magic (0x010b): 0x010b
-	             LMajor (6): 0x08
+	             LMajor (6): 0x30
 	             LMinor (0): 0x00
-	              Code Size: 0x00014000
-	  Initialized Data Size: 0x00000600
+	              Code Size: 0x00018e00
+	  Initialized Data Size: 0x00000800
 	Uninitialized Data Size: 0x00000000
-	        Entry Point RVA: 0x00015f5e
+	        Entry Point RVA: 0x0001adce
 	 	  Code Base RVA: 0x00002000
 		  Data Base RVA: 0x00000000
 
 
 NT Header:
 	   Image Base (0x400000): 0x00400000
 	Section Alignment (8192): 0x00002000
 	   File Align (512/4096): 0x00000200
 	            OS Major (4): 0x0004
 	            OS Minor (0): 0x0000
 	  	  User Major (0): 0x0000
 	  	  User Minor (0): 0x0000
-	  	Subsys major (4): 0x0004
+	  	Subsys major (4): 0x0006
 	  	Subsys minor (0): 0x0000
 	 	       Reserverd: 0x00000000
-	 	      Image Size: 0x0001a000
+	 	      Image Size: 0x00020000
 	 	     Header Size: 0x00000200
 	            Checksum (0): 0x00000000
 	               Subsystem: 0x0003
 	           DLL Flags (0): 0x8560
 	 Stack Reserve Size (1M): 0x00100000
 	Stack commit Size (4096): 0x00001000
 	  Heap Reserve Size (1M): 0x00100000
 	 Heap Commit Size (4096): 0x00001000
 	      Loader flags (0x1): 0x00000000
 	   Data Directories (16): 0x00000010
 
 Data directories:
 	     Export Table: 0x00000000 [0x00000000]
-	     Import Table: 0x00015f0c [0x0000004f]
-	   Resource Table: 0x00016000 [0x00000400]
+	     Import Table: 0x0001ad74 [0x00000057]
+	   Resource Table: 0x0001c000 [0x00000410]
 	  Exception Table: 0x00000000 [0x00000000]
 	Certificate Table: 0x00000000 [0x00000000]
-	      Reloc Table: 0x00018000 [0x0000000c]
-	            Debug: 0x00015e70 [0x0000001c]
+	      Reloc Table: 0x0001e000 [0x0000000c]
+	            Debug: 0x0001ac98 [0x00000038]
 	        Copyright: 0x00000000 [0x00000000]
 	       Global Ptr: 0x00000000 [0x00000000]
 	        TLS Table: 0x00000000 [0x00000000]
 	Load Config Table: 0x00000000 [0x00000000]
 	     Bound Import: 0x00000000 [0x00000000]
 	              IAT: 0x00002000 [0x00000008]
 	Delay Import Desc: 0x00000000 [0x00000000]
 	       CLI Header: 0x00002008 [0x00000048]
 
 	Name: .text
-	   Virtual Size: 0x00013f64
+	   Virtual Size: 0x00018dd4
 	Virtual Address: 0x00002000
-	  Raw Data Size: 0x00014000
+	  Raw Data Size: 0x00018e00
 	   Raw Data Ptr: 0x00000200
 	      Reloc Ptr: 0x00000000
 	     LineNo Ptr: 0x00000000
 	    Reloc Count: 0x0000
 	     Line Count: 0x0000
 	Flags: code, exec, read, 
 
 	Name: .rsrc
-	   Virtual Size: 0x00000400
-	Virtual Address: 0x00016000
-	  Raw Data Size: 0x00000400
-	   Raw Data Ptr: 0x00014200
+	   Virtual Size: 0x00000410
+	Virtual Address: 0x0001c000
+	  Raw Data Size: 0x00000600
+	   Raw Data Ptr: 0x00019000
 	      Reloc Ptr: 0x00000000
 	     LineNo Ptr: 0x00000000
 	    Reloc Count: 0x0000
 	     Line Count: 0x0000
 	Flags: data, read, 
 
 	Name: .reloc
 	   Virtual Size: 0x0000000c
-	Virtual Address: 0x00018000
+	Virtual Address: 0x0001e000
 	  Raw Data Size: 0x00000200
-	   Raw Data Ptr: 0x00014600
+	   Raw Data Ptr: 0x00019600
 	      Reloc Ptr: 0x00000000
 	     LineNo Ptr: 0x00000000
 	    Reloc Count: 0x0000
 	     Line Count: 0x0000
 	Flags: data, discard, read, 
 
           CLI header size: 72
          Runtime required: 2.5
                     Flags: ilonly, 32/64, no-trackdebug, notsigned
-	         Metadata: 0x00008450 [0x0000da20]
+	         Metadata: 0x00009188 [0x00011b10]
 	Entry Point Token: 0x00000000
 	     Resources at: 0x00000000 [0x00000000]
 	   Strong Name at: 0x00000000 [0x00000000]
 	  Code Manager at: 0x00000000 [0x00000000]
 	  VTableFixups at: 0x00000000 [0x00000000]
 	     EAT jumps at: 0x00000000 [0x00000000]
 
@@ -109,37 +109,38 @@
 Public key: none
 
 Metadata header:
            Version: 1.1
     Version string: v4.0.30319
 
 Metadata pointers:
-	Tables (#~): 0x0000006c - 0x000059b8 [22860 == 0x0000594c]
-	    Strings: 0x000059b8 - 0x0000a8d8 [20256 == 0x00004f20]
-	       Blob: 0x0000bf44 - 0x0000da20 [6876 == 0x00001adc]
-	User string: 0x0000a8d8 - 0x0000bf34 [5724 == 0x0000165c]
-	       GUID: 0x0000bf34 - 0x0000bf44 [16 == 0x00000010]
+	Tables (#~): 0x0000006c - 0x00008bac [35648 == 0x00008b40]
+	    Strings: 0x00008bac - 0x0000de34 [21128 == 0x00005288]
+	       Blob: 0x0000f274 - 0x00011b10 [10396 == 0x0000289c]
+	User string: 0x0000de34 - 0x0000f264 [5168 == 0x00001430]
+	       GUID: 0x0000f264 - 0x0000f274 [16 == 0x00000010]
 Rows:
-Table Module: 1 records (10 bytes, at 6734)
-Table TypeRef: 188 records (6 bytes, at 673e)
-Table TypeDef: 68 records (14 bytes, at 6ba6)
-Table Field: 157 records (6 bytes, at 6f5e)
-Table Method: 533 records (14 bytes, at 730c)
-Table Param: 571 records (6 bytes, at 9032)
-Table InterfaceImpl: 38 records (4 bytes, at 9d94)
-Table MemberRef: 570 records (6 bytes, at 9e2c)
-Table Constant: 38 records (6 bytes, at ab88)
-Table CustomAttribute: 312 records (6 bytes, at ac6c)
-Table StandaloneSig: 67 records (2 bytes, at b3bc)
-Table EventMap: 3 records (4 bytes, at b442)
-Table Event: 3 records (6 bytes, at b44e)
-Table PropertyMap: 31 records (4 bytes, at b460)
-Table Property: 95 records (6 bytes, at b4dc)
-Table MethodSemantics: 182 records (6 bytes, at b716)
-Table MethodImpl: 19 records (6 bytes, at bb5a)
-Table TypeSpec: 116 records (2 bytes, at bbcc)
-Table Assembly: 1 records (22 bytes, at bcb4)
-Table AssemblyRef: 9 records (20 bytes, at bcca)
-Table NestedClass: 27 records (4 bytes, at bd7e)
-Table GenericParam: 40 records (8 bytes, at bdea)
-Table MethodSpec: 53 records (4 bytes, at bf2a)
-Table GenericParamConstraint: 2 records (4 bytes, at bffe)
+Table Module: 1 records (10 bytes, at 7470)
+Table TypeRef: 190 records (6 bytes, at 747a)
+Table TypeDef: 154 records (14 bytes, at 78ee)
+Table Field: 348 records (6 bytes, at 815a)
+Table Method: 824 records (14 bytes, at 8982)
+Table Param: 723 records (6 bytes, at b692)
+Table InterfaceImpl: 41 records (4 bytes, at c784)
+Table MemberRef: 1025 records (6 bytes, at c828)
+Table Constant: 28 records (6 bytes, at e02e)
+Table CustomAttribute: 392 records (6 bytes, at e0d6)
+Table StandaloneSig: 143 records (2 bytes, at ea06)
+Table EventMap: 3 records (4 bytes, at eb24)
+Table Event: 3 records (6 bytes, at eb30)
+Table PropertyMap: 30 records (4 bytes, at eb42)
+Table Property: 93 records (6 bytes, at ebba)
+Table MethodSemantics: 174 records (6 bytes, at ede8)
+Table MethodImpl: 19 records (6 bytes, at f1fc)
+Table TypeSpec: 224 records (2 bytes, at f26e)
+Table Assembly: 1 records (22 bytes, at f42e)
+Table AssemblyRef: 13 records (20 bytes, at f444)
+Table ExportedType: 11 records (14 bytes, at f548)
+Table NestedClass: 106 records (4 bytes, at f5e2)
+Table GenericParam: 184 records (8 bytes, at f78a)
+Table MethodSpec: 121 records (4 bytes, at fd4a)
+Table GenericParamConstraint: 1 records (4 bytes, at ff2e)
```

## mapteksdk/internal/MaptekWCFSupport.dll

### pedump {}

```diff
@@ -1,25 +1,25 @@
 
 COFF Header:
 	                Machine: 0x014c
 	               Sections: 0x0003
-	             Time stamp: 0x5e79a7b5
+	             Time stamp: 0x65eaa814
 	Pointer to Symbol Table: 0x00000000
 	   	   Symbol Count: 0x00000000
 	   Optional Header Size: 0x00e0
 	   	Characteristics: 0x2022
 
 PE Header:
 	         Magic (0x010b): 0x010b
 	             LMajor (6): 0x30
 	             LMinor (0): 0x00
-	              Code Size: 0x00002600
+	              Code Size: 0x00003e00
 	  Initialized Data Size: 0x00000600
 	Uninitialized Data Size: 0x00000000
-	        Entry Point RVA: 0x00004552
+	        Entry Point RVA: 0x00005d96
 	 	  Code Base RVA: 0x00002000
 		  Data Base RVA: 0x00006000
 
 
 NT Header:
 	   Image Base (0x400000): 0x10000000
 	Section Alignment (8192): 0x00002000
@@ -41,66 +41,66 @@
 	  Heap Reserve Size (1M): 0x00100000
 	 Heap Commit Size (4096): 0x00001000
 	      Loader flags (0x1): 0x00000000
 	   Data Directories (16): 0x00000010
 
 Data directories:
 	     Export Table: 0x00000000 [0x00000000]
-	     Import Table: 0x00004500 [0x0000004f]
-	   Resource Table: 0x00006000 [0x000003d8]
+	     Import Table: 0x00005d43 [0x0000004f]
+	   Resource Table: 0x00006000 [0x000003f0]
 	  Exception Table: 0x00000000 [0x00000000]
 	Certificate Table: 0x00000000 [0x00000000]
 	      Reloc Table: 0x00008000 [0x0000000c]
-	            Debug: 0x000043c8 [0x0000001c]
+	            Debug: 0x00005bc8 [0x00000038]
 	        Copyright: 0x00000000 [0x00000000]
 	       Global Ptr: 0x00000000 [0x00000000]
 	        TLS Table: 0x00000000 [0x00000000]
 	Load Config Table: 0x00000000 [0x00000000]
 	     Bound Import: 0x00000000 [0x00000000]
 	              IAT: 0x00002000 [0x00000008]
 	Delay Import Desc: 0x00000000 [0x00000000]
 	       CLI Header: 0x00002008 [0x00000048]
 
 	Name: .text
-	   Virtual Size: 0x00002558
+	   Virtual Size: 0x00003d9c
 	Virtual Address: 0x00002000
-	  Raw Data Size: 0x00002600
+	  Raw Data Size: 0x00003e00
 	   Raw Data Ptr: 0x00000200
 	      Reloc Ptr: 0x00000000
 	     LineNo Ptr: 0x00000000
 	    Reloc Count: 0x0000
 	     Line Count: 0x0000
 	Flags: code, exec, read, 
 
 	Name: .rsrc
-	   Virtual Size: 0x000003d8
+	   Virtual Size: 0x000003f0
 	Virtual Address: 0x00006000
 	  Raw Data Size: 0x00000400
-	   Raw Data Ptr: 0x00002800
+	   Raw Data Ptr: 0x00004000
 	      Reloc Ptr: 0x00000000
 	     LineNo Ptr: 0x00000000
 	    Reloc Count: 0x0000
 	     Line Count: 0x0000
 	Flags: data, read, 
 
 	Name: .reloc
 	   Virtual Size: 0x0000000c
 	Virtual Address: 0x00008000
 	  Raw Data Size: 0x00000200
-	   Raw Data Ptr: 0x00002c00
+	   Raw Data Ptr: 0x00004400
 	      Reloc Ptr: 0x00000000
 	     LineNo Ptr: 0x00000000
 	    Reloc Count: 0x0000
 	     Line Count: 0x0000
 	Flags: data, discard, read, 
 
           CLI header size: 72
          Runtime required: 2.5
                     Flags: ilonly, 32/64, no-trackdebug, notsigned
-	         Metadata: 0x000025c0 [0x00001e08]
+	         Metadata: 0x00002c00 [0x00002fc8]
 	Entry Point Token: 0x00000000
 	     Resources at: 0x00000000 [0x00000000]
 	   Strong Name at: 0x00000000 [0x00000000]
 	  Code Manager at: 0x00000000 [0x00000000]
 	  VTableFixups at: 0x00000000 [0x00000000]
 	     EAT jumps at: 0x00000000 [0x00000000]
 
@@ -109,29 +109,33 @@
 Public key: none
 
 Metadata header:
            Version: 1.1
     Version string: v4.0.30319
 
 Metadata pointers:
-	Tables (#~): 0x0000006c - 0x00000ae0 [2676 == 0x00000a74]
-	    Strings: 0x00000ae0 - 0x00001844 [3428 == 0x00000d64]
-	       Blob: 0x000019a0 - 0x00001e08 [1128 == 0x00000468]
-	User string: 0x00001844 - 0x00001990 [332 == 0x0000014c]
-	       GUID: 0x00001990 - 0x000019a0 [16 == 0x00000010]
+	Tables (#~): 0x0000006c - 0x00001208 [4508 == 0x0000119c]
+	    Strings: 0x00001208 - 0x00002514 [4876 == 0x0000130c]
+	       Blob: 0x00002890 - 0x00002fc8 [1848 == 0x00000738]
+	User string: 0x00002514 - 0x00002880 [876 == 0x0000036c]
+	       GUID: 0x00002880 - 0x00002890 [16 == 0x00000010]
 Rows:
-Table Module: 1 records (10 bytes, at 884)
-Table TypeRef: 78 records (6 bytes, at 88e)
-Table TypeDef: 14 records (14 bytes, at a62)
-Table Field: 18 records (6 bytes, at b26)
-Table Method: 36 records (14 bytes, at b92)
-Table Param: 55 records (6 bytes, at d8a)
-Table InterfaceImpl: 6 records (4 bytes, at ed4)
-Table MemberRef: 99 records (6 bytes, at eec)
-Table Constant: 12 records (6 bytes, at 113e)
-Table CustomAttribute: 15 records (6 bytes, at 1186)
-Table StandaloneSig: 10 records (2 bytes, at 11e0)
-Table TypeSpec: 7 records (2 bytes, at 11f4)
-Table Assembly: 1 records (22 bytes, at 1202)
-Table AssemblyRef: 6 records (20 bytes, at 1218)
-Table NestedClass: 2 records (4 bytes, at 1290)
-Table MethodSpec: 1 records (4 bytes, at 1298)
+Table Module: 1 records (10 bytes, at ed4)
+Table TypeRef: 99 records (6 bytes, at ede)
+Table TypeDef: 19 records (14 bytes, at 1130)
+Table Field: 25 records (6 bytes, at 123a)
+Table Method: 76 records (14 bytes, at 12d0)
+Table Param: 87 records (6 bytes, at 16f8)
+Table InterfaceImpl: 6 records (4 bytes, at 1902)
+Table MemberRef: 159 records (6 bytes, at 191a)
+Table Constant: 10 records (6 bytes, at 1cd4)
+Table CustomAttribute: 41 records (6 bytes, at 1d10)
+Table StandaloneSig: 17 records (2 bytes, at 1e06)
+Table PropertyMap: 2 records (4 bytes, at 1e28)
+Table Property: 8 records (6 bytes, at 1e30)
+Table MethodSemantics: 15 records (6 bytes, at 1e60)
+Table TypeSpec: 20 records (2 bytes, at 1eba)
+Table Assembly: 1 records (22 bytes, at 1ee2)
+Table AssemblyRef: 8 records (20 bytes, at 1ef8)
+Table NestedClass: 5 records (4 bytes, at 1f98)
+Table GenericParam: 6 records (8 bytes, at 1fac)
+Table MethodSpec: 10 records (4 bytes, at 1fdc)
```

## mapteksdk/internal/NotificationInterface.dll

### pedump {}

```diff
@@ -1,25 +1,25 @@
 
 COFF Header:
 	                Machine: 0x014c
 	               Sections: 0x0003
-	             Time stamp: 0x5e79a7b5
+	             Time stamp: 0x65eaa814
 	Pointer to Symbol Table: 0x00000000
 	   	   Symbol Count: 0x00000000
 	   Optional Header Size: 0x00e0
 	   	Characteristics: 0x2022
 
 PE Header:
 	         Magic (0x010b): 0x010b
 	             LMajor (6): 0x30
 	             LMinor (0): 0x00
-	              Code Size: 0x00001800
-	  Initialized Data Size: 0x00000600
+	              Code Size: 0x00001600
+	  Initialized Data Size: 0x00000800
 	Uninitialized Data Size: 0x00000000
-	        Entry Point RVA: 0x00003606
+	        Entry Point RVA: 0x00003546
 	 	  Code Base RVA: 0x00002000
 		  Data Base RVA: 0x00004000
 
 
 NT Header:
 	   Image Base (0x400000): 0x10000000
 	Section Alignment (8192): 0x00002000
@@ -41,45 +41,45 @@
 	  Heap Reserve Size (1M): 0x00100000
 	 Heap Commit Size (4096): 0x00001000
 	      Loader flags (0x1): 0x00000000
 	   Data Directories (16): 0x00000010
 
 Data directories:
 	     Export Table: 0x00000000 [0x00000000]
-	     Import Table: 0x000035b4 [0x0000004f]
-	   Resource Table: 0x00004000 [0x000003fc]
+	     Import Table: 0x000034f3 [0x0000004f]
+	   Resource Table: 0x00004000 [0x00000410]
 	  Exception Table: 0x00000000 [0x00000000]
 	Certificate Table: 0x00000000 [0x00000000]
 	      Reloc Table: 0x00006000 [0x0000000c]
-	            Debug: 0x0000347c [0x0000001c]
+	            Debug: 0x00003378 [0x00000038]
 	        Copyright: 0x00000000 [0x00000000]
 	       Global Ptr: 0x00000000 [0x00000000]
 	        TLS Table: 0x00000000 [0x00000000]
 	Load Config Table: 0x00000000 [0x00000000]
 	     Bound Import: 0x00000000 [0x00000000]
 	              IAT: 0x00002000 [0x00000008]
 	Delay Import Desc: 0x00000000 [0x00000000]
 	       CLI Header: 0x00002008 [0x00000048]
 
 	Name: .text
-	   Virtual Size: 0x0000160c
+	   Virtual Size: 0x0000154c
 	Virtual Address: 0x00002000
-	  Raw Data Size: 0x00001800
+	  Raw Data Size: 0x00001600
 	   Raw Data Ptr: 0x00000200
 	      Reloc Ptr: 0x00000000
 	     LineNo Ptr: 0x00000000
 	    Reloc Count: 0x0000
 	     Line Count: 0x0000
 	Flags: code, exec, read, 
 
 	Name: .rsrc
-	   Virtual Size: 0x000003fc
+	   Virtual Size: 0x00000410
 	Virtual Address: 0x00004000
-	  Raw Data Size: 0x00000400
-	   Raw Data Ptr: 0x00001a00
+	  Raw Data Size: 0x00000600
+	   Raw Data Ptr: 0x00001800
 	      Reloc Ptr: 0x00000000
 	     LineNo Ptr: 0x00000000
 	    Reloc Count: 0x0000
 	     Line Count: 0x0000
 	Flags: data, read, 
 
 	Name: .reloc
@@ -92,15 +92,15 @@
 	    Reloc Count: 0x0000
 	     Line Count: 0x0000
 	Flags: data, discard, read, 
 
           CLI header size: 72
          Runtime required: 2.5
                     Flags: ilonly, 32/64, no-trackdebug, notsigned
-	         Metadata: 0x000022b0 [0x000011cc]
+	         Metadata: 0x000022b0 [0x000010c8]
 	Entry Point Token: 0x00000000
 	     Resources at: 0x00000000 [0x00000000]
 	   Strong Name at: 0x00000000 [0x00000000]
 	  Code Manager at: 0x00000000 [0x00000000]
 	  VTableFixups at: 0x00000000 [0x00000000]
 	     EAT jumps at: 0x00000000 [0x00000000]
 
@@ -109,32 +109,32 @@
 Public key: none
 
 Metadata header:
            Version: 1.1
     Version string: v4.0.30319
 
 Metadata pointers:
-	Tables (#~): 0x0000006c - 0x000007e8 [1916 == 0x0000077c]
-	    Strings: 0x000007e8 - 0x00000f04 [1820 == 0x0000071c]
-	       Blob: 0x00000f18 - 0x000011cc [692 == 0x000002b4]
-	User string: 0x00000f04 - 0x00000f08 [4 == 0x00000004]
-	       GUID: 0x00000f08 - 0x00000f18 [16 == 0x00000010]
+	Tables (#~): 0x0000006c - 0x000007bc [1872 == 0x00000750]
+	    Strings: 0x000007bc - 0x00000e94 [1752 == 0x000006d8]
+	       Blob: 0x00000ea8 - 0x000010c8 [544 == 0x00000220]
+	User string: 0x00000e94 - 0x00000e98 [4 == 0x00000004]
+	       GUID: 0x00000e98 - 0x00000ea8 [16 == 0x00000010]
 Rows:
 Table Module: 1 records (10 bytes, at 580)
 Table TypeRef: 30 records (6 bytes, at 58a)
-Table TypeDef: 14 records (14 bytes, at 63e)
-Table Field: 13 records (6 bytes, at 702)
-Table Method: 32 records (14 bytes, at 750)
-Table Param: 32 records (6 bytes, at 910)
-Table InterfaceImpl: 6 records (4 bytes, at 9d0)
-Table MemberRef: 26 records (6 bytes, at 9e8)
-Table Constant: 9 records (6 bytes, at a84)
-Table CustomAttribute: 37 records (6 bytes, at aba)
-Table StandaloneSig: 3 records (2 bytes, at b98)
-Table PropertyMap: 4 records (4 bytes, at b9e)
-Table Property: 7 records (6 bytes, at bae)
-Table MethodSemantics: 14 records (6 bytes, at bd8)
-Table TypeSpec: 3 records (2 bytes, at c2c)
-Table Assembly: 1 records (22 bytes, at c32)
-Table AssemblyRef: 2 records (20 bytes, at c48)
-Table GenericParam: 3 records (8 bytes, at c70)
-Table GenericParamConstraint: 3 records (4 bytes, at c88)
+Table TypeDef: 12 records (14 bytes, at 63e)
+Table Field: 7 records (6 bytes, at 6e6)
+Table Method: 33 records (14 bytes, at 710)
+Table Param: 35 records (6 bytes, at 8de)
+Table InterfaceImpl: 6 records (4 bytes, at 9b0)
+Table MemberRef: 25 records (6 bytes, at 9c8)
+Table Constant: 4 records (6 bytes, at a5e)
+Table CustomAttribute: 36 records (6 bytes, at a76)
+Table StandaloneSig: 3 records (2 bytes, at b4e)
+Table PropertyMap: 4 records (4 bytes, at b54)
+Table Property: 7 records (6 bytes, at b64)
+Table MethodSemantics: 14 records (6 bytes, at b8e)
+Table TypeSpec: 3 records (2 bytes, at be2)
+Table Assembly: 1 records (22 bytes, at be8)
+Table AssemblyRef: 3 records (20 bytes, at bfe)
+Table GenericParam: 4 records (8 bytes, at c3a)
+Table GenericParamConstraint: 4 records (4 bytes, at c5a)
```

## mapteksdk/internal/ResourceManagement.dll

### pedump {}

```diff
@@ -1,25 +1,25 @@
 
 COFF Header:
 	                Machine: 0x014c
 	               Sections: 0x0003
-	             Time stamp: 0x5e79a7b3
+	             Time stamp: 0x65eaa80d
 	Pointer to Symbol Table: 0x00000000
 	   	   Symbol Count: 0x00000000
 	   Optional Header Size: 0x00e0
 	   	Characteristics: 0x2022
 
 PE Header:
 	         Magic (0x010b): 0x010b
 	             LMajor (6): 0x30
 	             LMinor (0): 0x00
 	              Code Size: 0x00000e00
 	  Initialized Data Size: 0x00000600
 	Uninitialized Data Size: 0x00000000
-	        Entry Point RVA: 0x00002d7e
+	        Entry Point RVA: 0x00002cb2
 	 	  Code Base RVA: 0x00002000
 		  Data Base RVA: 0x00004000
 
 
 NT Header:
 	   Image Base (0x400000): 0x10000000
 	Section Alignment (8192): 0x00002000
@@ -41,42 +41,42 @@
 	  Heap Reserve Size (1M): 0x00100000
 	 Heap Commit Size (4096): 0x00001000
 	      Loader flags (0x1): 0x00000000
 	   Data Directories (16): 0x00000010
 
 Data directories:
 	     Export Table: 0x00000000 [0x00000000]
-	     Import Table: 0x00002d2c [0x0000004f]
-	   Resource Table: 0x00004000 [0x000003f0]
+	     Import Table: 0x00002c5f [0x0000004f]
+	   Resource Table: 0x00004000 [0x00000400]
 	  Exception Table: 0x00000000 [0x00000000]
 	Certificate Table: 0x00000000 [0x00000000]
 	      Reloc Table: 0x00006000 [0x0000000c]
-	            Debug: 0x00002bf4 [0x0000001c]
+	            Debug: 0x00002ae4 [0x00000038]
 	        Copyright: 0x00000000 [0x00000000]
 	       Global Ptr: 0x00000000 [0x00000000]
 	        TLS Table: 0x00000000 [0x00000000]
 	Load Config Table: 0x00000000 [0x00000000]
 	     Bound Import: 0x00000000 [0x00000000]
 	              IAT: 0x00002000 [0x00000008]
 	Delay Import Desc: 0x00000000 [0x00000000]
 	       CLI Header: 0x00002008 [0x00000048]
 
 	Name: .text
-	   Virtual Size: 0x00000d84
+	   Virtual Size: 0x00000cb8
 	Virtual Address: 0x00002000
 	  Raw Data Size: 0x00000e00
 	   Raw Data Ptr: 0x00000200
 	      Reloc Ptr: 0x00000000
 	     LineNo Ptr: 0x00000000
 	    Reloc Count: 0x0000
 	     Line Count: 0x0000
 	Flags: code, exec, read, 
 
 	Name: .rsrc
-	   Virtual Size: 0x000003f0
+	   Virtual Size: 0x00000400
 	Virtual Address: 0x00004000
 	  Raw Data Size: 0x00000400
 	   Raw Data Ptr: 0x00001000
 	      Reloc Ptr: 0x00000000
 	     LineNo Ptr: 0x00000000
 	    Reloc Count: 0x0000
 	     Line Count: 0x0000
@@ -92,15 +92,15 @@
 	    Reloc Count: 0x0000
 	     Line Count: 0x0000
 	Flags: data, discard, read, 
 
           CLI header size: 72
          Runtime required: 2.5
                     Flags: ilonly, 32/64, no-trackdebug, notsigned
-	         Metadata: 0x0000218c [0x00000a68]
+	         Metadata: 0x000021b8 [0x0000092c]
 	Entry Point Token: 0x00000000
 	     Resources at: 0x00000000 [0x00000000]
 	   Strong Name at: 0x00000000 [0x00000000]
 	  Code Manager at: 0x00000000 [0x00000000]
 	  VTableFixups at: 0x00000000 [0x00000000]
 	     EAT jumps at: 0x00000000 [0x00000000]
 
@@ -109,28 +109,27 @@
 Public key: none
 
 Metadata header:
            Version: 1.1
     Version string: v4.0.30319
 
 Metadata pointers:
-	Tables (#~): 0x0000006c - 0x000003c0 [852 == 0x00000354]
-	    Strings: 0x000003c0 - 0x0000080c [1100 == 0x0000044c]
-	       Blob: 0x00000820 - 0x00000a68 [584 == 0x00000248]
-	User string: 0x0000080c - 0x00000810 [4 == 0x00000004]
-	       GUID: 0x00000810 - 0x00000820 [16 == 0x00000010]
+	Tables (#~): 0x0000006c - 0x0000038c [800 == 0x00000320]
+	    Strings: 0x0000038c - 0x00000770 [996 == 0x000003e4]
+	       Blob: 0x00000784 - 0x0000092c [424 == 0x000001a8]
+	User string: 0x00000770 - 0x00000774 [4 == 0x00000004]
+	       GUID: 0x00000774 - 0x00000784 [16 == 0x00000010]
 Rows:
-Table Module: 1 records (10 bytes, at 44c)
-Table TypeRef: 23 records (6 bytes, at 456)
-Table TypeDef: 5 records (14 bytes, at 4e0)
-Table Field: 7 records (6 bytes, at 526)
-Table Method: 8 records (14 bytes, at 550)
-Table Param: 6 records (6 bytes, at 5c0)
-Table InterfaceImpl: 1 records (4 bytes, at 5e4)
-Table MemberRef: 27 records (6 bytes, at 5e8)
-Table Constant: 6 records (6 bytes, at 68a)
-Table CustomAttribute: 13 records (6 bytes, at 6ae)
-Table StandaloneSig: 2 records (2 bytes, at 6fc)
-Table MethodImpl: 1 records (6 bytes, at 700)
-Table TypeSpec: 2 records (2 bytes, at 706)
-Table Assembly: 1 records (22 bytes, at 70a)
-Table AssemblyRef: 2 records (20 bytes, at 720)
+Table Module: 1 records (10 bytes, at 474)
+Table TypeRef: 23 records (6 bytes, at 47e)
+Table TypeDef: 4 records (14 bytes, at 508)
+Table Field: 2 records (6 bytes, at 540)
+Table Method: 10 records (14 bytes, at 54c)
+Table Param: 7 records (6 bytes, at 5d8)
+Table InterfaceImpl: 2 records (4 bytes, at 602)
+Table MemberRef: 27 records (6 bytes, at 60a)
+Table CustomAttribute: 12 records (6 bytes, at 6ac)
+Table StandaloneSig: 2 records (2 bytes, at 6f4)
+Table MethodImpl: 1 records (6 bytes, at 6f8)
+Table TypeSpec: 2 records (2 bytes, at 6fe)
+Table Assembly: 1 records (22 bytes, at 702)
+Table AssemblyRef: 2 records (20 bytes, at 718)
```

## mapteksdk/internal/account.py

```diff
@@ -89,42 +89,46 @@
       yield WorkbenchSession(
         session.ProcessId,
         session.RunningApplications,
         session.ActiveApplication,
         )
 
   def product_information(self, name, display_name, version_label,
-                          release_date, license_format):
+                          release_date, license_format, host_id_version):
     """Create the instance of the class required by acquire_licence().
 
     Parameters
     ----------
     name : str
       The name of the product.
     display_name : str
       The display name of the product.
     version_label : str
       The version of the product.
     release_date : datetime
       The release date of the product.
     license_format : str
-        This string comes from calling the GetFormat() function in the
-        mdf_licence.dll.
+      This string comes from calling the GetFormat() function in the
+      mdf_licence.dll.
+    host_id_version : int
+      This version comes from calling the SystemHostIdNewestVersion()
+      function in the mdf_licence.dll.
     """
 
     # Convert from a datetime to a System.DateTimeOffset
     release_date_offset = System.DateTimeOffset.FromUnixTimeMilliseconds(
       int(release_date.timestamp()))
 
     product = self.services.MaptekAccountProductInfo()
     product.Name = name
     product.DisplayName = display_name
     product.VersionLabel = version_label
     product.ReleaseDate = release_date_offset
     product.LicenseFormat = license_format
+    product.HostIdVersion = host_id_version
     return product
 
   def acquire_licence(self, product_information, feature_codes):
     """Acquire a license via the Maptek Account Broker.
 
     Parameters
     ----------
@@ -165,32 +169,38 @@
 
     enum_to_name = System.Enum.Format(
       self.services.MaptekAccountErrorCode,
       licence.Result.Error,
       "g")
     raise ValueError(f'Unable to acquire licence: {enum_to_name}')
 
-  def acquire_extend_licence(self, license_format):
+  def acquire_extend_licence(self, license_format, host_id_version):
     """Acquire a licence for Maptek Extend.
 
     Parameters
     ----------
     license_format : str
       The format of the licence to generate. This needs to be the format
       supported by the DLLs used to validate and make use of the licence.
+    host_id_version : int
+      The version of the host ID for which the licence will be bound to.
+      This needs to be the same version that the DLLs used to validate and use
+      the licence is expecting.
     """
     product = self.product_information(
       name='Extend',
       display_name='Extend',
-      version_label='1.6',
+      version_label='1.7',
       license_format=license_format,
+      host_id_version=host_id_version,
       # The release date for Maptek Extend is irrelevant to the licencing
       # system. The date provided is when Maptek was first a registered as a
       # company in Australia.
-      release_date=datetime.datetime(1981, 5, 15),
+      release_date=datetime.datetime(1981, 5, 15,
+                                     tzinfo=datetime.timezone.utc),
       )
 
     return self.acquire_licence(product, ['SDK'])
 
 
 def connect_to_maptek_account_broker(assembly_path=None,
                                      connection_parameters=None):
```

## mapteksdk/internal/backends.py

```diff
@@ -21,20 +21,23 @@
 # (C) Copyright 2023, Maptek Pty Ltd. All rights reserved.
 #
 ###############################################################################
 
 from __future__ import annotations
 
 import ctypes
+import datetime
+import pathlib
 import os
+import sys
 
 from . import account
 from .options import ProjectOptions, ProjectBackendType
 from .mcp import (ExistingMcpdInstance, McpdConnection, McpdDisconnectError,
-                  connect_to_mcpd, find_mdf_hosts)
+                  ConnectionFailedError, Mcpd, connect_to_mcpd, find_mdf_hosts)
 from .. import capi
 from ..project.errors import ProjectConnectionFailureError
 
 
 class Backend:
   """An abstract class for representing the different backends for projects.
 
@@ -52,14 +55,103 @@
   def acquire_licence(self,
                       broker_connector_path: str | None,
                       connection_parameters: dict | None) -> str:
     """Acquire a licence for using the given backend.
 
     This uses the Licence DLL to check the supported licence format.
 
+    This prefers to use the broker as it better handles concurrent access,
+    sharing the licence, caching as well as borrowing. The situation where the
+    broker isn't used is when mapteksdk.native package is used so there is no
+    running application or Workbench and therefore it is unlikely there is the
+    broker in-use.
+
+    Parameters
+    ----------
+    broker_connector_path
+      The path to where the Maptek Account Broker assemblies can be found.
+      If None, the assemblies bundled with the Python SDK are used.
+    connection_parameters
+      Provides parameters sent to the Maptek Account broker. The parameters
+      IgnoreBroker, APIToken and OverrideMaptekAccountServerLocation (for
+      testing only) are applicable when connecting without the broker.
+
+    Returns
+    -------
+    str
+      The acquired licence.
+    """
+    connection_parameters = connection_parameters or {}
+
+    def _load_native_version():
+      """Return a version of the account module from mapteksdk.native package.
+
+      If the mapteksdk.native package is not available this returns None.
+      """
+      native_account = sys.modules.get('mapteksdk.native.account')
+      if native_account:
+        return native_account
+
+      try:
+        from mapteksdk.native import account as native_account
+        return native_account
+      except (ModuleNotFoundError, ImportError):
+        return None  # The broker must be used in this case.
+
+    native_account = _load_native_version()
+    if native_account:
+      # If mapteksdk.native is installed and there is no broker installed use
+      # it to request a licence from Maptek Account without the broker.
+      #
+      # Otherwise the broker is used.
+      common_program_files = os.environ.get("CommonProgramFiles")
+      components = [
+        common_program_files, "Maptek", "MaptekAccountServices",
+        "MaptekAccountBroker.exe"]
+
+      ignore_broker = connection_parameters.get('IgnoreBroker', False)
+      if (ignore_broker or not common_program_files or
+          not pathlib.Path(*components).is_file()):
+        if ignore_broker:
+          self.log.info("The mapteksdk.native package is available and the "
+                        "broker will be ignored even if it is installed.")
+        else:
+          self.log.info("The mapteksdk.native package is available and the "
+                        "broker is not installed.")
+
+        # Acquire licence straight from Maptek Account without the broker.
+        host_id = capi.License().host_id()
+        supported_licence_format = capi.License().supported_licence_format()
+
+        self.broker_session = native_account.connect_to_maptek_account(
+          host_id=host_id,
+          api_token=connection_parameters.get("ApiToken", None),
+          domain=connection_parameters.get(
+            "OverrideMaptekAccountServerLocation",
+            native_account.WebClient.MAPTEK_ACCOUNT),
+        )
+
+        with self.broker_session.acquire_extend_licence(
+            supported_licence_format) as licence:
+          self.log.info('Acquired licence for Maptek Extend')
+          self.licence = licence.license_string
+          return licence.license_string
+    else:
+      self.log.debug("The mapteksdk.native package is unavailable")
+
+    return self.acquire_licence_from_broker(broker_connector_path,
+                                            connection_parameters)
+
+  def acquire_licence_from_broker(self,
+                                  broker_connector_path: str | None,
+                                  connection_parameters: dict | None) -> str:
+    """Acquire a licence for using the given backend.
+
+    This uses the Licence DLL to check the supported licence format.
+
     Parameters
     ----------
     broker_connector_path
       The path to where the Maptek Account Broker assemblies can be found.
       If None, the assemblies bundled with the Python SDK are used.
     connection_parameters
       Provides parameters sent to the Maptek Account broker.
@@ -84,22 +176,23 @@
     if connection_parameters:
       force_parameters = connection_parameters.copy()
       force_parameters.update(required_parameters)
     else:
       force_parameters = required_parameters
 
     supported_licence_format = capi.License().supported_licence_format()
+    host_id_version = capi.License().host_id_version()
     broker_error : ValueError | None = None
     for try_parameters in [force_parameters, connection_parameters]:
       try:
         self.broker_session = account.connect_to_maptek_account_broker(
           broker_connector_path, try_parameters)
 
         with self.broker_session.acquire_extend_licence(
-            supported_licence_format) as licence:
+            supported_licence_format, host_id_version) as licence:
           self.log.info('Acquired licence for Maptek Extend')
           self.licence = licence.license_string
           return licence.license_string
       except ValueError as error:
         # That failed, but we can try again this time without requiring it
         # to be anonymous to allow the user to login.
         if self.broker_session:
@@ -155,14 +248,28 @@
         self._disconnect_from_project()
     finally:
       self.index = None
       if self.broker_session:
         self.broker_session.disconnect()
         self.broker_session = None
 
+  @property
+  def mcpd_instance(self) -> ExistingMcpdInstance | McpdConnection | None:
+    """MCPD instance used by this backend.
+
+    If None, this backend is not connected to to the mcpd. For certain
+    subclasses, this will always be None.
+    """
+    raise NotImplementedError
+
+  @property
+  def has_project_explorer(self) -> bool:
+    """True if this backend has a project explorer."""
+    raise NotImplementedError
+
   def _disconnect_from_project(self) -> None:
     """Handle the backend specific disconnection from the project.
 
     The specific backend should handle any clean-up for the work done during
     connect_to_project().
 
     Implementations need to override this function.
@@ -193,14 +300,22 @@
         f" memory-only project ({last_error})")
       self.log.critical(error_message)
       raise ProjectConnectionFailureError(error_message)
 
     self.index = 0
     self.log.info("Created memory-only DataEngine")
 
+  @property
+  def mcpd_instance(self):
+    return None
+
+  @property
+  def has_project_explorer(self) -> bool:
+    return False
+
   def _disconnect_from_project(self):
     """Disconnects from the DataEngine."""
     # A project backed onto only a DataEngine isn't expected to have any other
     # clients. Its primary use is for tests and scripts which need to
     # open a DataEngine, create/import and save results then close it, i.e.
     # not in multi-process situations where the lifetime of the processes
     # are unknown.
@@ -217,15 +332,15 @@
 
   The application is expected to have the backend server running so this
   should not need to start one.
   """
 
   def __init__(self, log, mcpd_instance):
     super().__init__(log)
-    self.mcpd_instance = mcpd_instance
+    self.__mcpd_instance = mcpd_instance
 
     # Populated by connect_to_project() or use_existing_connection()
     self.mcp_connection: McpdConnection | None = None
 
     # If an existing connection is given then it is not the responsibility
     # of this class to disconnect from it.
     self.connection_our_responsibility = True
@@ -291,29 +406,36 @@
     if not connected:
       last_error = capi.DataEngine().ErrorMessage().decode("utf-8")
       error_message = (
         f"There was an error connecting to the database ({last_error})")
       self.log.critical(error_message)
       raise ProjectConnectionFailureError(error_message)
 
-    # The backend is managed by an existing application; what kind of backend
-    # is not provided when connecting to it, however it can be queried from
-    # the root object.
+    # The index of backend is not provided when connecting to an existing
+    # application; however, it can be queried from the root object.
     backend_index = ctypes.c_uint16()
     if not capi.DataEngine().ObjectBackEnd(capi.DataEngine().RootContainer(),
                                             ctypes.byref(backend_index)):
       last_error = capi.DataEngine().ErrorMessage().decode("utf-8")
       error_message = (
         "Unable to determine the backend used by the application "
-        f"({last_error})")
+        f"due to the following error: {last_error}")
       self.log.critical(error_message)
       raise ProjectConnectionFailureError(error_message)
 
     self.index = backend_index
 
+  @property
+  def mcpd_instance(self):
+    return self.__mcpd_instance
+
+  @property
+  def has_project_explorer(self) -> bool:
+    return True
+
   def _disconnect_from_project(self) -> None:
     # The backend for the project is hosted by another application, we simply
     # need to disconnect from it. However if our connection was keeping the
     # backend alive we need to close it if we are the last one.
     self.log.info("Disconnecting from a project opened by an another "
                   "application.")
     close_backends_if_last_client = True
@@ -323,14 +445,81 @@
       try:
         self.mcp_connection.disconnect()
       except McpdDisconnectError:
         # The exception is already logged, so it is safe to ignore it.
         pass
 
 
+class BackendObserver(Backend):
+  """A backend for the project that is an observer of the project.
+
+  This backend will not connect to or disconnect from the DataEngine,
+  neither will it start/stop a backendServer.
+
+  The expected use case for this kind of backend is when there is another
+  thread which connects to either an existing backend or creates one making
+  this backend just an observer of the same DataEngine.
+
+  In older versions of the application this case would have needed to
+  connect and disconnect from the DataEngine.
+  """
+  def __init__(self, log, backend: Backend):
+    super().__init__(log)
+    self.__mcpd_instance = backend.mcpd_instance
+    self.__has_project_explorer = backend.has_project_explorer
+
+    # Populated by connect_to_project().
+    self.mcp_connection: McpdConnection | None = None
+
+  def connect_to_project(self) -> None:
+    # Connect to the MCPD if there is one known.
+    #
+    # For a project that is backed by a Maptek Database there must be one,
+    # however for a in-memory only backend there won't be.
+    if not self.mcp_connection and self.mcpd_instance:
+      self.mcp_connection = connect_to_mcpd(
+        specific_mcpd=self.mcpd_instance,
+        sdk_licence=self.licence,
+      )
+
+      # The index of backend is not provided when connecting to an existing
+      # application; however, it can be queried from the root object.
+      backend_index = ctypes.c_uint16()
+      if not capi.DataEngine().ObjectBackEnd(capi.DataEngine().RootContainer(),
+                                              ctypes.byref(backend_index)):
+        last_error = capi.DataEngine().ErrorMessage().decode("utf-8")
+        error_message = (
+          "Unable to determine the backend used by the application "
+          f"due to the following error: {last_error}")
+        self.log.critical(error_message)
+        raise ProjectConnectionFailureError(error_message)
+
+      self.index = backend_index
+    else:
+      # Consider this as being an observer of an in-memory only backend.
+      self.index = 0
+
+  @property
+  def mcpd_instance(self):
+    return self.__mcpd_instance
+
+  @property
+  def has_project_explorer(self) -> bool:
+    return self.__has_project_explorer
+
+  def _disconnect_from_project(self) -> None:
+    self.log.info("Disconnecting from a project in-use by another thread.")
+    if self.mcp_connection:
+      try:
+        self.mcp_connection.disconnect()
+      except McpdDisconnectError:
+        # The exception is already logged, so it is safe to ignore it.
+        pass
+
+
 class NewBackend(Backend):
   """A backend for the project that is created by Python.
 
   The data will be stored in a Maptek Database (Under a .maptekdb
   directory).
   """
 
@@ -339,23 +528,27 @@
     self.options = options
 
     if isinstance(mcpd_instance, McpdConnection):
       raise TypeError('mcpd_instance should not be a connection. To use an '
                       'existing connection use_existing_connection() should '
                       'be called instead.')
 
-    self.mcpd_instance = mcpd_instance
+    self.__mcpd_instance = mcpd_instance
 
     # Populated by connect_to_project().
     self.mcp_connection: McpdConnection | None = None
 
     # If an existing connection is given then it is not the responsibility
     # of this class to disconnect from it.
     self.connection_our_responsibility = True
 
+    # Populated by connect_to_project() if there is no existing instance or
+    # connection.
+    self._mcpd: Mcpd | None = None
+
   def use_existing_connection(self, connection: McpdConnection):
     """Use an existing connection to the MCPD.
 
     This means when connecting to the project, it won't need to connect
     on its own.
 
     The backend does not take responsibility for closing the connection,
@@ -366,51 +559,70 @@
 
   def connect_to_project(self) -> None:
     # This expects that a connection is already made to the mcpd.exe and
     # it will be able to launch the backendServer.
 
     # Connect to the MCPD if an existing McpdConnection was not supplied.
     if not self.mcp_connection:
-
       if not self.mcpd_instance:
-        # In the future, this may be where an MCPD is spawned. To achieve this
-        # the licence acquired should have the necessary feature codes for
-        # the MCPD.
-        raise ValueError('A connection to the MCPD or the details for MCPD '
-                         'instance is required')
+        # Account for the development environment where the mcpd executable is
+        # in a different directory from the DLLs.
+        if os.path.isfile(os.path.join(self.options.dll_path, Mcpd.EXE_NAME)):
+          mcpd_path = self.options.dll_path
+        else:
+          mcpd_path = os.path.join(self.options.dll_path, '..', 'bin')
 
-      self.mcp_connection = connect_to_mcpd(
-        specific_mcpd=self.mcpd_instance,
-        sdk_licence=self.licence,
+        # The MCPD has different licencing requirements then the Python SDK
+        # itself.
+        licence_for_mcpd = self._acquire_mdf_licence()
+        self._mcpd = Mcpd(
+          mcpd_path=mcpd_path,
+          mcpd_licence=licence_for_mcpd,
+          dll_path=self.options.dll_path,
         )
+        self.__mcpd_instance = self._mcpd.instance
+
+      try:
+        self.mcp_connection = connect_to_mcpd(
+          specific_mcpd=self.__mcpd_instance,
+          sdk_licence=self.licence,
+          )
+      except ConnectionFailedError:
+        # If the connection failed, it is most likely that the mcpd failed
+        # to start-up correctly.
+        #
+        # Shutdown the mcpd so it isn't left running in the background.
+        self._mcpd.mcpd_process.terminate()
+        self._mcpd.mcpd_process.wait()
+        raise
 
     # Start a backend server.
     if 'MDF_BIN' not in os.environ:
       expected_path = os.path.join(self.options.dll_path, 'mcpd.exe')
       if os.path.exists(expected_path):
-        os.environ['MDF_BIN'] = expected_path
+        os.environ['MDF_BIN'] = os.path.abspath(expected_path)
       else:
         # This accounts for a situation that is unique to the
         # under-development versions of the software.
         if os.path.exists(os.path.join(self.options.dll_path, '..', 'bin',
-                                        'mcpd.exe')):
-          os.environ['MDF_BIN'] = os.path.join(
-            self.options.dll_path, '..', 'bin')
+                                       'mcpd.exe')):
+          os.environ['MDF_BIN'] = os.path.abspath(os.path.join(
+            self.options.dll_path, '..', 'bin'))
         else:
           error_message = "Failed to register backend server - environment " + \
             "variable MDF_BIN not set."
           self.log.critical(error_message)
           raise ProjectConnectionFailureError(error_message)
 
     # Ideally, the absolute path would be provided to the backendServer,
     # however the underlying function doesn't handle spaces. Using an
     # environment variable allows the given string to have no spaces but
     # for the path to contain spaces when it is expanded.
     backend_registered = self.mcp_connection.register_server(
-      '$MDF_BIN/backendServer')
+      '$MDF_BIN/backendServer.exe')
     if not backend_registered:
       error_message = "Failed to register backend server"
       self.log.critical(error_message)
       raise ProjectConnectionFailureError(error_message)
 
     # Ensure there are no stale lock files.
     if not capi.DataEngine().DeleteStaleLockFile(
@@ -434,27 +646,62 @@
       self.options.proj_units)
     if self.index == 0:
       last_error = capi.DataEngine().ErrorMessage().decode("utf-8")
       error_message = ("There was a problem using the requested database "
                        "load or creation settings. "
                        f"Error message: {last_error}")
       self.log.critical(error_message)
+      self.index = None
       raise ProjectConnectionFailureError(error_message)
 
     # Connecting to an existing DataEngine session (the session created by the
     # backendServer when the project was opened).
     create_new_session = False
     connected = capi.DataEngine().Connect(create_new_session)
     if not connected:
       last_error = capi.DataEngine().ErrorMessage().decode("utf-8")
       error_message = (
         f"There was an error connecting to the database ({last_error})")
       self.log.critical(error_message)
       raise ProjectConnectionFailureError(error_message)
 
+  @property
+  def mcpd_instance(self):
+    return self.__mcpd_instance
+
+  @property
+  def has_project_explorer(self) -> bool:
+    return False
+
+  def _acquire_mdf_licence(self):
+    """Acquire a licence to run the MDF executables."""
+    supported_licence_format = capi.License().supported_licence_format()
+    host_id_version = capi.License().host_id_version()
+    version_major, version_minor = capi.License().version
+    product = self.broker_session.product_information(
+      # The name corresponds to the application ID.
+      name='Maptek.SDK.Native',
+      display_name='Extend - Native',
+      version_label=f'{version_major}.{version_minor}',
+      license_format=supported_licence_format,
+      host_id_version=host_id_version,
+      # This ideally would be the date of release of the corresponding MDF
+      # application, this is difficult to determine so for now we use the
+      # date when this feature was first added.
+      release_date=datetime.datetime(2023, 9, 27,
+                                     tzinfo=datetime.timezone.utc),
+    )
+
+    with self.broker_session.acquire_licence(product, ['MDF140',
+                                                       'SDK',
+                                                       'SDKNative']) as licence:
+      self.log.info('Acquired licence for the native package for Maptek '
+                    'Extend')
+      return licence.license_string
+
   def _disconnect_from_project(self) -> None:
     if self.index is None:
       return  # No project to disconnect from.
     if self.index == 0:
       raise ValueError("Unexpected backend index")
 
     self.log.info("Closing project with backend index: %s", self.index)
@@ -464,7 +711,11 @@
       try:
         self.mcp_connection.disconnect()
       except McpdDisconnectError:
         # The exception is already logged, so it is safe to ignore it.
         pass
 
     self.mcp_connection = None
+
+    if self._mcpd:
+      self._mcpd.close()
+      self._mcpd = None
```

## mapteksdk/internal/colour_map_information.py

```diff
@@ -41,16 +41,14 @@
     """True if the colour map association is valid.
 
     If this is False, then the colour map association is invalid
     and no colour map is associated with the object.
     """
     return bool(self.attribute_name) and bool(self.colour_map_id)
 
-  # :TODO: SDK-506 Self is not available in Python 3.7, so the type hint must
-  # be in quotes.
   @classmethod
   def no_colour_map(cls, primitive_type: PrimitiveType) -> "typing.Self":
     """Construct ColourMapInformation indicating no colour map exists.
 
     Parameters
     ----------
     primitive_type
```

## mapteksdk/internal/logger.py

```diff
@@ -6,56 +6,142 @@
 this package. The contents may change at any time without warning.
 """
 ###############################################################################
 #
 # (C) Copyright 2020, Maptek Pty Ltd. All rights reserved.
 #
 ###############################################################################
+from __future__ import annotations
 
 import logging
 from logging.handlers import RotatingFileHandler
 import os
 import sys
+import typing
 
-def configure_log(logger,
-                  file_path=None,
-                  file_log_level=logging.INFO,
-                  console_log_level=logging.WARNING,
-                  use_file=True,
-                  use_console=False,
-                  propagate=False):
+def _generate_file_handler(
+    file_path: str | None,
+    file_log_level: int,
+    formatter: logging.Formatter
+  ) -> RotatingFileHandler | logging.FileHandler:
+  """Generate the file handler for logging to a file.
+
+  Parameters
+  ----------
+  file_path
+    Path to the log file to use, or None to use the default location.
+    If the default location is used, the logs will be sent when the
+    "Request Support" function of the Workbench is used.
+    This is ignored when running the tests.
+  file_log_level
+    The level to log to files at.
+  formatter
+    Formatter to use for log messages.
+
+  Returns
+  -------
+  RotatingFileHandler | logging.FileHandler | None
+    A RotatingFileHandler if not running tests.
+    A FileHandler if running tests.
+    None if not running tests and the user's appdata directory was not
+    available.
+  """
+  # This environment variable should only be set when testing.
+  test_log_path = os.getenv('MDF_SDK_TEST_LOG_LOCATION')
+  is_testing = False
+
+  if test_log_path is None:
+    # The environment variable wasn't set, so we aren't testing.
+    if file_path is None:
+      user_appdata = os.getenv('APPDATA')
+      if not user_appdata:
+        # Follow the XDG Base Directory Specification, if APPDATA isn't set.
+        user_appdata = os.getenv(
+          'XDG_STATE_HOME',
+          os.path.join(os.path.expanduser('~'), '.local', 'state'))
+      test_log_path = os.path.join(
+        user_appdata, 'Maptek', 'pythonsdk', 'log.txt')
+    else:
+      test_log_path = file_path
+  else:
+    # The environment variable was set, so this is testing.
+    is_testing = True
+
+  # Make the file and any containing folders.
+  os.makedirs(os.path.dirname(test_log_path), exist_ok=True)
+  with open(test_log_path, 'a', encoding="utf-8"):
+    os.utime(test_log_path, None)
+
+  if is_testing:
+    # Tests do not use a rotating log file to avoid creating multiple log
+    # files on the test machines.
+    # The mode is w to ensure the log is overwritten each time on
+    # developer machines.
+    file_handler = logging.FileHandler(
+      test_log_path,
+      mode="w"
+    )
+  else:
+    # Use a rotating file handler to prevent the log file from growing too
+    # large. When the log file exceeds 5 megabytes it will be renamed
+    # log.txt.1 and a new log.txt file will be started.
+    # Up to 15 log files will be kept, however only the most recent
+    # is sent with support requests.
+    file_handler = RotatingFileHandler(
+      test_log_path,
+      maxBytes=5000000, # 5 megabytes.
+      backupCount=15)
+  file_handler.setLevel(file_log_level)
+  file_handler.setFormatter(formatter)
+  return file_handler
+
+
+def configure_log(logger: logging.Logger,
+                  file_path: typing.Optional[str]=None,
+                  file_log_level: int=logging.INFO,
+                  console_log_level: int=logging.WARNING,
+                  use_file: bool=True,
+                  use_console: bool=False,
+                  propagate: bool=False):
   r"""Configure the logger instance.
 
   Set-up handlers for writing to a log file and the console.
 
   Parameters
   ----------
-  logger : logging.Logger
+  logger
     The logger to configure.
-  file_path : str
-    Optional full path to log file or
-    default = None .
-  file_log_level : enum
-    Minimum log level for logging to file.
-  console_log_level : enum
-    Minimum log level for logging to console.
-  use_file : bool
-    True if wishing to output logs to file.
-  use_console : bool
-    True if wishing to output logs to console.
-  propagate : bool
-    True if the log entries should be propogated to the root logger.
+  file_path
+    The full path to the log file.
+    If None (default), then the log file will be written into the default
+    location.
+  file_log_level
+    Minimum log level for logging to disk. This is INFO by default.
+  console_log_level
+    Minimum log level for logging to the console. This is WARNING by default.
+  use_file
+    If the script should write log messages to the log file.
+    Setting this to False will cause file_path to be ignored.
+  use_console
+    If the script should write log messages to the console.
+  propagate
+    True if the log entries should be propagated to the root logger.
     This will cause all log entries to be logged twice, once by the
     passed logger and once by the root logger.
 
+  Warnings
+  --------
+  If file_path is not None, or use_file is False, then the Python SDK logs
+  will not be sent when you use the "Request Support" option in Maptek
+  Workbench. This may limit Maptek's ability to provide support.
+
   Notes
   -----
-  If file_path = None (ie Default) then the log is saved to:
+  If the file path is not specified, the log is saved to:
   AppData\\\Roaming\\\Maptek\\\pythonsdk\\\log.txt.
-
   """
   if __debug__:
     # This constant is true if Python was not started with an -O option.
     #
     # Therefore this is the default behaviour, so we should reconsider if this
     # is useful.
     file_log_level = logging.DEBUG
@@ -69,32 +155,16 @@
   else:
     logger.setLevel(file_log_level)
 
   formatter = logging.Formatter(
     '%(asctime)s | %(name)s | %(levelname)s | %(message)s')
 
   if use_file:
-    if file_path is None:
-      user_appdata = os.getenv('APPDATA')
-      file_path = os.path.join(user_appdata, 'Maptek', 'pythonsdk', 'log.txt')
-    # Make the file and any containing folders.
-    os.makedirs(os.path.dirname(file_path), exist_ok=True)
-    with open(file_path, 'a', encoding="utf-8"):
-      os.utime(file_path, None)
-    # Use a rotating file handler to prevent the log file from growing too
-    # large. When the log file exceeds 5 megabytes it will be renamed
-    # log.txt.1 and a new log.txt file will be started.
-    # Up to 15 log files will be kept, however only the most recent
-    # is sent with support requests.
-    file_handler = RotatingFileHandler(
-      file_path,
-      maxBytes=5000000, # 5 megabytes.
-      backupCount=15)
-    file_handler.setLevel(file_log_level)
-    file_handler.setFormatter(formatter)
+    file_handler = _generate_file_handler(
+      file_path, file_log_level, formatter)
     logger.addHandler(file_handler)
 
   if use_console:
     console_handler = logging.StreamHandler(sys.stdout)
     console_handler.setLevel(console_log_level)
     console_handler.setFormatter(formatter)
     logger.addHandler(console_handler)
```

## mapteksdk/internal/mcp.py

```diff
@@ -18,14 +18,15 @@
 import collections
 import ctypes
 import logging
 import os
 import re
 import subprocess
 import tempfile
+from types import TracebackType
 import typing
 
 import psutil
 
 from ..capi import Mcpd as McpDll
 
 # pylint: disable=missing-docstring
@@ -59,14 +60,49 @@
 class NoHostApplicationError(OSError):
   """Error raised when there are no host applications to connect to.
 
   This inherits from OSError for backwards compatibility reasons.
   """
 
 
+class McpCallback:
+  """Python class representing a MCP callback.
+
+  When the event is triggered, the given callback is called.
+
+  Parameters
+  ----------
+  event_name
+    The name of the event which should cause the callback to be called.
+  callback
+    Callback to call when the event occurs.
+  """
+  def __init__(
+      self,
+      event_name: str,
+      callback: typing.Callable[[typing.Any], None]) -> None:
+    self.__event_name = event_name
+    self.__callback = McpDll().dll.Callback(callback)
+    self.__callback_handle = McpDll().dll.McpAddCallbackOnMessage(
+        event_name.encode("utf-8"),
+        self.__callback,
+    )
+
+  def __enter__(self) -> "typing.Self":
+    return self
+
+  def __exit__(
+      self,
+      __exc_type: "type[BaseException] | None",
+      __exc_value: "BaseException | None",
+      __traceback: "TracebackType | None") -> "bool | None":
+    McpDll().dll.McpRemoveCallbackOnMessage(
+        self.__event_name.encode("utf-8"), self.__callback_handle)
+
+
 class Mcpd:
   """Spawns the Master Control Program Daemon (MCPD).
 
   Call close() when it is no longer needed.
 
   This does not connect to the newly spawned mcpd.
   It is the caller's responsibility for calling register_dll_directory().
@@ -167,15 +203,15 @@
       buf_size = 511 #512-1
       str_buffer = ctypes.create_string_buffer(buf_size)
       self.socket_mutex_handle = McpDll().NewSocketFile(str_buffer, buf_size)
       self.socket_path = str_buffer.value.decode("utf-8")
 
       # Set-up the environment for the new process.
       mcpd_environment = os.environ.copy()
-      mcpd_environment['MDF_BIN'] = self.mcpd_path
+      mcpd_environment['MDF_BIN'] = os.path.abspath(self.mcpd_path)
       mcpd_environment['MDF_SHLIB'] = self.dll_path
       mcpd_environment['MDF_MCP_SOCKET'] = self.socket_path
       # Add the DLL path to the PATH environment variable to ensure
       # mcpd.exe can find its dependencies.
       mcpd_environment['PATH'] = os.pathsep.join([
         self.dll_path, mcpd_environment['PATH']])
 
@@ -196,14 +232,18 @@
       is_maptek_account_licence_written_to_file = McpDll().version < (1, 10)
       if not is_maptek_account_licence_written_to_file:
         McpDll().SetIsUsingMaptekAccountLicensing(is_maptek_account_licence)
 
       if is_legacy_licence:
         # Pass the legacy licence via an environment variable.
         mcpd_environment['MDF_ACTIVE_PACKAGE'] = mcpd_licence
+      elif McpDll().version < (1, 6):
+        # Older versions of the software don't support passing the licence via
+        # a file and uses an environment variable instead.
+        mcpd_environment['MDF_ACTIVE_LICENCE_SET'] = mcpd_licence
       elif is_maptek_account_licence_written_to_file:
         # Write the license to a temporary file and add it to the environment
         # so that mcpd.exe can read it.
         with tempfile.NamedTemporaryFile("w", delete=False) as file:
           file.write(mcpd_licence)
           file.flush()
           mcpd_environment['MDF_MAPTEK_ACCOUNT_LICENCE_PATH'] = file.name
@@ -216,19 +256,20 @@
         env=mcpd_environment,
         stdin=subprocess.PIPE)
 
       if is_maptek_account_licence and not is_maptek_account_licence_written_to_file:
         # Pass the Maptek Account license to the launcher via base64
         # encoded standard input.
         mcpd_licence_base64 = base64.b64encode(mcpd_licence.encode('utf-8'))
-        try:
-          process.communicate(input=mcpd_licence_base64, timeout=0)
-        except subprocess.TimeoutExpired:
-          pass # Expected timeout as we don't want to wait for standard out or error.
 
+        # The stdin argument was set to PIPE. This means stdin cannot be None.
+        process.stdin.write(mcpd_licence_base64) # type: ignore
+
+      # This needs to be closed regardless of if it is being written to.
+      process.stdin.close() # type: ignore
       return process
     except OSError as os_error:
       self.log.error("Unable to load the MCP or UI dll")
       self.log.error(os_error)
       raise
 
 class McpdConnection:
```

## mapteksdk/internal/normalise_selection.py

```diff
@@ -16,15 +16,15 @@
 import typing
 
 from ..data import DataObject, ObjectID
 from .util import default_type_error_message
 
 def normalise_selection(
     selection: typing.Iterable[str | DataObject | ObjectID[DataObject]]
-    ) -> typing.Iterable[ObjectID]:
+    ) -> typing.Iterable[ObjectID[DataObject]]:
   """Normalises an iterable of objects to an iterable of ObjectID.
 
   The selection iterable can contain a mix of the following:
   * Object path strings.
   * DataObject subclasses.
   * ObjectIDs.
```

## mapteksdk/internal/options.py

```diff
@@ -12,20 +12,30 @@
 #
 # (C) Copyright 2020, Maptek Pty Ltd. All rights reserved.
 #
 ###############################################################################
 
 # pylint: disable=too-few-public-methods
 # pylint: disable=too-many-instance-attributes
+
+from __future__ import annotations
+
 from enum import IntEnum
+import os
+import pathlib
+import typing
+
+if typing.TYPE_CHECKING:
+  from mapteksdk.internal.backends import Backend
 
 class ProjectOpenMode(IntEnum):
   """Mode selection for opening a Project - open, create or open/create."""
   MEMORY_ONLY = 0
   OPEN_EXISTING = 1
+  OPEN_EXISTING_THREAD = 4
   CREATE_NEW = 2
   OPEN_OR_CREATE = 3
 
 class ProjectAccessMode(IntEnum):
   """Mode selection for Project access - read/write/try write then read."""
   READ_ONLY = 1
   READ_WRITE = 2
@@ -49,15 +59,15 @@
 class ProjectOptions:
   """Provide some options for how to setup the Project class.
   This is optional and only needed if trying to load a specific project
   and/or run automated tests.
 
   Parameters
   ----------
-  project_path : str
+  project_path : str | pathlib.Path
     Path to maptekdb directory (new or existing, depending on open_mode).
   open_mode : ProjectOpenMode
     Method to use when opening a maptekdb database for operating within.
   access_mode : ProjectAccessMode
     Whether to access the database using read only, read/write, or attempt
     write then read on fail.
   backend_type : ProjectBackendType
@@ -70,24 +80,28 @@
   allow_hidden_objects : bool
     Sets project attribute (of same name) for whether to allow the SDK to
     create objects that are hidden by applications (these objects start with
     a full stop in their name (e.g. '.hidden').
     Default is False.
 
   """
-  def __init__(self,
-               project_path,
-               open_mode=ProjectOpenMode.OPEN_EXISTING,
-               access_mode=ProjectAccessMode.READ_WRITE,
-               backend_type=ProjectBackendType.MAPTEK_DB,
-               proj_units=ProjectUnits.METRES,
-               dll_path=None,
-               allow_hidden_objects=False):
-    self.project_path = project_path
+  def __init__(
+    self,
+    project_path: str | pathlib.Path,
+    open_mode: ProjectOpenMode=ProjectOpenMode.OPEN_EXISTING,
+    access_mode: ProjectAccessMode=ProjectAccessMode.READ_WRITE,
+    backend_type: ProjectBackendType=ProjectBackendType.MAPTEK_DB,
+    proj_units: ProjectUnits=ProjectUnits.METRES,
+    dll_path: str | None=None,
+    allow_hidden_objects: bool=False,
+    existing_backend: Backend | None=None
+  ) -> None:
+    self.project_path = os.fspath(project_path)
     self.open_mode = open_mode
     self.access_mode = access_mode
     self.backend_type = backend_type
     self.proj_units = proj_units
     self.dll_path = dll_path
     self.account_broker_connector_path = None
     self.account_broker_session_parameters = None
     self.allow_hidden_objects = allow_hidden_objects
+    self.existing_backend = existing_backend
```

## mapteksdk/internal/qualifiers.py

```diff
@@ -9,23 +9,24 @@
 """
 ###############################################################################
 #
 # (C) Copyright 2022, Maptek Pty Ltd. All rights reserved.
 #
 ###############################################################################
 
-import ctypes
 import enum
 import typing
 
-from .comms import InlineMessage, SubMessage, RepeatingField, SerialisedText
+from .comms import InlineMessage, SubMessage, Int32s, Int64u
+from .serialised_text import SerialisedText
 from .util import default_type_error_message
 
 if typing.TYPE_CHECKING:
-  from .transaction_manager import Transaction
+  from .transaction_base import TransactionBase
+  from .serialisation import Icon
   from ..data import ObjectID
   from ..operations import SelectablePrimitiveType
 
 class InstanceTypes(enum.Enum):
   """Instance types for the InstanceType Qualifier."""
   MONTAGE = "Montage"
   IMPERATIVE = "Imperative"
@@ -245,15 +246,15 @@
       The type of primitive to pick.
     """
     qualifier = Qualifier()
     qualifier.key = 'PrimitiveType'
     qualifier.cumulative = False
 
     qualifier.parameters = Qualifier.Parameters(
-      ctypes.c_int32(primitive_type.value))
+      Int32s(primitive_type.value))
     return qualifier
 
   @staticmethod
   def choice_values(choices: typing.Iterable[typing.Any]):
     """Restrict the values to the given choices.
 
     Parameters
@@ -267,27 +268,58 @@
     qualifier.key = "ChoiceValues"
     qualifier.cumulative = True
     qualifier.parameters = Qualifier.Parameters(*choices)
 
     return qualifier
 
   @staticmethod
+  def icon(icon: "Icon", placement: int=0, size_hint: int=5):
+    """Set the icon for the request.
+
+    Parameters
+    ----------
+    icon
+      The icon for the request.
+    placement
+      Where the icon should be placed.
+      0 is undefined.
+      The other values in uiE_Placement are left to be decided by the compiler
+      on the C++ side.
+    size_hint
+      How large the icon should be.
+      0 is "smallest"
+      The other values in uiE_SizeHint are left to be decided by the compiler
+      on the C++ side.
+      As of 2023-12-18, 5 represents "undefined", but if a new value is added
+      on the C++ side this may change in the future.
+    """
+    qualifier = Qualifier()
+    qualifier.key = "Icon"
+    qualifier.cumulative = False
+    qualifier.parameters = Qualifier.Parameters(
+      icon.name,
+      Int32s(placement),
+      Int32s(size_hint))
+
+    return qualifier
+
+  @staticmethod
   def locate_on(object_id: "ObjectID"):
     """Restrict a pick to be on the specified object.
 
     Parameters
     ----------
     object_id
       The ObjectID of the object to pick.
     """
     qualifier = Qualifier()
     qualifier.key = "LocateOn"
     qualifier.cumulative = True
     qualifier.parameters = Qualifier.Parameters(
-      object_id.handle
+      object_id
     )
     return qualifier
 
   @staticmethod
   def file_filter(
       filters: typing.Dict[str, typing.Union[str, typing.Sequence[str]]]):
     """Restrict the extensions of the files which can be picked.
@@ -376,15 +408,15 @@
     qualifier.key = "NoUndoRedo"
     qualifier.cumulative = False
     qualifier.parameters = qualifier.Parameters()
     return qualifier
 
   @staticmethod
   def call_on_confirm(
-      callback: typing.Callable[["Transaction", typing.Any], None]
+      callback: typing.Callable[["TransactionBase", typing.Any], None]
       ) -> "Qualifier":
     """Call a callback when the transaction is confirmed.
 
     The callback is passed the transaction object created from
     the TransactionData subclass and the data from the confirm
     message.
 
@@ -422,35 +454,64 @@
     -------
     Qualifier
       A user-data qualifier containing the specified data.
     """
     qualifier = Qualifier()
     qualifier.key = f"U.{key}"
     qualifier.cumulative = False
-    if isinstance(value, typing.Iterable):
+    if isinstance(value, typing.Sequence):
       # Iterables are serialised as the length followed by each value in
       # the iterable.
       qualifier.parameters = Qualifier.Parameters(
-        data_type, ctypes.c_uint64(len(value)), *value)
+        data_type, Int64u(len(value)), *value)
     else:
       qualifier.parameters = Qualifier.Parameters(data_type, value)
     return qualifier
 
 class Qualifier(InlineMessage):
   """A qualifier is used to attribute a quality to a transaction."""
 
   class Parameters(SubMessage):
-    """The parameters or values of a qualifier."""
+    """The parameters or values of a qualifier.
 
-    values: RepeatingField[typing.Any]
+    To pass integer or float parameters, the caller must cast the integer
+    or float to one of the types defined in types.py (e.g. Int8u or Double).
+    The type the parameter is serialised as is determined at runtime via
+    reflection so the exact type of the value must unambiguously determine
+    how it should be serialised.
+    """
+    @classmethod
+    def repeating_field_type(cls):
+      return typing.Any
+
+    @property
+    def values(self) -> typing.Sequence[typing.Any]:
+      """The values of this qualifier."""
+      return self.repeating_field_values
+
+    @values.setter
+    def values(self, values: typing.Sequence[typing.Any]):
+      self.repeating_field_values = values
 
     def __init__(self, *args):
+      super().__init__()
       self.values = args
 
   key: str
   cumulative: bool
   parameters: Parameters
 
 
 class QualifierSet(SubMessage):
   """A set of qualifiers often used with a transaction to qualify it."""
-  values: RepeatingField[Qualifier]
+  @classmethod
+  def repeating_field_type(cls):
+    return Qualifier
+
+  @property
+  def values(self) -> typing.Sequence[Qualifier]:
+    """The qualifiers in this set."""
+    return self.repeating_field_values
+
+  @values.setter
+  def values(self, values: typing.Sequence[Qualifier]):
+    self.repeating_field_values = values
```

## mapteksdk/internal/serialisation.py

```diff
@@ -10,56 +10,88 @@
 """
 ###############################################################################
 #
 # (C) Copyright 2022, Maptek Pty Ltd. All rights reserved.
 #
 ###############################################################################
 
-import ctypes
 import json
 import typing
 
-from mapteksdk.internal.comms import InlineMessage, SubMessage
+from mapteksdk.internal.comms import (
+  InlineMessage,
+  SubMessage,
+  Int16s,
+  Int32s,
+  Int8u,
+  Int32u,
+  Int64u,
+  Double,
+)
 from mapteksdk.internal.qualifiers import QualifierSet
 
 class Icon:
   """This type should be used in the definition of a message where an icon is
   expected.
   """
   storage_type = str
 
   def __init__(self, name=''):
     self.name = name
 
   @classmethod
-  def convert_from(cls, storage_value):
+  def convert_from(cls, value):
     """Convert from the underlying value to this type."""
-    assert isinstance(storage_value, cls.storage_type)
-    return cls(storage_value)
+    assert isinstance(value, cls.storage_type)
+    return cls(value)
 
-  @classmethod
-  def convert_to(cls, value):
+  def convert_to(self):
     """Convert the icon name to a value of the storage type (str).
 
     Returns
     -------
       A str which is the name of the icon.
 
     Raises
     ------
     TypeError
       If value is not a Icon or str, i.e the value is not an icon.
     """
-    if isinstance(value, cls):
-      return value.name
-    if isinstance(value, str):
-      return value
+    return self.name
+
+  @classmethod
+  def okay(cls) -> "typing.Self":
+    """The okay icon."""
+    return cls("Okay")
+
+  @classmethod
+  def plus(cls) -> "typing.Self":
+    """The plus icon."""
+    return cls("Add")
+
+  @classmethod
+  def minus(cls) -> "typing.Self":
+    """The minus icon."""
+    return cls("Remove")
 
-    raise TypeError('The value for a Icon should be either an Icon or str.')
+  @classmethod
+  def warning(cls) -> "typing.Self":
+    """The warning icon."""
+    return cls("Warning")
+
+  @classmethod
+  def information(cls) -> "typing.Self":
+    """The information icon."""
+    return cls("Information")
 
+  def __eq__(self, value: object) -> bool:
+    return isinstance(value, type(self)) and value.name == self.name
+
+  def __hash__(self) -> Int16s:
+    return hash(self.name)
 
 class JsonValue:
   """This type should be used in the definition of a Message where JSON is
   expected.
   """
 
   storage_type = str
@@ -67,61 +99,57 @@
   def __init__(self, value):
     self.value = value
 
   def __str__(self):
     return str(self.value)
 
   @classmethod
-  def convert_from(cls, storage_value):
+  def convert_from(cls, value):
     """Convert from the underlying value to this type."""
-    assert isinstance(storage_value, cls.storage_type)
-    return cls(json.loads(storage_value))
+    assert isinstance(value, cls.storage_type)
+    return cls(json.loads(value))
 
-  @classmethod
-  def convert_to(cls, value):
+  def convert_to(self):
     """Convert the value to the storage type.
 
     Returns
     -------
       The serialised value to a JSON formatted str.
 
     Raises
     ------
     TypeError
       If value is not a JsonValue or not suitable for seralisation to JSON
       with Python's default JSON encoder.
     """
-    if isinstance(value, cls):
-      return json.dumps(value.value)
-
-    return json.dumps(value)
+    return json.dumps(self.value)
 
 class KeyBinding(InlineMessage):
   """A key binding for a transaction."""
   is_valid: bool
   is_hold_and_click: bool
-  key: ctypes.c_uint32 # keyE
-  modifiers: ctypes.c_uint32 # keyE_Modifier
+  key: Int32u # keyE
+  modifiers: Int32u # keyE_Modifier
 
 class Context(SubMessage):
   """Transaction context object."""
-  active_view_id: ctypes.c_uint64
+  active_view_id: Int64u
   active_view_name: str
-  associated_view_ids: typing.Set[ctypes.c_uint64]
-  workspace_views: typing.Set[ctypes.c_uint64]
-  finish_hint: ctypes.c_uint8 # uiC_Outcome (Enum)
+  associated_view_ids: typing.Set[Int64u]
+  workspace_views: typing.Set[Int64u]
+  finish_hint: Int8u # uiC_Outcome (Enum)
   selection_contains_objects: bool
-  selection_type: ctypes.c_int32 # picE_SelectionType
+  selection_type: Int32s # picE_SelectionType
   # A datetime is represented as two floats - a day number and seconds
   # since midnight.
   # Converting these to/from a Python datetime is non-trivial, so just
   # pretend it is two floats.
-  selection_last_change_time_day_number: ctypes.c_double
-  selection_last_change_time_seconds_since_midnight: ctypes.c_double
-  key_modifiers: ctypes.c_uint32 # keyE_Modifiers
+  selection_last_change_time_day_number: Double
+  selection_last_change_time_seconds_since_midnight: Double
+  key_modifiers: Int32u # keyE_Modifiers
   key_binding: KeyBinding
   scones: QualifierSet
   cookies: QualifierSet
 
   @classmethod
   def default_context(cls) -> "Context":
     """Return a context filled with default values."""
@@ -165,24 +193,24 @@
   To define an enumeration using this type:
   >>> import enum
   >>> class Example(FixedInteger16Mixin, enum.IntEnum)
   ...   PRIMARY = 1
   ...   SECONDARY = 2
   ...   TERTIARY = 3
   """
-  storage_type: typing.ClassVar = ctypes.c_int16
+  storage_type: typing.ClassVar = Int16s
 
   @classmethod
   def convert_from(cls, value):
     """Converts the underlying value to the enumeration type."""
     return cls(value)
 
-  def convert_to(self) -> ctypes.c_int16:
+  def convert_to(self) -> Int16s:
     """Convert the enumeration to the value that serialised."""
-    return ctypes.c_int16(self.value)
+    return self.value
 
 
 class FixedInteger32Mixin:
   """A base-type for use with an enumeration that is a 32-bit integer.
 
   This class exists because ctypes.c_int132 can't be used as the base
   type of the enumerations due to having its own metaclass.
@@ -190,17 +218,42 @@
   To define an enumeration using this type:
   >>> import enum
   >>> class Example(FixedInteger32Mixin, enum.IntEnum)
   ...   PRIMARY = 1
   ...   SECONDARY = 2
   ...   TERTIARY = 3
   """
-  storage_type: typing.ClassVar = ctypes.c_int32
+  storage_type: typing.ClassVar = Int32s
+
+  @classmethod
+  def convert_from(cls, value):
+    """Converts the underlying value to the enumeration type."""
+    return cls(value)
+
+  def convert_to(self) -> Int32s:
+    """Convert the enumeration to the value that serialised."""
+    return self.value
+
+
+class FixedInteger32uMixin:
+  """A base-type for use with an enumeration that is a 32-bit unsigned integer.
+
+  This class exists because Int32u can't be used as the base
+  type of the enumerations due to having its own metaclass.
+
+  To define an enumeration using this type:
+  >>> import enum
+  >>> class Example(FixedInteger32Mixin, enum.IntEnum)
+  ...   PRIMARY = 1
+  ...   SECONDARY = 2
+  ...   TERTIARY = 3
+  """
+  storage_type: typing.ClassVar = Int32u
 
   @classmethod
   def convert_from(cls, value):
     """Converts the underlying value to the enumeration type."""
     return cls(value)
 
-  def convert_to(self) -> ctypes.c_int32:
+  def convert_to(self) -> Int32u:
     """Convert the enumeration to the value that serialised."""
-    return ctypes.c_int32(self.value)
+    return self.value
```

## mapteksdk/internal/transaction.py

```diff
@@ -13,28 +13,36 @@
 
 ###############################################################################
 #
 # (C) Copyright 2020, Maptek Pty Ltd. All rights reserved.
 #
 ###############################################################################
 
-import ctypes
 import itertools
-import logging
 import threading
 import typing
 
 from mapteksdk.internal.normalise_selection import normalise_selection
 from mapteksdk.capi.mcp import Mcpd
-from mapteksdk.capi.util import (raise_if_version_too_old,
-                                 CApiDllLoadFailureError)
+from mapteksdk.capi.util import (
+  raise_if_version_too_old,
+  CApiDllLoadFailureError
+)
 
 from .comms import (
-  InlineMessage, Message, Request, SerialisedText, ReceivedSerialisedText)
+  Message,
+  Request,
+  Response,
+  Int32s,
+  Int16u,
+  Int64u,
+  default_factory,
+)
 from .qualifiers import QualifierSet
+from .serialised_text import SerialisedText, ReceivedSerialisedText
 from .serialisation import JsonValue, Icon
 
 if typing.TYPE_CHECKING:
   TransactionInputs = typing.Sequence[
     typing.Tuple[
       typing.Union[str, typing.LiteralString],
       typing.Any
@@ -45,22 +53,23 @@
 
 
 class RequestTransactionWithInputs(Message):
   """Define the message known as RequestTransactionWithInputs.
 
   This message can be used to request a transaction in an application.
   """
-  logger = logging.getLogger('mdf.transactions')
 
-  message_name: typing.ClassVar[str] = 'RequestTransactionWithInputs'
+  @classmethod
+  def message_name(cls) -> str:
+    return 'RequestTransactionWithInputs'
 
   transaction_name: str
-  operation_id: ctypes.c_int32 = ctypes.c_int32(0)
+  operation_id: Int32s = 0
   operation_command: str
-  requester_icon: Icon = ''
+  requester_icon: Icon = Icon('')
   can_confirm_immediately: bool = True
   confirm_immediately: bool = True
   run_silently: bool = True  # Only present in 1.2+.
   selection_contains_objects: bool = False
   selection_contains_point_primitives: bool = False
   selection_contains_edge_primitives: bool = False
   selection_contains_facet_primitives: bool = False
@@ -99,21 +108,21 @@
   """Define the message known as RequestTransactionWithInputs.
 
   This message can be used to request a transaction in an application.
 
   This version is needed by PointStudio 2021.1 and later. It approximately
   corresponds to version 1.3 of the API.
   """
-  logger = logging.getLogger('mdf.transactions')
-
-  message_name: typing.ClassVar[str] = 'RequestTransactionWithInputs'
+  @classmethod
+  def message_name(cls) -> str:
+    return 'RequestTransactionWithInputs'
   transaction_name: str
-  operation_id: ctypes.c_int32 = ctypes.c_int32(0)
+  operation_id: Int32s = 0
   operation_command: str
-  requester_icon: Icon = ''
+  requester_icon: Icon = Icon('')
   can_confirm_immediately: bool = True
   confirm_immediately: bool = True
   run_silently: bool = True  # Only present in 1.2+.
   pass_all_errors_back_to_requestor: bool = True # Only present in 1.3+
   selection_contains_objects: bool = False
   selection_contains_point_primitives: bool = False
   selection_contains_edge_primitives: bool = False
@@ -125,17 +134,19 @@
 
   This message is sent when a specified transaction has completed.
 
   It uses the operation_id sent when the transaction was requested to
   determine what request it corresponds with.
   """
 
-  message_name: typing.ClassVar[str] = 'OperationCompleted'
+  @classmethod
+  def message_name(cls) -> str:
+    return  'OperationCompleted'
 
-  operation_id: ctypes.c_int32
+  operation_id: Int32s
   operation_command: str
   outputs: JsonValue
   completed_okay: bool
 
   def send(self, destination):
     raise TypeError("This type of message is a response only. It shouldn't be "
                     "sent.")
@@ -149,17 +160,19 @@
   It uses the operation_id sent when the transaction was requested to
   determine what request it corresponds with.
 
   This version is needed by PointStudio 2021.1 and later. It approximately
   corresponds to version 1.3 of the API.
   """
 
-  message_name: typing.ClassVar[str] = 'OperationCompleted'
+  @classmethod
+  def message_name(cls) -> str:
+    return 'OperationCompleted'
 
-  operation_id: ctypes.c_int32
+  operation_id: Int32s
   operation_command: str
   outputs: JsonValue
   completed_okay: bool
 
   # This is only present in 1.3+
   error_message: ReceivedSerialisedText
 
@@ -172,27 +185,31 @@
   """Define the message known as TransactionInformation.
 
   This message can be used to query information about a transaction
   like what its inputs and outputs are.
 
   The response to the message is ReturnedTransactionInformation.
   """
-  message_name: typing.ClassVar[str] = 'TransactionInformation'
+  @classmethod
+  def message_name(cls) -> str:
+    return 'TransactionInformation'
 
   transaction_name: str
   requester_icon: typing.Union[Icon, str] = ''
   operation_command: str
 
 
 class ReturnedTransactionInformation(Message):
   """Message representing a response to another message. As this message
   is a response, it cannot be sent.
 
   """
-  message_name: typing.ClassVar[str] = "ReturnedTransactionInformation"
+  @classmethod
+  def message_name(cls) -> str:
+    return  "ReturnedTransactionInformation"
 
   command_name: str
   transaction_information: JsonValue
 
   def send(self, destination):
     raise TypeError("This type of message is a response only. It shouldn't be "
                     "sent.")
@@ -216,25 +233,30 @@
   specific events.
 
   For transactions that correspond with menu commands in an application then
   request_transaction() is a far superior option, as it uses the workflow
   system and it is easier to provide inputs and receive outputs.
   """
 
-  class RemoteTransaction(InlineMessage):
+  class RemoteTransaction(Response):
     """The response back after requesting a transaction."""
-    thread_id: ctypes.c_uint16
-    transaction_manager_address: ctypes.c_uint64
-    transaction_address: ctypes.c_uint64
-    transaction_token: ctypes.c_uint64
-    top_level_transaction_address: ctypes.c_uint64
-    top_level_transaction_token: ctypes.c_uint64
+    thread_id: Int16u
+    transaction_manager_address: Int64u
+    transaction_address: Int64u
+    transaction_token: Int64u
+    top_level_transaction_address: Int64u
+    top_level_transaction_token: Int64u
+
+  @classmethod
+  def message_name(cls) -> str:
+    return 'TransactionRequest'
 
-  message_name: typing.ClassVar[str] = 'TransactionRequest'
-  response_type = RemoteTransaction
+  @classmethod
+  def response_type(cls) -> typing.Type[RemoteTransaction]:
+    return cls.RemoteTransaction
 
   transaction: str
   qualifiers: QualifierSet
 
   # This optionally has a context that can be provided.
   # At this time we don't have a use for this.
   # context: Context = None
@@ -303,15 +325,15 @@
     The outputs of the transaction.
 
   Raises
   ------
   TransactionFailed
     If the transaction was unable to complete successfully.
   """
-
+  factory = default_factory.default_factory(Mcpd())
   # We could loosen the following if we checked the version and removed the
   # run_silently field in that case.
   try:
     raise_if_version_too_old(
       "Running operations",
       current_version=Mcpd().version,
       required_version=(1, 2))
@@ -324,75 +346,63 @@
   if is_new_version:
     request_type = RequestTransactionWithInputsV13
     response_type = OperationCompletedV13
   else:
     request_type = RequestTransactionWithInputs
     response_type = OperationCompleted
 
-  request = request_type()
+  request = request_type(factory)
   request.transaction_name = transaction
   request.requester_icon = requester_icon
   if wait:
     request.operation_id = next(NEXT_OPERATION_ID)
   else:
     request.operation_id = 0
   request.operation_command = command_name
   request.confirm_immediately = confirm_immediately
-  request.transaction_inputs = [
+  request.transaction_inputs = JsonValue([
     {'name': name, 'value': value} for name, value in inputs
-    ]
+    ])
 
   if not wait:
     request.send(server)
     return None
 
   # The process is as follows:
   # - Register a callback for receiving the completed message.
   # - Request the transaction.
   # - Wait for the transaction to complete.
 
   completed = threading.Event()
   information = None
 
-  def on_message_received(message_handle):
-    """Called when the message of the expected name is received.
-
-    The message is read out and the corresponding Python message object is
-    created.
-    """
-
+  def on_message_received(received_message):
+    """Called when the message of the expected name is received."""
     nonlocal information
-    information = response_type.from_handle(message_handle)
-    Mcpd().dll.McpFreeMessage(message_handle)
+    information = received_message
 
     if information.operation_id == request.operation_id:
       completed.set()
 
-  on_message_callback = Mcpd().dll.Callback(on_message_received)
+  with response_type.callback_on_receive(
+    Mcpd(),
+    on_message_received,
+    factory
+  ):
+    # Request the transaction.
+    request.send(server)
 
-  callback_handle = Mcpd().dll.McpAddCallbackOnMessage(
-    response_type.message_name.encode('utf-8'),
-    on_message_callback,
-  )
-
-  # Request the transaction.
-  request.send(server)
-
-  # Wait for the transaction to be completed.
-  while not completed.is_set():
-    Mcpd().dll.McpServicePendingEvents()
-
-  Mcpd().dll.McpRemoveCallbackOnMessage(
-    response_type.message_name.encode('utf-8'),
-    callback_handle
-  )
+    # Wait for the transaction to be completed.
+    while not completed.is_set():
+      Mcpd().dll.McpServicePendingEvents()
 
   # Read the result.
   response = information
 
+  assert isinstance(response, response_type)
   assert response.operation_id == request.operation_id
   assert response.operation_command == request.operation_command
 
   if not response.completed_okay:
     if is_new_version:
       error_message = response.error_message
     else:
```

## mapteksdk/internal/transaction_manager.py

```diff
@@ -9,748 +9,194 @@
 Warnings
 --------
 Vendors and clients should not develop scripts or applications against
 this package. The contents may change at any time without warning.
 """
 ###############################################################################
 #
-# (C) Copyright 2022, Maptek Pty Ltd. All rights reserved.
+# (C) Copyright 2023, Maptek Pty Ltd. All rights reserved.
 #
 ###############################################################################
-import ctypes
-from contextlib import AbstractContextManager
-import itertools
+from __future__ import annotations
+
+import warnings
 import logging
-import time
 import typing
 
-from .comms import Request, InlineMessage, Message, RepeatingField
-from .serialisation import Context
-from .transaction_data import TransactionData
-from .transaction_request_data import (
-  TransactionRequestData, TransactionRequestDataList)
+from .mcp import McpCallback
+from .transaction_base import (
+  TransactionBase,
+  TransactionKey,
+)
+from .transaction_messages import (
+  ReceivedTransactionCancelHeader,
+  ReceivedTransactionConfirmHeader
+)
 from ..capi.mcp import Mcpd
-from ..capi.types import T_MessageHandle
-from .qualifiers import QualifierSet
 
 LOG = logging.getLogger("mapteksdk.internal.transaction_manager")
 
-NEXT_OPERATION_ID = itertools.count(start=1)
-
-T = typing.TypeVar("T", bound=TransactionData)
-
-
-# :NOTE: These errors are not intended to be user facing. They should be
-# caught and converted into user-friendly errors by callers.
-class TransactionFailedError(Exception):
-  """Error raised when a transaction fails.
-
-  This may indicate this operation is not supported by the application.
-  """
-
-
-class TransactionSetUpError(TransactionFailedError):
-  """Exception thrown when failing to start a transaction.
-
-  This indicates the server returned an error response to TransactionRequest.
-
-  Parameters
-  ----------
-  transaction_name
-    Name of the menu command which could not be created.
-  """
-  def __init__(self, transaction_name: str):
-    self.transaction_name = transaction_name
-    super().__init__(
-      f"Failed to start menu command: {transaction_name}."
-    )
-
-
-class TransactionCancelledError(Exception):
-  """Error raised when a menu command is cancelled.
-
-  This indicates the user pressed "Cancel" or closed the window
-  without confirming it.
-  """
-  def __init__(self, transaction_name: str):
-    self.transaction_name = transaction_name
-    super().__init__(
-      f"The following command was cancelled: {transaction_name}."
-    )
-
-
-class TransactionTimeoutError(Exception):
-  """Error raised when a transaction times out."""
-  def __init__(self, transaction_name: str, timeout: int) -> None:
-    super().__init__(
-      f"{transaction_name} failed to return a response in {timeout}s."
-    )
-
-
-class TransactionCreate(Request):
-  """A message requesting for a transaction to be created."""
-  message_name = 'TransactionCreate'
-
-  class Response(InlineMessage):
-    """The response to a TransactionCreate message."""
-    success: bool
-    """True if the transaction was successfully started."""
-    server_address: ctypes.c_uint64
-    """The address of the transaction on the server."""
-
-  response_type = Response
-
-  transaction_manager_address: ctypes.c_uint64
-  """Address of the transaction manager associated with the transaction.
-
-  This is primarily used for undo/redo support, however the
-  Python SDK doesn't support this so this isn't used for
-  anything other than equality operations.
-  """
-
-  # Currently this class doesn't include the parent transaction address
-  # because the Python SDK doesn't support it.
-  # parent_transaction_address: typing.Optional[ctypes.c_uint64]
-
-  request_data: TransactionRequestData
-  """The data of the transaction to request."""
-
-  initial_value: InlineMessage
-  """Initial values to place into the panel.
-
-  This is typically (but not required to be) a TransactionData subclass.
-  """
-
-
-class TransactionCreateCompound(Request):
-  """A message requesting for a compound transaction to be created.
-
-  As of writing, 2023-02-13, Python cannot handle optional fields in
-  Requests. This means a different class is required to handle
-  compound transactions because they contain the additional
-  child_transactions field.
-  """
-  message_name = 'TransactionCreate'
-
-  class Response(InlineMessage):
-    """The response to a TransactionCreate message."""
-    success: bool
-    """True if the transaction was successfully started."""
-    server_address: ctypes.c_uint64
-    """The address of the transaction on the server."""
-
-  response_type = Response
-
-  transaction_manager_address: ctypes.c_uint64
-  """Address of the transaction manager associated with the transaction.
-
-  This is primarily used for undo/redo support, however the
-  Python SDK doesn't support this so this isn't used for
-  anything other than equality operations.
-  """
-
-  # Currently this class doesn't include the parent transaction address
-  # because the Python SDK doesn't support it.
-  # parent_transaction_address: typing.Optional[ctypes.c_uint64]
-
-  request_data: TransactionRequestData
-  """The data of the transaction to request."""
-
-  child_transactions: TransactionRequestDataList
-  """Child transactions of the request."""
-
-  initial_value: InlineMessage
-  """Initial values to place into the panel.
-
-  This must be a TransactionData subclass.
-  """
-
-
-class TransactionDestroy(Message):
-  """Destroy a transaction on the server."""
-  message_name: typing.ClassVar[str] = "TransactionDestroy"
-
-  parent_transaction_address: ctypes.c_uint64
-  """The address of the parent transaction of the transaction to destroy."""
-
-  transaction_address: ctypes.c_uint64
-  """The address of the transaction to destroy."""
-
-
-class TransactionConfirm(Message):
-  """A message indicating a transaction has been confirmed.
-
-  This does not parse the entire TransactionConfirm message. Instead
-  it only parses the generic part of the message. This is used to identify
-  which transaction was confirmed. The transaction then parses the remainder
-  of the message (typically via a TransactionData subclass).
-
-  This can never be sent by Python, only received.
-  """
-  message_name: str = "TransactionConfirm"
-
-  transaction_address: ctypes.c_uint64
-  """The address of the transaction which was confirmed.
-
-  This will be the same as in the corresponding TransactionCreate
-  message.
-  """
-
-  transaction_token: ctypes.c_uint64
-  """The token of the transaction which was confirmed.
-
-  This will be the same as in the corresponding TransactionCreate
-  message
-  """
-
-  def send(self, destination):
-    raise TypeError(
-      "This type of message is a response only. It shouldn't be sent."
-    )
-
-
-class TransactionCancel(Message):
-  """A message indicating a transaction has been cancelled.
-
-  This does not parse the entire TransactionCancel message. Instead it
-  only parses the generic part of the message. This is used to identify which
-  transaction was cancelled.
-
-  This can never be sent by Python, only received.
-  """
-  message_name: str = "TransactionCancel"
-
-  top_level_transaction_address: ctypes.c_uint64
-  """The address of the top-level transaction which was cancelled."""
-
-  transaction_token: ctypes.c_uint64
-  """The token of the transaction which was cancelled."""
-
-  transaction_address: ctypes.c_uint64
-  """The address of the transaction which was cancelled."""
-
-  def send(self, destination):
-    raise TypeError(
-      "This type of message is a response only. It shouldn't be sent."
-    )
-
-
-class Transaction(typing.Generic[T], AbstractContextManager):
-  """Class representing a Transaction managed by the TransactionManager.
-
-  Parameters
-  ----------
-  transaction_manager
-    Transaction manager responsible for managing this transaction.
-  transaction_data
-    The TransactionData subclass indicating which transaction to
-    request.
-  qualifiers
-    Qualifiers to apply to the transaction.
-  initial_value
-    Instance of the type transaction_data containing the initial values
-    for the transaction.
-  server_name
-    The name of the server which will host the transaction.
-  """
-  def __init__(
-      self,
-      transaction_manager: "TransactionManager",
-      transaction_data: typing.Type[T],
-      initial_value: T,
-      server_name: str,
-      parent_transaction: typing.Optional["Transaction"]=None):
-    self.__transaction_manager = transaction_manager
-    self.__transaction_data = transaction_data
-    self.__initial_value = initial_value
-    self.__token = next(NEXT_OPERATION_ID)
-    self._value = None
-    self.__is_cancelled = False
-    self.__error: typing.Optional[Exception] = None
-    """The error this transaction has encountered.
-
-    If this is falsy, the transaction has not encountered an error.
-    This error will be raised if wait_for_value() is called.
-    """
-    self.__server_address = None
-    """The address of the server-side representation of the transaction.
-
-    This is required to destruct the server-side representation of this
-    transaction.
-    """
-    self.__server_name = server_name
-    """The name of the server which will host the transaction."""
-    self.__confirm_callbacks: typing.List[
-      typing.Callable[["Transaction"], None]] = []
-    self.parent_transaction = parent_transaction
-    """The transactions parent, if it has one.
-
-    If the Transaction is a top-level transaction, then this will be None.
-    """
-    self.__child_transactions = self._register_child_transactions(initial_value)
-    if self.parent_transaction and self.__child_transactions:
-      raise NotImplementedError(
-        "Compound transactions which contain other compound transactions "
-        "is not yet implemented."
-      )
-
-  def name(self) -> str:
-    """The name of the transaction, including the namespace."""
-    return self.__transaction_data.transaction_name()
+T = typing.TypeVar("T", bound=TransactionBase)
 
-  def key(self) -> typing.Tuple[ctypes.c_uint64, ctypes.c_uint64]:
-    """Key which uniquely identifies this transaction (within this process).
-
-    This is used by the transaction manager to determine which transaction
-    an event is relevant to.
-
-    Returns
-    -------
-    tuple
-      A tuple containing the id of this Python object and the token
-      assigned to this object.
-    """
-    return (id(self), self.__token)
-
-  def is_compound(self) -> bool:
-    """If this is a compound transaction.
-
-    A compound transaction is a transaction which contains other transactions.
-    """
-    return len(self.__child_transactions) != 0
-
-  def generate_request_data(self) -> TransactionRequestData:
-    """Generate request data for this object.
-
-    Returns
-    -------
-    TransactionRequestData
-      Header information required to request the transaction.
-    """
-    request_data = TransactionRequestData()
-    request_data.class_name = self.__transaction_data.transaction_name()
-    request_data.data_type_name = self.__transaction_data.data_type_name()
-    request_data.transaction_address = id(self)
-    request_data.transaction_token = self.__token
-    # The qualifiers field starts with an underscore so that it isn't
-    # included in the body of the request. Include the qualifiers in
-    # the header.
-    # pylint: disable=protected-access
-    client_qualifiers = self.__initial_value._qualifiers
-    server_qualifiers = []
-    for qualifier in client_qualifiers.values:
-      # Handle qualifiers which the server doesn't need to know about.
-      if qualifier.key == "CallOnConfirm":
-        self.__confirm_callbacks.append(qualifier.parameters.values[0])
-        continue
-      server_qualifiers.append(qualifier)
-
-    request_data.qualifiers = QualifierSet()
-    request_data.qualifiers.values = server_qualifiers
-    return request_data
-
-  def _register_child_transactions(
-      self,
-      transaction_data: TransactionData
-      ) -> typing.List["Transaction"]:
-    """Register the child transactions with the TransactionManager.
-
-    Parameters
-    ----------
-    transaction_data
-      TransactionData to register child transactions for.
-
-    Returns
-    -------
-    list[Transaction]
-      List of child transactions for the transaction_data.
-      This will be empty if transaction_data was not a compound transaction.
-    """
-    child_transactions = []
-    # Determine the list of fields of the message from the annotations.
-    annotations = getattr(transaction_data, '__annotations__', {})
-    # Ignore repeating fields and class variables.
-    def ignore_annotation(field_type):
-      origin = getattr(field_type, '__origin__', type(None))
-      return origin is typing.ClassVar or issubclass(origin, RepeatingField)
-
-    fields = list(
-      (field_name, field_type)
-      for field_name, field_type in annotations.items()
-      if not ignore_annotation(field_type))
-
-    for field in fields:
-      field_name, field_type = field
-      if field_name.startswith("_"):
-        continue
-      # If the field is a subclass of TransactionData, then this has
-      # found a child transaction.
-      if issubclass(field_type, TransactionData):
-        field_value = getattr(transaction_data, field_name)
-        child = self.__transaction_manager.create_transaction(
-          field_type,
-          field_value,
-          self.__server_name,
-          self
-        )
-        child_transactions.append(child)
-      else:
-        # It is not a compound transaction.
-        break
-
-    return child_transactions
-
-  def send(self):
-    """Send the transaction to the relevant server.
-
-    Raises
-    ------
-    TransactionSetUpError
-      If the menu command could not be created on the relevant server.
-    """
-    if self.is_compound():
-      request = TransactionCreateCompound()
-      request.child_transactions = TransactionRequestDataList()
-      request.child_transactions.request_list = [
-        child.generate_request_data() for child in self.__child_transactions
-      ]
-    else:
-      request = TransactionCreate()
-
-    request.transaction_manager_address = id(self.__transaction_manager)
-    request.request_data = self.generate_request_data()
-
-    request.initial_value = self.__initial_value
-    response = request.send(self.__server_name)
-    # pylint: disable=no-member
-    # Pylint can't figure out that response is of ResponseType.
-    if not response.success:
-      raise TransactionSetUpError(self.name())
-    self.__server_address = response.server_address
-
-  def confirm_received(self, confirm_message):
-    """Handle a TransactionConfirm message for this transaction.
-
-    Parameters
-    ----------
-    message_handle
-      Message handle for the confirm message. This assumes that the
-      transaction address and token have already been extracted
-      from the message.
-    """
-    # This doesn't currently use the context. Read it and discard it
-    # so that the next part of the message can be read.
-    _ = Context.from_handle(confirm_message)
-
-    data = self._read_transaction_data(confirm_message)
-
-    # Handle callbacks for the confirm.
-    try:
-      for callback in self.__confirm_callbacks:
-        callback(self, data)
-    except Exception as error:
-      # The error will be re-raised by wait_for_value().
-      self.__error = error
-      return
-
-    self._value = data
-
-  def cancel(self):
-    """Cancel this transaction.
-
-    This will destroy the server-side representation as if the user
-    had cancelled the transaction in the user interface.
-    """
-    self.__is_cancelled = True
-    self._delete_server_side()
-
-  def cancel_received(self, cancel_message):
-    """Handle a TransactionCancel message for this transaction.
-
-    Parameters
-    ----------
-    message_handle
-      Message handle for the cancel message. This assumes the transaction
-      address and token have already been extracted from the message.
-    """
-    self.cancel()
+if typing.TYPE_CHECKING:
+  from .comms import Factory
 
-    # :NOTE: This could read the context and transaction data,
-    # but it isn't used.
-
-  def _delete_server_side(self):
-    """Delete the transactions server-side representation.
-
-    This should be called immediately after receiving a response from
-    the server to ensure that any UI the server created for the request
-    is disposed of quickly.
-
-    It is safe to call this function multiple times.
-    """
-    if self.__server_address is None:
-      return
-    destroy_request = TransactionDestroy()
-    # We don't currently support parent transactions, so the parent
-    # address is the same as the transaction address.
-    destroy_request.parent_transaction_address = self.__server_address
-    destroy_request.transaction_address = self.__server_address
-    destroy_request.send(self.__server_name)
-    self.__server_address = None
-
-  def wait_for_value(self, timeout: typing.Optional[float]=None) -> T:
-    """Wait for the transaction to be confirmed and return a value.
-
-    Returns
-    -------
-    T
-      The response type for this transaction.
-    timeout
-      Time in seconds to wait for a value. If a value is not
-      returned in this time, a TransactionTimeoutError will be raised.
-
-    Raises
-    ------
-    TransactionCancelledError
-      If the transaction is cancelled. This includes if the MCP
-      is shut down.
-    TransactionFailedError
-      If an error occurs.
-    TransactionTimeoutError
-      If timeout is specified and no value was received after the
-      timeout had elapsed.
-    """
-    if timeout is None:
-      timeout = TransactionManager.default_timeout
-    if timeout:
-      start_time = time.perf_counter()
-    try:
-      while True:
-        result = Mcpd().dll.McpServicePendingEvents()
-        if not result:
-          raise TransactionCancelledError(self.name())
-        if self._value is not None:
-          break
-        if self.__is_cancelled:
-          break
-        if self.__error:
-          raise self.__error
-        if timeout:
-          duration = time.perf_counter() - start_time
-          if duration > timeout:
-            raise TransactionTimeoutError(self.name(), timeout)
-    except OSError as error:
-      LOG.exception(error)
-      raise
-    if self.__is_cancelled:
-      raise TransactionCancelledError(self.name())
-
-    assert self._value is not None
-    return self._value
-
-  def _read_transaction_data(self, message_handle: T_MessageHandle) -> T:
-    """Read the transaction data from a message.
-
-    Parameters
-    ----------
-    message_handle
-      Message handle to read the transaction data from.
-      This message handle should already have been partially
-      read via TransactionConfirm.from_handle(). This reads the remaining
-      data from the message and assigns it to this object so that it
-      will be returned by wait_for_value().
-    """
-    try:
-      return self.__transaction_data.from_handle(message_handle)
-    except:
-      self.__error = TransactionFailedError(
-        "Failed to read result of operation."
-      )
-      raise
-
-  def __exit__(self, __exc_type, __exc_value, __traceback):
-    for child in self.__child_transactions:
-      self.__transaction_manager._remove_transaction(child)
-      child._delete_server_side()
-    self.__transaction_manager._remove_transaction(self)
-    self._delete_server_side()
 
 class TransactionManager:
   """Manages MCP messages related to transactions.
 
   This class maintains a list of all of the transactions it has started.
   When an MCP event arrives which is relevant to one of these transactions,
   it parses enough of the message to identify which transaction the message
   is for. It then passes the remainder of that message to the transaction
   for handling.
+
+  Parameters
+  ----------
+  factory
+    The factory to use to read and write parts of MCP messages.
   """
   default_timeout: typing.ClassVar[typing.Optional[float]]=None
   """The default time out for operations.
 
   This is None by default, indicating operations should only time out if the
   caller specifies a timeout.
   """
 
-  def __init__(self):
-    self.__callback_handles: typing.List[
-      typing.Tuple[typing.Any, typing.Callable[[typing.Any], None]], str] = []
-    """List of callbacks created by this object.
-
-    Each element of the list is a tuple containing:
-
-    * The callback handle.
-    * The callback function.
-    * The name of the message which will trigger the callback.
-
-    Both the handle and the function need to be kept until this object is
-    destructed to avoid undefined behaviour caused by attempting to call a
-    callback which has been disposed of.
+  def __init__(self, factory: Factory):
+    self._factory = factory
+    """Factory to use to create and receive MCP messages."""
+    self.__callbacks: typing.List[McpCallback] = []
+    """List of MCP callbacks.
 
-    This is also used to ensure all of the callbacks are disposed when
-    this object is disposed.
+    This is used to ensure that all callbacks are disposed when this object
+    is exited.
     """
 
     self.__transactions: typing.Dict[
-      typing.Tuple[ctypes.c_uint64, ctypes.c_uint64], Transaction] = {}
+      TransactionKey, TransactionBase] = {}
     """Dictionary of transactions this object is keeping track of.
 
     The keys are a tuple of the transaction address and transaction token,
     and the values are the actual Transaction objects.
     """
 
   def __enter__(self):
     def _on_transaction_confirm(message_handle):
       """Callback run when a TransactionConfirm message arrives."""
       # This reads the generic parts of the TransactionConfirm.
       # It doesn't read to the end of the message, only the
       # generic part at the beginning.
-      event = TransactionConfirm.from_handle(message_handle)
+      # Because of this piecemeal method of reading, this cannot use
+      # callback_on_receive().
+      event = ReceivedTransactionConfirmHeader.receive(
+        message_handle, self._factory)
       try:
         # pylint: disable=no-member
         # Pylint incorrectly deduces the type of event as Message
         # instead of TransactionConfirm.
         # See: https://github.com/PyCQA/pylint/issues/981
         transaction = self.__transactions[
-            (event.transaction_address, event.transaction_token)
+            (int(event.transaction_address), int(event.transaction_token))
           ]
-        transaction.confirm_received(message_handle)
+        transaction.confirm(message_handle)
       except KeyError:
         # pylint: disable=no-member
         # Same issue as in the try block.
         LOG.info(
           "Received TransactionConfirm for: "
           "transaction_address: %s "
           "transaction token: %s "
           "But it was not found in the transaction list",
           event.transaction_address, event.transaction_token)
 
-    def _on_transaction_cancel(message_handle):
+    def _on_transaction_cancel(event: ReceivedTransactionCancelHeader):
       """Callback run when a TransactionCancel message arrives."""
-      event = TransactionCancel.from_handle(message_handle)
-
       try:
         # pylint: disable=no-member
         transaction = self.__transactions[
-          (event.transaction_address, event.transaction_token)
+          (int(event.transaction_address), int(event.transaction_token))
         ]
-        transaction.cancel_received(message_handle)
+        transaction.cancel()
 
       except KeyError:
         # pylint: disable=no-member
         LOG.info(
           "Received TransactionCancel for: "
           "transaction_address: %s "
           "transaction token: %s "
           "But it was not found in the transaction list",
           event.transaction_address, event.transaction_token)
 
-    self.__register_callback(
-      "TransactionConfirm",
-      _on_transaction_confirm
-    )
-    self.__register_callback(
-      "TransactionCancel",
-      _on_transaction_cancel
+    self.__callbacks.append(
+      McpCallback(
+        "TransactionConfirm",
+        _on_transaction_confirm)
+    )
+    self.__callbacks.append(
+      ReceivedTransactionCancelHeader.callback_on_receive(
+        Mcpd(),
+        _on_transaction_cancel,
+        self._factory
+      )
     )
     return self
 
   def __exit__(self, exc_type, exc_value, traceback):
+    if len(self.__transactions) != 0:
+      count = len(self.__transactions)
+      warnings.warn(
+        RuntimeWarning(
+          f"{count} transactions were not removed."
+        )
+      )
     for transaction in list(self.__transactions.values()):
       self._remove_transaction(transaction)
-    for callback_handle, _, message_name in self.__callback_handles:
-      Mcpd().dll.McpRemoveCallbackOnMessage(
-        message_name.encode("utf-8"), callback_handle)
-
-  def __register_callback(self, event_name: str, callback):
-    """Register a callback to be called for the given MCP event.
-
-    This handles registering the callback to be removed when this
-    object is disposed.
-
-    Parameters
-    ----------
-    event_name
-      The name of the event which should call the callback.
-    callback
-      Function which accepts a message handle and returns no value
-      to be called when the event arrives.
-    """
-    callback_handle = Mcpd().dll.Callback(callback)
-    # :TRICKY: Include the callback handle in the tuple to ensure
-    # it is not garbage collected before it is called.
-    self.__callback_handles.append(
-      (Mcpd().dll.McpAddCallbackOnMessage(
-        event_name.encode("utf-8"),
-        callback_handle
-      ), callback_handle, event_name)
-    )
+    for callback in self.__callbacks:
+      callback.__exit__(None, None, None)
 
   def create_transaction(
       self,
-      data_type: typing.Type[T],
-      initial_value: T,
-      server_name: str,
-      parent_transaction: typing.Optional[Transaction]=None
-      ) -> Transaction[T]:
+      transaction_type: type[T],
+      parent_transaction: typing.Optional[TransactionBase]=None
+      ) -> T:
     """Create a new transaction managed by this object.
 
     This transaction is not sent to the server.
 
     Parameters
     ----------
-    data_type
-      The data type of the transaction.
-    qualifiers
-      The qualifiers of the transaction.
-    initial_values
-      The initial values of the transaction.
-    server_name
-      The name of the server which will host the transaction.
+    transaction_type
+      The type of the transaction to create. This must be a TransactionBase
+      subclass.
+    parent_transaction
+      An existing transaction which has already been created by this object.
+      If None, the newly created transaction is a top-level transaction.
 
     Returns
     -------
-    Transaction
+    TransactionBase
       The newly created Transaction.
     """
-    if not isinstance(initial_value, data_type):
-      raise TypeError(
-        f"Initial value should be type '{data_type.__name__}', "
-        f"not {type(initial_value).__name__}"
-      )
-    transaction = Transaction(
-      self,
-      data_type,
-      initial_value,
-      server_name,
-      parent_transaction
-    )
+    transaction = transaction_type(self, self._factory, parent_transaction)
     key = transaction.key()
     self.__transactions[key] = transaction
     return transaction
 
-  def _remove_transaction(self, transaction: Transaction):
+  def service_events(self) -> bool:
+    """Service MCP events.
+
+    Returns
+    -------
+    bool
+      If events were successfully serviced.
+    """
+    return Mcpd().dll.McpServicePendingEvents()
+
+  def _remove_transaction(self, transaction: TransactionBase):
     """Remove the transaction from the transaction manager.
 
     This will cause MCP events intended for this transaction to be
     ignored. This will do nothing if the transaction has already been
     removed, or was never added to this object.
 
     Parameters
```

## mapteksdk/internal/transaction_request_data.py

```diff
@@ -1,17 +1,17 @@
 """The transaction request object.
 
 Warnings
 --------
 Vendors and clients should not develop scripts or applications against
 this package. The contents may change at any time without warning.
 """
-import ctypes
+import typing
 
-from .comms import InlineMessage, SubMessage, RepeatingField
+from .comms import InlineMessage, SubMessage, Int64u
 from .qualifiers import QualifierSet
 
 class TransactionRequestData(InlineMessage):
   """Data required to request a transaction.
 
   This can be used either for top-level transactions, or for
   transactions which request other transactions.
@@ -21,22 +21,22 @@
 
   This should include the namespace.
   """
 
   data_type_name: str
   """The data type name for this transaction."""
 
-  transaction_address: ctypes.c_uint64
+  transaction_address: Int64u
   """The address of the transaction object.
 
   This is used, along with the transaction token, to uniquely
   identify the transaction.
   """
 
-  transaction_token: ctypes.c_uint64
+  transaction_token: Int64u
   """The transaction token.
 
   This is used, along with the transaction address, to uniquely
   identify the transaction. This should be different for every
   message sent within the same process.
   """
 
@@ -45,8 +45,19 @@
 
 class TransactionRequestDataList(SubMessage):
   """A repeating field of TransactionRequestData.
 
   This is used to represent the metadata of the child transactions of
   a compound transaction.
   """
-  request_list: RepeatingField[TransactionRequestData]
+  @classmethod
+  def repeating_field_type(cls):
+    return TransactionRequestData
+
+  @property
+  def request_list(self) -> typing.Sequence[TransactionRequestData]:
+    """The requests in this list."""
+    return self.repeating_field_values
+
+  @request_list.setter
+  def request_list(self, requests: typing.Sequence[TransactionRequestData]):
+    self.repeating_field_values = requests
```

## mapteksdk/internal/undo.py

```diff
@@ -2,17 +2,18 @@
 ###############################################################################
 #
 # (C) Copyright 2023, Maptek Pty Ltd. All rights reserved.
 #
 ###############################################################################
 from __future__ import annotations
 
-import ctypes
 import typing
 
+from ..capi import Mcpd
+from .comms import Int32u, default_factory
 from .transaction import TransactionRequest
 from .qualifiers import QualifierSet, Qualifiers
 from .before_undo_state import BeforeUndoState
 
 if typing.TYPE_CHECKING:
   from mapteksdk.data import ObjectID, ChangeReasons
 
@@ -159,24 +160,25 @@
     if len(self) == 0:
       # No need to send a message if the stack is empty.
       return
 
     if not self._can_send:
       return
 
-    request = TransactionRequest()
+    factory = default_factory.default_factory(Mcpd())
+    request = TransactionRequest(factory)
     request.transaction = "mtp::cadS_EditObjectTransaction"
     request.qualifiers = QualifierSet()
 
     before_handles = [
       BeforeUndoState(item.before_id, item.primary_children)
       for item in self.__items]
-    after_handles = [item.after_id.handle for item in self.__items]
+    after_handles = [item.after_id for item in self.__items]
     change_reasons = [
-      ctypes.c_uint32(item.change_reasons.value) for item in self.__items]
+      Int32u(item.change_reasons.value) for item in self.__items]
 
     request.qualifiers.values = [
       Qualifiers.user_data(
         "beforeObjects",
         "class std::vector<class mtp::cadC_BeforeUndoState,"
         "class std::allocator<class mtp::cadC_BeforeUndoState> >",
         before_handles
```

## mapteksdk/internal/writable_selection.py

```diff
@@ -12,15 +12,15 @@
 ###############################################################################
 
 from collections.abc import Sequence
 import enum
 import typing
 
 from ..data import ObjectID
-from .comms import SubMessage, RepeatingField
+from .comms import SubMessage
 from .serialisation import FixedInteger32Mixin
 
 
 class SelectionType(FixedInteger32Mixin, enum.Flag):
   """The type of the writable selection."""
   NONE = 0
   """Nothing is selected."""
@@ -40,15 +40,25 @@
   """Objects are selected."""
 
 
 class WritableSelection(SubMessage, Sequence):
   """A selection intended to be sent in an MCP message."""
   class InternalSelection(SubMessage):
     """A data group containing a repeating field of ObjectID."""
-    selection: RepeatingField[ObjectID]
+    @classmethod
+    def repeating_field_type(cls):
+      return ObjectID
+
+    @property
+    def selection(self) -> typing.Sequence[ObjectID]:
+      return self.repeating_field_values
+
+    @selection.setter
+    def selection(self, values: typing.Sequence[ObjectID]):
+      self.repeating_field_values = values
 
   internal_selection: InternalSelection
   """The selected objects."""
   selection_type: SelectionType
   """The ctypes type of the selection ready for serialisation.
 
   Use the selection_type property to get the enum value.
@@ -70,23 +80,23 @@
     Parameters
     ----------
     selection
       The ObjectIDs to contain in this selection.
     """
     result = cls()
     result.internal_selection = cls.InternalSelection()
-    result.internal_selection.selection = selection # type: ignore
+    result.internal_selection.selection = selection
     selection_type = (
       SelectionType.OBJECT if len(selection) > 0 else SelectionType.NONE)
     result.selection_type = selection_type
     return result
 
 
   def __getitem__(self, index) -> typing.Tuple[ObjectID, SelectionType]:
-    return self.internal_selection.selection[index] # type: ignore
+    return self.internal_selection.selection[index]
 
   def __len__(self) -> int:
     return len(self.internal_selection.selection)
 
   def __eq__(self, __value: object) -> bool:
     if not isinstance(__value, WritableSelection):
       return False
```

## mapteksdk/labs/view.py

```diff
@@ -17,96 +17,108 @@
 """
 ###############################################################################
 #
 # (C) Copyright 2021, Maptek Pty Ltd. All rights reserved.
 #
 ###############################################################################
 
-import ctypes
 import typing
 
 from mapteksdk.view import ViewController
-from mapteksdk.internal.comms import Message, InlineMessage, Request
+from mapteksdk.internal.comms import (
+  Message,
+  InlineMessage,
+  Request,
+  Response,
+  Double,
+  Float,
+)
 
 
 class RigidTransform(InlineMessage):
   """Represents a rigid body (6 degree of freedom) transformation in 3D space.
   """
-  rotation: typing.Tuple[ctypes.c_double, ctypes.c_double, ctypes.c_double,
-             ctypes.c_double]
-  translation: typing.Tuple[ctypes.c_double, ctypes.c_double, ctypes.c_double]
+  rotation: typing.Tuple[Double, Double, Double, Double]
+  translation: typing.Tuple[Double, Double, Double]
 
 
-class Camera(Message):
+class Camera(Response):
   """Response back for the Camera request."""
-  origin: typing.Tuple[ctypes.c_double, ctypes.c_double, ctypes.c_double]
+  origin: typing.Tuple[Double, Double, Double]
   artificial_scale: typing.Tuple[
-    ctypes.c_double, ctypes.c_double, ctypes.c_double]
+    Double, Double, Double]
   rigid_transform: RigidTransform
-  angular_field_of_view: ctypes.c_double
-  linear_field_of_view: ctypes.c_double
-  perspective_factor: ctypes.c_double
+  angular_field_of_view: Double
+  linear_field_of_view: Double
+  perspective_factor: Double
 
 
 class LabsViewController(ViewController):
   """Provides access onto a specified view, with additional work-in progress
   features.
   """
 
   def camera(self):
     """Return the current camera (i.e position/orientation) for the view."""
 
     class RequestCamera(Request):
       """Requests the current camera for a view."""
-      message_name: typing.ClassVar[str] = 'Camera'
-      response_type = Camera
+      @classmethod
+      def message_name(cls) -> str:
+        return 'Camera'
+
+      @classmethod
+      def response_type(cls) -> type[Camera]:
+        return Camera
 
-    request = RequestCamera()
+    request = RequestCamera(self._factory)
 
     # This returns the message type. We need to decide if we want to have our
     # own type or at least convert this to a named tuple.
-    return request.send(destination=self.server_name)
+    return request.send(self.server_name)
 
-  def set_camera(self, new_camera, smoothly=True):
+  def set_camera(self, new_camera: Camera, smoothly: bool=True):
     """Change the current camera of the view.
 
     Parameters
     ----------
-    new_camera : Camera
+    new_camera
       The new camera to use for the view.
-    smoothly : bool
+    smoothly
       Whether the camera should smoothly transition to the new state, or if it
       should change instantaneously.
     """
 
     class SetCamera(Message):
       """A message for a viewerServer to change its camera."""
-      message_name: typing.ClassVar[str] = 'SetCamera'
+      @classmethod
+      def message_name(cls) -> str:
+        return 'SetCamera'
 
-      origin: typing.Tuple[ctypes.c_double, ctypes.c_double, ctypes.c_double]
+      origin: typing.Tuple[Double, Double, Double]
       artificial_scale: typing.Tuple[
-        ctypes.c_double, ctypes.c_double, ctypes.c_double]
+        Double, Double, Double]
       rigid_transform: RigidTransform
-      angular_field_of_view: ctypes.c_double
-      linear_field_of_view: ctypes.c_double
-      perspective_factor: ctypes.c_float
+      angular_field_of_view: Double
+      linear_field_of_view: Double
+      perspective_factor: Float
       prevent_automove_on_future_add_objects: bool
 
     if smoothly:
       self._start_camera_transition(transition_time=2.0)
 
-    message = SetCamera()
+    message = SetCamera(self._factory)
     message.origin = new_camera.origin
     message.artificial_scale = new_camera.artificial_scale
     message.rigid_transform = new_camera.rigid_transform
     message.angular_field_of_view = new_camera.angular_field_of_view
     message.linear_field_of_view = new_camera.linear_field_of_view
     message.perspective_factor = new_camera.perspective_factor
     message.prevent_automove_on_future_add_objects = True
-    message.send(destination=self.server_name)
+    message.send(self.server_name)
 
   def change_camera(self, change_function, smoothly=True):
     """Change a part of the camera.
 
     The part that is changed is based on what the change_function does.
     It is called with the current state of the camera and should make the
     appropriate modifications to it
```

## mapteksdk/pointstudio/operations.py

```diff
@@ -13,14 +13,15 @@
 #
 # (C) Copyright 2020, Maptek Pty Ltd. All rights reserved.
 #
 ###############################################################################
 
 import enum
 import numpy
+import typing
 
 from mapteksdk.common import convert_to_rgba
 from mapteksdk.capi.mcp import Mcpd as McpDll
 from mapteksdk.data.colourmaps import NumericColourMap
 from mapteksdk.data.objectid import ObjectID
 from mapteksdk.internal.transaction import (request_transaction,
                                             RequestTransactionWithInputs)
@@ -673,26 +674,26 @@
                      'should be RELIMIT_TO_POLYGON')
 
   if edge_constraints and \
       output_option is not TriangulationOutput.SPLIT_ALONG_EDGE_CONSTRAINTS:
     raise ValueError('If providing the edges for edge constraints, the '
                      'output_option should be SPLIT_ALONG_EDGE_CONSTRAINTS')
 
-  inputs = [
+  inputs: list[tuple[str, typing.Any]] = [
     ('selection',
      RequestTransactionWithInputs.format_selection(
        scans + (edge_constraints or []))),
   ]
 
   if destination:
     inputs.append(('destination', destination))
 
   if McpDll().version >= (1, 10):  # PointStudio 2024 or later.
     if trim_edges_to_maximum_length is None:
-        inputs.append(('trimLargeTriangles', 'false'))
+      inputs.append(('trimLargeTriangles', 'false'))
     else:
       inputs.extend([
         ('trimLargeTriangles', 'true'),
         ('trimLargeTriangles/boundaryEdgesOnly', 'true'),
         ('trimLargeTriangles/maximumEdgeLength',
         str(trim_edges_to_maximum_length)),
       ])
```

## mapteksdk/project/__init__.py

```diff
@@ -41,15 +41,16 @@
 from ..internal.logger import configure_log
 from ..internal.mcp import (ExistingMcpdInstance, McpdConnection, find_mdf_hosts)
 from ..internal.options import (ProjectOptions, ProjectOpenMode)
 from ..internal.overwrite import add_objects_with_overwrite
 from ..internal.path_helpers import check_path_component_validity, valid_path
 from ..internal.undo import UndoStack, UndoNotSupportedError
 from ..internal.util import default_type_error_message
-from ..internal.backends import ExistingBackend, InMemoryBackend, NewBackend
+from ..internal.backends import (ExistingBackend, InMemoryBackend, NewBackend,
+                                 BackendObserver)
 from ..overwrite_modes import OverwriteMode
 from ..labs.cells import SparseIrregularCellNetwork
 from .errors import (DeleteRootError, ObjectDoesNotExistError,
                      NoHostApplicationError, ProjectConnectionFailureError,
                      ApplicationTooOldError, TypeMismatchError,
                      NoRecycleBinError, InvalidParentError)
 from .selection import Selection
@@ -157,25 +158,26 @@
     # no longer guaranteed to be called. During unit testing, spawned mcpd.exe
     # and backendserver.exe would remain open indefinitely after the unit tests
     # finished - preventing subsequent runs.
     # Not an issue if connecting to an existing host application.
     self._exit_function = atexit.register(self.unload_project)
     self.__dll_directory_set = False
 
-    # Configure all the MDF loggers with defaults. This is done when the user
-    # creates the Project() instance so they don't need to do it themselves and
-    # so by default we can have consistent logging.
-    #
-    # Only configure the logging once as otherwise output will be duplicated as
-    # it set-up multiple log handlers.
-    if not Project._configured_logging:
-      configure_log(logging.getLogger('mapteksdk'))
-      Project._configured_logging = True
-
-    self.log = logging.getLogger('mapteksdk.project')
+    try:
+      # Configure all the MDF loggers with defaults. This is done when the user
+      # creates the Project() instance so they don't need to do it themselves
+      # and so by default we can have consistent logging.
+      #
+      # Only configure the logging once as otherwise output will be duplicated
+      # as it set-up multiple log handlers.
+      if not Project._configured_logging:
+        configure_log(logging.getLogger('mapteksdk'))
+        Project._configured_logging = True
+    finally:
+      self.log = logging.getLogger('mapteksdk.project')
 
     # If no options are provided, there are some default options we expect.
     if not options:
       options = ProjectOptions('')
 
     # If connecting to an existing mcpd, determine which one and set up the
     # DLL load path. This will finding a mcpd to connect to if one was not
@@ -200,40 +202,53 @@
           raise NoHostApplicationError(error_message)
 
     if existing_mcpd and not isinstance(existing_mcpd, McpdConnection):
       # The connection hasn't been established yet so the DLL path isn't
       # configured either.
       options.dll_path = existing_mcpd[1]
 
-    if not options.dll_path:
+    if (not options.dll_path and
+        options.open_mode is not ProjectOpenMode.OPEN_EXISTING_THREAD):
       raise ProjectConnectionFailureError(
           "Failed to locate folder containing required DLLs. "
           "No search paths could be determined.")
 
     if options.open_mode is ProjectOpenMode.MEMORY_ONLY:
       self.backend = InMemoryBackend(self.log)
     elif options.open_mode is ProjectOpenMode.OPEN_EXISTING:
       self.backend = ExistingBackend(self.log, existing_mcpd)
+    elif options.open_mode is ProjectOpenMode.OPEN_EXISTING_THREAD:
+      parent_backend = options.existing_backend
+      if not parent_backend:
+        raise ProjectConnectionFailureError(
+          "Cannot connect to the Project on a thread if the initial "
+          "project is not connected."
+        )
+      self.backend = BackendObserver(self.log, parent_backend)
     elif options.open_mode in (ProjectOpenMode.CREATE_NEW,
                                ProjectOpenMode.OPEN_OR_CREATE):
       self.backend = NewBackend(
         self.log,
-        existing_mcpd if isinstance(existing_mcpd, ExistingMcpdInstance) else None,
+        existing_mcpd if isinstance(
+          existing_mcpd, ExistingMcpdInstance) else None,
         options)
     else:
-      raise ValueError("Unrecognised open mode: {options.open_mode}.")
+      raise ValueError("Unrecognized open mode: {options.open_mode}.")
 
-    try:
-      register_dll_directory(options.dll_path)
-      self.__dll_directory_set = True
-    except FileNotFoundError as error:
-      searched_paths = "\n".join([str(x) for x in error.searched_paths])
-      raise ProjectConnectionFailureError(
-        "Failed to locate folder containing required DLLs. "
-        f"Searched:\n{searched_paths}") from None
+    # When opening an existing project on another thread, the DLLs are
+    # expected to already be registered by the first thread.
+    if not isinstance(self.backend, BackendObserver):
+      try:
+        register_dll_directory(options.dll_path)
+        self.__dll_directory_set = True
+      except FileNotFoundError as error:
+        searched_paths = "\n".join([str(x) for x in error.searched_paths])
+        raise ProjectConnectionFailureError(
+          "Failed to locate folder containing required DLLs. "
+          f"Searched:\n{searched_paths}") from None
 
     try:
       licence = self.backend.acquire_licence(
         options.account_broker_connector_path,
         options.account_broker_session_parameters)
 
       os.environ["MDF_ACTIVE_PACKAGE"] = licence
@@ -457,14 +472,19 @@
     if self.backend:
       self.backend.disconnect_from_project()
 
     if self.__dll_directory_set:
       disable_dll_loading()
       self.__dll_directory_set = False
 
+    if 'MDF_ACTIVE_PACKAGE' in os.environ:
+      del os.environ["MDF_ACTIVE_PACKAGE"]
+    if 'MDF_EXTEND_LICENCE_STRING' in os.environ:
+      del os.environ["MDF_EXTEND_LICENCE_STRING"]
+
     # The project has been unloaded so it doesn't need to be done when the
     # interpreter terminates.
     if self._exit_function:
       atexit.unregister(self._exit_function)
       self._exit_function = None
 
   @property
@@ -494,22 +514,32 @@
     +---------------------------+-------------+
     | PointStudio 2022          | (1, 3)      |
     +---------------------------+-------------+
     | PointStudio 2022.0.1      | (1, 3)      |
     +---------------------------+-------------+
     | PointStudio 2022.1        | (1, 3)      |
     +---------------------------+-------------+
+    | PointStudio 2023          | (1, 7)      |
+    +---------------------------+-------------+
+    | PointStudio 2024          | (1, 10)     |
+    +---------------------------+-------------+
     | Vulcan GeologyCore 2021   | (1, 4)      |
     +---------------------------+-------------+
     | Vulcan GeologyCore 2021.1 | (1, 4)      |
     +---------------------------+-------------+
     | Vulcan GeologyCore 2022   | (1, 5)      |
     +---------------------------+-------------+
     | Vulcan GeologyCore 2022.1 | (1, 7)      |
     +---------------------------+-------------+
+    | Vulcan GeologyCore 2023   | (1, 7)      |
+    +---------------------------+-------------+
+    | Vulcan GeologyCore 2023.1 | (1, 9)      |
+    +---------------------------+-------------+
+    | GeologyCore 2024          | (1, 10)     |
+    +---------------------------+-------------+
 
     Earlier applications will have an API version of (0, 0). It is not
     recommended to connect to applications with API versions less than (1, 1).
     """
     # Though each C API could have its own version, currently they all
     # return the same version.
     return capi.Modelling().version
@@ -2148,15 +2178,15 @@
     # plain container was created. Typically a Container is a base-class
     # of higher level types and treating them as such wouldn't be ideal.
     if object_type.value == Container.static_type().value:
       return Container
 
     raise TypeError('Unsupported object type')
 
-  def get_selected(self) -> Selection:
+  def get_selected(self) -> Selection[DataObject]:
     """Return the IDs of the selected objects.
 
     When connected to an existing application, these are the objects selected
     in that application (via the explorer, view or some other method).
 
     Returns
     -------
@@ -2260,16 +2290,15 @@
 
       selection = Selection(selected_oids)
 
       # Only update the explorer if connected to an application.
       #
       # This does not take into account if NewBackend is used with a uiServer.
       update_explorer = False
-      if (isinstance(self.backend, ExistingBackend) and
-          self.backend.mcp_connection.is_connected):
+      if self.backend and self.backend.has_project_explorer:
         update_explorer = True
 
       # pylint: disable=protected-access
       selection._make_active_selection(
         update_explorer=update_explorer,
         allow_undo=allow_undo
       )
@@ -2524,14 +2553,47 @@
       undo_stack.add_operation(
         before_id,
         oid,
         change_reasons,
         primary_children,
       )
 
+  @classmethod
+  def open_on_thread(cls, existing_project: Project) -> Project:
+    """Open the project on another thread.
+
+    The expectation is the project has already been opened/connected on
+    a thread already. This thread should not out live the project on
+    the other thread as it is responsible for unloading the project.
+
+    Raises
+    ------
+    ApplicationTooOldError
+      If the API version is too low to support this.
+    """
+    existing_project.raise_if_version_below((1,  10))
+
+    parent_backend = existing_project.backend
+    if not parent_backend:
+      # This case is not possible in normal usage.
+      raise ValueError("The existing project has no backend.")
+
+    options = ProjectOptions(
+      "",
+
+      open_mode=ProjectOpenMode.OPEN_EXISTING_THREAD,
+
+      # Don't provide the DLLs as they have already been loaded by
+      # existing_project.
+      dll_path=None,
+      existing_backend=parent_backend,
+    )
+
+    return Project(options)
+
   @staticmethod
   def find_running_applications() -> list[ExistingMcpdInstance]:
     """Return a list of applications that are candidates to be connected to.
 
     No checking is performed on the application to determine if it is suitable
     to connect to. For example, if the product is too old to support the SDK.
```

## mapteksdk/project/selection.py

```diff
@@ -4,43 +4,46 @@
 #
 # (C) Copyright 2022, Maptek Pty Ltd. All rights reserved.
 #
 ###############################################################################
 
 from __future__ import annotations
 
-import collections
 import typing
 
 from ..capi import DataEngine
 from ..capi.types import T_ObjectHandle
 from ..data.base import DataObject
 from ..data.containers import VisualContainer
 from ..data.objectid import ObjectID
-from ..internal.writable_selection import WritableSelection
-from ..internal.transaction_data import WritableSelectionTransactionData
-from ..internal.qualifiers import Qualifiers, InstanceTypes
-from ..operations import _request_transaction_and_wait_for_result
+from ..internal.transaction_elemental import SelectionTransaction
+from ..operations import _request_transaction_and_wait
 
+DataObjectT = typing.TypeVar("DataObjectT", bound=DataObject)
+"""Generic type referring to any subclass of DataObject."""
 
-class Selection(collections.abc.Sequence):
+if typing.TYPE_CHECKING:
+  OtherDataObjectT = typing.TypeVar("OtherDataObjectT", bound=DataObject)
+
+
+class Selection(typing.Sequence[ObjectID[DataObjectT]]):
   """Represents a selection or put simply a sequence of objects.
 
   The selection will only contain a given object once.
 
   An application maintains a special selection, known as the active selection,
   which is the selection highlighted in views and the browser, and under
   direct control of the user.
 
   This means it will either be a copy of the active selection, a subset of it
   or an independent collection of objects.
   """
 
-  def __init__(self, initial: list[ObjectID] | None = None):
-    self.objects = []
+  def __init__(self, initial: list[ObjectID[DataObjectT]] | None = None):
+    self.objects: list[ObjectID[DataObjectT]] = []
 
     if initial:
       # The goal is to preserve the original order, as such we don't simply
       # convert to a set and back to a list.
       seen = set()
       for item in initial:
         if item not in seen:
@@ -60,18 +63,18 @@
     DataEngine().GetSelectedObjects(object_handle_array)
     selected_objects = [ObjectID(handle) for handle in object_handle_array]
     return cls(selected_objects)
 
   def __len__(self) -> int:
     return len(self.objects)
 
-  def __getitem__(self, index):
+  def __getitem__(self, index) -> ObjectID[DataObjectT]:
     return self.objects[index]
 
-  def append(self, item: ObjectID | DataObject):
+  def append(self, item: ObjectID[DataObjectT] | DataObjectT):
     """Append an object to the end of this selection.
 
     If the object is already in the selection it will not be added and no
     error is raised.
 
     Arguments
     ---------
@@ -90,24 +93,26 @@
     >> try:
     ...    selection.append(context_object_id())
     >> except NoContextInformationError:
     ...    pass  # There is no object to add (no context).
     """
     # Convert a DataObject to an ID.
     if isinstance(item, DataObject):
-      item = item.id
+      oid: ObjectID = item.id
+    else:
+      oid: ObjectID = item
 
     if item not in self.objects:
-      self.objects.append(item)
+      self.objects.append(oid)
 
   def clear(self):
     """Remove all items from this selection."""
     self.objects.clear()
 
-  def extend(self, iterable):
+  def extend(self, iterable: typing.Iterable[DataObjectT]):
     """Extend this selection by appending elements from the iterable.
 
     If an object is already in the selection then it will not be appended and
     will be skipped over and subsequent objects will be added if they are not
     already in the selection.
     """
 
@@ -124,15 +129,18 @@
       return item
 
     self.objects.extend(
       _add_and_return(new_id) for new_id in map(_to_id, iterable)
       if new_id not in existing_objects
     )
 
-  def where(self, *object_types: list[type]) -> Selection:
+  def where(
+    self,
+    *object_types: type[OtherDataObjectT]
+  ) -> Selection[OtherDataObjectT]:
     """Return a selection where the type of the object matches given types.
 
     If multiple types are specified, this will filter the selection down to
     objects which are any of the specified types.
 
     It does not require that the object is all of the types because it will
     either be impossible to match them all or it will only match the most
@@ -175,17 +183,20 @@
     >> print(f'There were {len(polygons_and_lines)} out of {len(selection)}.')
 
     """
     return Selection([
       selected_object for selected_object in self.objects
       if any(selected_object.is_a(object_type)
              for object_type in object_types)
-    ])
+    ]) # type: ignore
 
-  def where_not(self, *object_types: list[type]) -> Selection:
+  def where_not(
+    self,
+    *object_types: type[OtherDataObjectT]
+  ) -> Selection[DataObject]:
     """Return a selection containing all objects not of the specified types.
 
     When more than one type is given, it will exclude any object if it matches
     any of the given types.
 
     This does not change the current selection.
 
@@ -196,14 +207,30 @@
 
     Returns
     -------
     Selection
         A new selection which only contains objects that are not of the given
         types.
 
+    Warnings
+    --------
+    The static type checking of this function is overly general. Consider the
+    following code:
+
+    >>> selection: Selection[Text2D, Text3D]
+    >>> text_2ds = Selection.where_not(Text3D)
+
+    In the above code, static type checking will determine the type as
+    `Selection[DataObject]` instead of `Selection[Text2D]`. If correct
+    static type checking is desired, you will need to add the type hint
+    manually:
+
+    >>> selection: Selection[Text2D, Text3D]
+    >>> text_2ds: Selection[Text2D] = Selection.where_not(Text3D)
+
     Examples
     --------
     Exclude any containers from the selection.
 
     >> from mapteksdk.project import Project
     >> from mapteksdk.data import VisualContainer
     >> project = Project()
@@ -212,18 +239,21 @@
     >> print(f'There were {len(non_containers)} out of {len(selection)}.')
 
     """
     return Selection([
       selected_object for selected_object in self.objects
       if not any(selected_object.is_a(object_type)
                  for object_type in object_types)
-    ])
+    ]) # type: ignore
 
-  def partition(self, *object_types: list[type],
-                with_remainder=False) -> tuple[Selection]:
+  def partition(
+    self,
+    *object_types: type[DataObject],
+    with_remainder=False
+  ) -> tuple[Selection[DataObject], ...]:
     """Partition the selection by the given types into separate selections.
 
     The same object can appear in multiple selections if one of the object
     types are related to another
 
     If a single type is given and with_remainder is False then you would be
     better off using where() instead. The specific case in which using
@@ -243,14 +273,36 @@
     -------
     tuple
         A selection for each of the given object types, with objects of the
         given type. If with_remainder is True then an additional selection is
         included at the end containing the objects which didn't match any
         given object types.
 
+    Warnings
+    --------
+    The type hints for this function are overly general. Consider the following
+    code:
+
+    >>> selection: Selection[Text2D, Text3D]
+    >>> text_2ds, text_3ds = selection.partition(Text2D, Text3D)
+
+    In this example, `text_2ds` and `text_3ds` will both be considered by
+    static type checking to have the type `Selection[DataObject]` which is
+    true, as both `Text2D` and `Text3D` are subclasses of `DataObject`, but
+    not accurate, as `Surface` and many other types are also subclasses
+    of `DataObject`. If static type checking is required for code which uses
+    this function, you will need to manually assign the type hints:
+
+    >>> selection: Selection[Text2D, Text3D]
+    >>> text_2ds, text_3ds = selection.partition(Text2D, Text3D) # type: ignore
+    >>> text_2ds: Selection[Text2D]
+    >>> text_3ds: Selection[Text3D]
+
+    This may be fixed in a future version of the Python SDK.
+
     Examples
     --------
     Find all the selected polygons and polylines.
 
     >> from mapteksdk.project import Project
     >> from mapteksdk.data import Polygon, Polyline
     >> project = Project()
@@ -279,15 +331,15 @@
 
       if with_remainder and no_match:
         results[-1].objects.append(selected_object)
 
     return tuple(results)
 
   @property
-  def roots(self) -> Selection:
+  def roots(self) -> Selection[DataObjectT]:
     """Return the root objects of this selection.
 
     The root objects in this selection are the objects whose parents are not
     part of this selection.
 
     This is useful when the individual objects in a container aren't needed
     because the function handles containers themselves.
@@ -355,18 +407,20 @@
     Parameters
     ----------
     allow_undo
       If True, the change to the selection will be undoable.
       If False, the change to the selection will not be
       undoable.
     """
-    data = WritableSelectionTransactionData()
-    data.data = WritableSelection.from_selection(self)
-    data.add_qualifier(
-      Qualifiers.instance_type(InstanceTypes.IMPERATIVE),
-    )
-    if not allow_undo:
-      data.add_qualifier(Qualifiers.no_undo_redo())
-    _request_transaction_and_wait_for_result(
-      WritableSelectionTransactionData,
-      data
+    def setup(transaction: SelectionTransaction):
+      transaction.selection = self
+      if not allow_undo:
+        transaction.disable_undo_redo()
+
+    def read_result(_: SelectionTransaction):
+      return None
+
+    _request_transaction_and_wait(
+      SelectionTransaction,
+      setup,
+      read_result
     )
```

## mapteksdk/workflows/connector_type.py

```diff
@@ -31,14 +31,31 @@
     str
       String representation of the type to report to the workflow.
 
     """
     raise NotImplementedError
 
   @classmethod
+  def json_type_string(cls) -> str:
+    """The type string expected to be in JSON inputs.
+
+    This is the same as the type string by default, but for certain cases
+    this differs.
+    """
+    return cls.type_string()
+
+  @classmethod
+  def json_dimensionality(cls) -> str:
+    """The dimensionality of the input in JSON.
+
+    This must either be 'Single' or 'List'. It is 'Single' by default.
+    """
+    return "Single"
+
+  @classmethod
   def from_string(cls, string_value: str) -> typing.Any:
     """Convert a string value from an input connector to the corresponding
     python type and returns it.
 
     Returns
     -------
     any
```

## mapteksdk/workflows/connector_types.py

```diff
@@ -229,14 +229,22 @@
 
   """
   @classmethod
   def type_string(cls) -> str:
     return "List"
 
   @classmethod
+  def json_type_string(cls) -> str:
+    return "String"
+
+  @classmethod
+  def json_dimensionality(cls) -> str:
+    return "List"
+
+  @classmethod
   def from_string(cls, string_value: str) -> list:
     if not isinstance(string_value, str):
       raise TypeError(default_type_error_message("string_value",
                                                  string_value,
                                                  str))
     # Strip off the first and last character if they are brackets.
     if string_value.startswith("[") and string_value.endswith("]"):
```

## mapteksdk/workflows/parser.py

```diff
@@ -17,43 +17,58 @@
 import atexit
 import io
 import json
 import logging
 import sys
 import typing
 
+import numpy as np
+
 from .connector_type import ConnectorType
 from .connector_types import (BooleanConnectorType, CSVStringConnectorType,
-                              AnyConnectorType,
+                              AnyConnectorType, Point3DConnectorType,
                               python_type_to_connector_type)
+from .errors import (
+  InvalidConnectorNameError,
+  DuplicateConnectorError,
+  MalformedInputError,
+  InputFormatNotSupportedError,
+  InputTypeError,
+  UnknownInputError,
+  MissingInputError,
+)
 from .matching import MatchAttribute
+from .internal.converters import parse_input
+from .workflow_selection import WorkflowSelection
 from ..internal.util import default_type_error_message
 
 log = logging.getLogger("mapteksdk.workflows")
 
 T = typing.TypeVar("T")
 
 if typing.TYPE_CHECKING:
+  from .internal.schema import (
+    WorkflowInputs,
+    WorkflowInput,
+    SupportedTypeNames,
+    Dimensionality,
+  )
   try:
     class _WorkflowDescription(typing.TypedDict, total=False):
       """Typed dictionary used to type hint JSON workflow description"""
       Description: str
       InputConnectors : list[dict[str, typing.Any]]
       OutputConnectors : list[dict[str, typing.Any]]
       AllowUnknownAttributes: bool
+      SupportsCommandLineArguments: bool
+      MinimumJsonInputVersion: int
+      MaximumJsonInputVersion: int
   except AttributeError:
     pass
 
-class InvalidConnectorNameError(ValueError):
-  """Error raised when a connector name is invalid."""
-
-
-class DuplicateConnectorError(Exception):
-  """Error raised when a duplicate connector is declared."""
-
 
 class _Connector:
   """Class designed to hold metadata for input and output connectors.
 
   This is primarily used for serializing the input/output connector
   information to JSON to be used by the Extend Python workflow component to
   generate input and output connectors.
@@ -126,22 +141,33 @@
   @property
   def arg_type(self) -> type[ConnectorType]:
     """The type of argument accepted by this connector."""
     return self.__arg_type
 
 
 class WorkflowArgumentParser:
-  """Class which allows scripts to accept inputs and write outputs when run
-  via the Extend Python Script workflow component. In particular,
-  scripts which use this class can automatically generate their input and
-  output connectors via the "Generate Connectors" button in the
-  workflow component configuration.
+  """Interface for Workflows and WorkflowMAE.
+
+  This class allows scripts to accept inputs and produce outputs when run
+  via the Extend Python Script workflow component or the Python Script
+  WorkflowMAE node. In particular, scripts which use this class can
+  automatically generate their input and output connectors via the
+  "Generate Connectors" button in the configuration.
+
   Scripts which use this class are also runnable via the command line -
   values for the input connectors can be passed as command line arguments.
 
+  Starting in 1.7, this class can also accept its inputs as a JSON file.
+  This is more robust (particularly when dealing with list inputs) than
+  command line inputs. When the script is run in the WorkflowMAE Python Script
+  component, inputs will be passed as a JSON file. The main observable
+  differences between command line vs JSON inputs is that the JSON inputs
+  raises different exceptions and the type of unknown inputs does not need
+  to be explicitly specified.
+
   Using this class is highly recommended for scripts intended to be
   embedded in workflows.
 
   Parameters
   ----------
   description : str
     A description of the script.
@@ -305,29 +331,36 @@
   ...   try:
   ...     parser.set_output(name, parser.unknown_attribute(name, float))
   >>>   except ValueError:
   ...     # The attribute was not numeric, skip it.
   ...     continue
 
   """
+  _input_argument: typing.ClassVar[str] = "workflow-input-path"
   # The argument used to set the output path.
   _output_argument: typing.ClassVar[str] = "workflow-output-path"
   # The argument used to set the items property.
   _items_argument: typing.ClassVar[str] = "workflow-attribute-items"
 
+  _minimum_json_input_version: typing.ClassVar[int] = 1
+  """The minimum JSON input version supported."""
+  _maximum_json_input_version: typing.ClassVar[int] = 1
+  """The maximum JSON input version supported."""
+
   def __init__(self, description: str="", allow_unknown_attributes: bool=False):
     # Argument parser used to parse the inputs.
     self._parser: argparse.ArgumentParser = argparse.ArgumentParser(
       description=description)
+    self._parser.add_argument(
+      f"--{self._input_argument}",
+      type=str,
+      default="")
     self._parser.add_argument(f"--{self._output_argument}",
                               type=str,
                               default="")
-    self._parser.add_argument(
-      "-o", type=str, default="",
-      help=f"Deprecated. Use --{self._output_argument} instead.")
     self._parser.add_argument(f"--{self._items_argument}",
                               type=CSVStringConnectorType.from_string,
                               default=None)
     self._parser.add_argument("--describe", action='store_true', default=False,
                               help="Outputs a description of the input and"
                               "output connectors in JSON and exits script.")
     # Contains metadata of the connectors.
@@ -363,14 +396,21 @@
 
     # If unknown attributes should be allowed.
     self.__allow_unknown_attributes: bool = allow_unknown_attributes
 
     # Dictionary of unknown attributes.
     self.__unknown_attributes: dict[str, str] = {}
 
+    # Parsed unknown attributes. This is used when inputs are provided as a
+    # JSON file.
+    self.__unknown_json_attributes: dict[str, typing.Any] = {}
+
+    self.__are_inputs_json = False
+    """If the inputs were provided as JSON."""
+
   def declare_input_connector(
     self,
     name: str,
     input_type: type[ConnectorType] | type,
     default: typing.Any=None,
     connector_name: str | None=None,
     description: str="",
@@ -642,16 +682,47 @@
       accepted if this parameter is not specified.
 
     Raises
     ------
     SystemExit
       If the value passed to a connector is not compatible with the type
       specified when declare_argument was called for that connector.
+      This is not raised in WorkflowMAE.
     SystemExit
       If an unknown argument appears.
+      This is not raised in WorkflowMAE.
+    MalformedInputError
+      If the input is provided as a JSON file and the JSON is malformed.
+      This only applies to WorkflowMAE.
+    InputDimensionMismatchError
+      If a single value is provided for a list input, or a list value is
+      provided for a singular input.
+      This only applies to WorkflowMAE.
+    InputTypeError
+      If an input has the wrong type.
+      This only applies to WorkflowMAE.
+    MissingInputError
+      If an input is missing.
+      This only applies to WorkflowMAE.
+    UnknownInputError
+      If this object was constructed with allow_unknown_attributes=False
+      (The default) and there is an input which doesn't correspond to a
+      declared input port.
+      This only applies to WorkflowMAE.
+    UnsupportedInputTypeError
+      If an input contains a type which cannot be converted to a Python type,
+      potentially due to the SDK being too old to support that input.
+      This only applies to WorkflowMAE.
+    InputFormatTooNewError
+      If the input format is too new for this class to parse. A newer version
+      of the SDK is required to parse it.
+      This only applies to WorkflowMAE.
+    InputCannotBeNoneError
+      If an input which does not support null values has a null value.
+      This only applies to WorkflowMAE.
 
     Warnings
     --------
     When you click the "Generate Connectors" button in the workflow component,
     the Python Script will be executed until this function is called (And
     thus to completion if this is never called). You should make sure
     that no code which has side effects is called before calling this function.
@@ -669,40 +740,45 @@
     """
     args = None
     if arguments is None:
       args = sys.argv[1:]
     else:
       args = arguments
 
+    known_args = None
+    unknown_args = None
     if self.__allow_unknown_attributes:
-      self._known_args, unknown_args = self._parser.parse_known_args(args)
-      self.__parse_unknown_args(unknown_args)
+      known_args, unknown_args = self._parser.parse_known_args(args)
     else:
-      self._known_args = self._parser.parse_args(args)
-
-    if self._known_args.o != "":
-      # :TODO: SDK-652: Remove the -o argument entirely.
-      raise RuntimeError(
-        f"The '-o' option is deprecated. Use --{self._output_argument} "
-        "instead. If you are seeing this message in a workflow update your "
-        "Extend Plugins to the newest version.")
+      known_args = self._parser.parse_args(args)
 
-    self._output_path = self._known_args.workflow_output_path
+    self._output_path = known_args.workflow_output_path
 
-    if self._known_args.describe:
+    if known_args.describe:
       if self._output_path:
         with open(self._output_path, "w", encoding="utf-8") as json_file:
           self.describe_connectors(json_file)
       else:
         description = io.StringIO()
         self.describe_connectors(description)
         print(description.getvalue())
 
       sys.exit(0)
 
+    input_path = known_args.workflow_input_path
+    if input_path:
+      self.__are_inputs_json = True
+      # Arguments are provided as a JSON file.
+      self._known_args = self._parse_args_from_json(input_path)
+    else:
+      # Arguments are provided as command line arguments.
+      self._known_args = known_args
+      if unknown_args is not None:
+        self.__parse_unknown_args(unknown_args)
+
   def __getitem__(self, name: str) -> typing.Any:
     if not isinstance(name, str):
       raise TypeError(default_type_error_message("name", name, str))
 
     return self.get_input(name)
 
   def get_input(self, name: str) -> typing.Any:
@@ -758,20 +834,20 @@
     return tuple(self.__unknown_attributes.keys())
 
   @typing.overload
   def unknown_attribute(self, name: str, dtype: type[T]) -> T:
     ...
 
   @typing.overload
-  def unknown_attribute(self, name: str) -> str:
+  def unknown_attribute(self, name: str) -> typing.Any:
     ...
 
   def unknown_attribute(self,
       name: str,
-      dtype: type[T]=str # type: ignore
+      dtype: type[T] | None=None # type: ignore
       # Type checking fails on the above line due to a bug in mypy.
       # https://github.com/python/mypy/issues/3737
       ) -> T:
     """Read the value of an unknown attribute.
 
     Unknown attributes are input attributes of the workflow component which do
     not correspond to any of the declared input connectors.
@@ -783,14 +859,18 @@
     Parameters
     ----------
     name
       The name of the attribute.
     dtype
       The expected Python type of the attribute (e.g. int). This
       is str by default.
+      When running in Workflows, this is str by default.
+      When running in WorkflowMAE, the type will be automatically derived
+      from the workflow. This argument should not need to be specified.
+      In WorkflowMAE, this only supports simple types (e.g. int).
 
     Returns
     -------
     dtype
       The value of the unknown attribute converted to the specified type.
 
     Raises
@@ -805,20 +885,58 @@
     Notes
     -----
     New in version 1.4.
     """
     if not self._has_parsed_args:
       raise RuntimeError(
         "Cannot access unknown attributes before parsing arguments.")
+    if self.__are_inputs_json:
+      # Hack to get Point3D inputs working with unknown args.
+      if dtype == Point3DConnectorType:
+        dtype = np.ndarray
+      return self.__unknown_input_json(name, dtype)
+    if dtype is None:
+      dtype = str # type: ignore
+    return self.__unknown_input_command_line(name, dtype) # type: ignore
+
+  def __unknown_input_command_line(
+      self,
+      name: str,
+      dtype: type[T]
+  ) -> T:
+    """Return unknown inputs which came from the command line.
+
+    The input arrives as a string with no type information, so this is reliant
+    on the caller providing the type so that the input can be parsed.
+    """
     if name in self.__unknown_attributes:
       converter = _python_to_connector_type(dtype)
       return converter.from_string(self.__unknown_attributes[name])
     # The absence of a boolean value is considered "False".
     if dtype in (bool, BooleanConnectorType):
-      return False
+      return False # type: ignore
+    raise KeyError(f"No attribute with name: '{name}'")
+
+  def __unknown_input_json(
+      self,
+      name: str,
+      dtype: type[T] | None
+  ) -> T:
+    """Return unknown inputs which came from a JSON file.
+
+    These inputs are sent with type information, so the data type is optional.
+    Specifying it will result in attempting to convert to the specified dtype.
+    """
+    if name in self.__unknown_json_attributes:
+      value = self.__unknown_json_attributes[name]
+      if dtype is None:
+        return value
+      if isinstance(value, dtype):
+        return value
+      return dtype(value)
     raise KeyError(f"No attribute with name: '{name}'")
 
   def set_output(self, name: str, value: typing.Any):
     """Sets the value to be written to an output.
 
     This should be called once for each declared output connector. Failing
     to do so will cause the workflow to halt.
@@ -990,14 +1108,17 @@
       The stream to write the description to.
 
     """
     description: _WorkflowDescription = {
       "Description" : self.description,
       "InputConnectors" : [],
       "OutputConnectors" : [],
+      "SupportsCommandLineArguments" : True,
+      "MinimumJsonInputVersion" : self._minimum_json_input_version,
+      "MaximumJsonInputVersion" : self._maximum_json_input_version,
     }
     for value in self._input_connectors.values():
       description["InputConnectors"].append(value.to_dict())
     for value in self._output_connectors.values():
       description["OutputConnectors"].append(value.to_dict())
     if self.__allow_unknown_attributes:
       description["AllowUnknownAttributes"] = True
@@ -1062,14 +1183,141 @@
       self.__attribute_items = list(value)
 
   @property
   def _has_parsed_args(self):
     """If the parse_arguments() function has been called."""
     return self._known_args is not None
 
+  def _parse_args_from_json(self, json_path: str
+                            ) -> argparse.Namespace:
+    """Parse arguments from a JSON input file.
+
+    Parameters
+    ----------
+    json_path
+      JSON read from the file.
+
+    Returns
+    -------
+    Namespace
+      Namespace similar to what would be returned by argparse if the arguments
+      had been provided via the command line.
+    """
+    with open(json_path, "r", encoding="utf-8") as input_file:
+      workflow_inputs: WorkflowInputs = json.load(input_file)
+    known_arguments: dict[str, typing.Any] = {}
+    try:
+      self._check_input_version_supported(workflow_inputs)
+
+      expected_inputs: dict[str, tuple[SupportedTypeNames, Dimensionality]] = {
+        name : (
+          connector.arg_type.json_type_string(),
+          connector.arg_type.json_dimensionality()
+        ) for name, connector in self._input_connectors.items()
+      } # type: ignore
+      for workflow_input in workflow_inputs["inputs"]:
+        is_known_input = True
+        name = workflow_input["name"]
+        data_type = workflow_input["dataType"]
+        actual_type_name = data_type["typeName"]
+
+        # Ensure that the input is the correct type.
+        if not self._is_known_input(workflow_input, expected_inputs):
+          if not self.__allow_unknown_attributes:
+            raise UnknownInputError(name)
+          is_known_input = False
+
+        parsed_input = parse_input(workflow_input)
+        # :HACK: 2023-10-26 WorkflowSelection is implicitly a list due to the
+        # original workflows system always considering selections to be a
+        # list.
+        # The parse_input() function doesn't support a list of values
+        # becoming a single output, so need to manually construct the
+        # WorkflowSelection to ensure the behaviour is consistent with
+        # command line arguments.
+        if actual_type_name == "DataEngineObject":
+          parsed_input = WorkflowSelection.from_string_list(parsed_input)
+
+        if is_known_input:
+          known_arguments[name] = parsed_input
+        else:
+          self.__unknown_json_attributes[name] = parsed_input
+
+      missing_arguments = set(
+        expected_inputs.keys()).difference(
+          known_arguments.keys())
+      if len(missing_arguments) != 0:
+        raise MissingInputError(missing_arguments)
+      return argparse.Namespace(**known_arguments)
+    except KeyError as error:
+      raise MalformedInputError(
+        "The inputs to the script could not be read. A field was missing."
+        ) from error
+
+  def _check_input_version_supported(self, workflow_inputs: WorkflowInputs):
+    """Raise an error if the input version is not supported.
+
+    Raises
+    ------
+    InputFormatNotSupportedError
+      If the input's version is below the minimum supported version or above
+      the maximum supported version.
+    """
+    version = workflow_inputs["version"]
+
+    if (version < self._minimum_json_input_version
+        or version > self._maximum_json_input_version):
+      raise InputFormatNotSupportedError(
+        version,
+        self._maximum_json_input_version,
+        self._minimum_json_input_version
+      )
+
+  def _is_known_input(
+      self,
+      workflow_input: WorkflowInput,
+      expected_inputs: dict[str, tuple[SupportedTypeNames, Dimensionality]]
+    ) -> bool:
+    """True if the input corresponds to an input port, False otherwise.
+
+    This also checks if the input's type matches the type of the input port.
+
+    Parameters
+    ----------
+    workflow_input
+      The input to check if it corresponds to an input port.
+    expected_inputs
+      Dictionary mapping the names of expected ports to a tuple containing
+      the type name and dimensionality of those ports.
+
+    Raises
+    ------
+    InputTypeError
+      If the input corresponds to an input port and the type of the input
+      does not match the type of the input port.
+    """
+    name = workflow_input["name"]
+    actual_type = workflow_input["dataType"]
+    actual_type_name = actual_type["typeName"]
+    actual_dimensionality = actual_type["dimensionality"]
+    expected_type, expected_dimensionality = expected_inputs.get(
+      name, (None, None))
+    if None not in (expected_type, expected_dimensionality):
+      # A blank type name indicates the Any type.
+      if (expected_type != ""
+          and (actual_type_name, actual_dimensionality)
+          != (expected_type, expected_dimensionality)):
+        raise InputTypeError(
+          name,
+          expected_type_name=f"{expected_type} ({expected_dimensionality})",
+          actual_type_name=f"{actual_type_name} ({actual_dimensionality})"
+        )
+      return True
+    return False
+
   def __register_exit_function(self):
     """Registers flush output to run when the process exits.
 
     This ensures the user does not need to explicitly call
     flush_output. This function will only register the exit function once
     even if it is called multiple times.
```

## mapteksdk/workflows/workflow_selection.py

```diff
@@ -149,18 +149,47 @@
     self.__ids: list[ObjectID[DataObject]] | None = None
 
   @classmethod
   def type_string(cls) -> str:
     return "DataEngineObject"
 
   @classmethod
+  def json_dimensionality(cls) -> str:
+    return "List"
+
+  @classmethod
   def from_string(cls, string_value: str) -> WorkflowSelection:
     return WorkflowSelection(string_value)
 
   @classmethod
+  def from_string_list(
+      cls, selection: typing.Sequence[str]) -> WorkflowSelection:
+    """Create a workflow selection from a sequence of paths.
+
+    Parameters
+    ----------
+    selection
+      Sequence of paths to include in the selection.
+
+    Returns
+    -------
+    WorkflowSelection
+      Selection objects containing the sequence of paths.
+
+    Notes
+    -----
+    This does not require for the script to be connected to an application
+    to be called.
+    """
+    result = cls("")
+    # pylint: disable=unused-private-member
+    result.__selection = list(selection)
+    return result
+
+  @classmethod
   def to_json(cls, value: str | typing.Iterable) -> list[str]:
     # If passed a string, use it as the selection.
     if isinstance(value, str):
       return [value]
     # If not given an iterable, insert it into a list.
     if not isinstance(value, typing.Iterable):
       value = [value]
```

## Comparing `mapteksdk-1.6.dist-info/METADATA` & `mapteksdk-1.7.dist-info/METADATA`

 * *Files 1% similar despite different names*

```diff
@@ -1,36 +1,34 @@
 Metadata-Version: 2.1
 Name: mapteksdk
-Version: 1.6
+Version: 1.7
 Summary: Python SDK for MDF-based Maptek products.
 Author-email: Maptek <support@maptek.com.au>
 License: Maptek End User Licence Agreement
 Project-URL: Homepage, https://www.maptek.com
 Project-URL: Documentation, https://help.maptek.com/mapteksdk/
 Project-URL: Support, https://www.maptek.com/support/index.html
 Classifier: Development Status :: 4 - Beta
 Classifier: Operating System :: Microsoft :: Windows
 Classifier: License :: Other/Proprietary License
-Classifier: Programming Language :: Python :: 3.7
-Classifier: Programming Language :: Python :: 3.8
 Classifier: Programming Language :: Python :: 3.9
 Classifier: Programming Language :: Python :: 3.10
 Classifier: Programming Language :: Python :: 3.11
 Classifier: Programming Language :: Python :: 3.12
 Classifier: Natural Language :: English
 Classifier: Topic :: Scientific/Engineering
 Classifier: Topic :: Scientific/Engineering :: Visualization
-Requires-Python: <3.13,>=3.7
+Requires-Python: <3.13,>=3.9
 Description-Content-Type: text/markdown
-Requires-Dist: numpy (<1.27.0,>=1.16.4)
-Requires-Dist: pandas (<2.2.0,>=1.1.0)
-Requires-Dist: psutil (<5.10.0,>=5.6.3)
-Requires-Dist: pythonnet (<3.1.0,>=2.4.0)
-Requires-Dist: pillow (<10.1.0,>=7.0.0)
-Requires-Dist: pyproj (<3.7.0,>=2.5.0)
+Requires-Dist: numpy <1.27.0,>=1.19.3
+Requires-Dist: pandas <2.3.0,>=1.1.3
+Requires-Dist: psutil <5.10.0,>=5.8.0
+Requires-Dist: pythonnet <3.1.0,>=3.0.0.post1
+Requires-Dist: pillow <10.3.0,>=8.0.0
+Requires-Dist: pyproj <3.7.0,>=3.1.0
 
 mapteksdk
 =========
 
 The mapteksdk is a Python library for working with Maptek products that use a
 shared underlying infrastructure such as PointStudio, GeologyCore, BlastLogic and
 Evolution.
```

## Comparing `mapteksdk-1.6.dist-info/RECORD` & `mapteksdk-1.7.dist-info/RECORD`

 * *Files 22% similar despite different names*

```diff
@@ -1,150 +1,176 @@
-mapteksdk/__init__.py,sha256=zG-KVO7FsRVT0rlcTxr55NDeXr0NafeQRIdoHyvFBbM,624
+mapteksdk/__init__.py,sha256=LvLBLyapZxB_xrRumLc9WpUgavpMKPyah20yot_d79U,617
 mapteksdk/context_menu.py,sha256=QPSHxFIbOn-OVEnBg0SJsqRmzRvPJNtY_8poORDMJeE,4704
 mapteksdk/geometry.py,sha256=tJbfx69FC1Tn7lfi2kr1uJ9KkxCSaPGKr7ujj0DF3Ck,6028
-mapteksdk/operations.py,sha256=AQjsl5vpyeLEsZZ9pNTilyiyXcdaC9KZR59YbGNGtmo,56176
+mapteksdk/operations.py,sha256=F_n9OZe3pvwbi991m0NYCVCHjYDD40eAjO-GydcbdSQ,57529
 mapteksdk/overwrite_modes.py,sha256=ATcAoNNJLeV8Xuzlvk8iakm-V1ZDKHnkcqCVovmaBxs,1255
-mapteksdk/view.py,sha256=qExgoVCKRR3vUnFQBWtYzTj25EieMCB8GzEaSaLCzd8,36512
+mapteksdk/view.py,sha256=Mm8ZD7qOjcrjsDCn-IFrgsPMDLaPxsjzIcBMRzZDELc,42193
 mapteksdk/capi/__init__.py,sha256=qT8_0WhPbNZG9VFvet1A3BUrL3dZOZYtGvYZcbC4fWQ,1175
-mapteksdk/capi/dataengine.py,sha256=05A4wKmvDzpURTVh8iSFDsKL-uZj9PbdB67IXDefkFI,29118
+mapteksdk/capi/dataengine.py,sha256=JrbRLg3PtGF7_fCT-lZQlAcnfKEJoOZEDYz3vXISrAo,29770
 mapteksdk/capi/drillholemodel.py,sha256=NJY5F9XsR471kC3dJF8U0eZVcTGU6uiRJVO0QwCCuC8,52807
 mapteksdk/capi/feedback.py,sha256=3_QSdzTiiwfMqwolmQ62fPzLdlblqRPGPEF_iH-0oBk,1679
-mapteksdk/capi/license.py,sha256=OlklkkB0PS3lYvcLNE1Q2Vfu_k0vtzgu1nbGGCJEkaU,4636
+mapteksdk/capi/license.py,sha256=Nr5OU_c7ncfvvZBKx2F7rfrqrsCpkdP90BCtQkeVeYU,6744
 mapteksdk/capi/mcp.py,sha256=aIHRyybs-GR9lieX7d-rrUG0ytw3QQccAPUYgT3zv8o,6458
 mapteksdk/capi/modelling.py,sha256=_2IkMQVlwDyyVia3kpIO4q18OXqgfujGeqo9Zysma70,121047
 mapteksdk/capi/preference.py,sha256=oTL9sqgnRNrGBEFRd7QaKQfmcGJMmaNHdd8SdCxMAsg,2076
 mapteksdk/capi/reportwindow.py,sha256=DcIrIgMpXfDsSQoWGklT2uU-xBvYZltpqsw5cQC21Go,2111
 mapteksdk/capi/scan.py,sha256=FbJDOsPZ_if3M8rkefzO1AQnaz-CgiOFTVFiSUjz4hQ,11011
 mapteksdk/capi/sdp.py,sha256=DEMkoEWky9D12TtZOZNfIs8aSUjVTEHweQMuCJ2OEUw,3335
 mapteksdk/capi/selection.py,sha256=t03ngNc8xwh7nKZwoCrWhBVFaE9N2gDy7-pjTIt43d4,1346
 mapteksdk/capi/system.py,sha256=_J7AVZGdAqBLaw6tNGGhHwB_QdZOjuc30HgcdyFEVM4,2290
 mapteksdk/capi/topology.py,sha256=hSpKE7WcYicF-7Ct15heO2mJ5iMonztqQN1VbGKRHyk,7703
 mapteksdk/capi/translation.py,sha256=EFKWcV9Xk1BC-7obBeTJhU9hfh6E6o2-2nLrds6gxAw,4747
 mapteksdk/capi/types.py,sha256=9aL-7Ho9_3vuoCLun3eIqz51g4DZhQB5WcM9niivsa4,5355
-mapteksdk/capi/util.py,sha256=YDG4ypmGk9ZOqMt71hqjB5gQIdOkEUwJQTMXtSX98ow,15296
+mapteksdk/capi/util.py,sha256=aFsslrjqcXhZ7XiTafqh1gLQnYeOjd_Os_BKK51ggmg,13635
 mapteksdk/capi/viewer.py,sha256=FzZkY39S6Nk5ktu4mnheqQsy_t34i-0hBan_afsPcVQ,2963
 mapteksdk/capi/visualisation.py,sha256=y7w8FRsINwCplSW4TUgAcvGmOYXiDpcY5A_uLYGpbUg,8983
 mapteksdk/capi/vulcan.py,sha256=6lvAT9G7Nr1rkxN-q73Lp1rI_5CP38byr1w4DyTRs3s,1512
 mapteksdk/capi/wrapper_base.py,sha256=D7r7ePTIMUarg7YXCeIOm0H5ZI4_FbOce8Hn_ENQFEQ,11547
 mapteksdk/common/__init__.py,sha256=n_kvIdjHSBmJgA8z-Jh6agWaVNTnSp2goE-9_--D9Gs,2768
 mapteksdk/common/typing.py,sha256=OiJ09KM8SASsRs9_PRvlMSik8bm6cDsCMQQoHP--Y4A,7869
 mapteksdk/data/__init__.py,sha256=cnS6U8pkA1f-e3w7esMG1muDGkRCiZoP8jJC8uW5gtU,2000
 mapteksdk/data/annotations.py,sha256=HLefq3LdClrAjvj5PgxhvtrypYqesBwp0j_pFobspTU,36031
-mapteksdk/data/base.py,sha256=picGMbiv6IcPybaHgSO9gomCD-dTnpdUeLdqRac6gLg,64452
+mapteksdk/data/base.py,sha256=MYIgeEI7Oo_YG9vjtg-38mgUp0AeDZPkwkt1QsHqFak,64039
 mapteksdk/data/blocks.py,sha256=92dDcri-HZ0bf7qz31j2cn1bY-WvYpHYTqcYBsB58Cc,38749
 mapteksdk/data/cells.py,sha256=qbR6pnPEKbZEiyrHxcCkzA-1R74nSxTzt2w3AKC776Q,21667
 mapteksdk/data/change_reasons.py,sha256=c6J_UgizqvrTw1nRqtcbbJlF3ovW5thdTSz0djnMCq4,4990
 mapteksdk/data/colourmaps.py,sha256=7C5sz751BoWScKE-maGwNKhUskfv5CRdg4fkAFMTS0k,39993
 mapteksdk/data/containers.py,sha256=-9viVfzSQ5mE_5ie4t7xQD1CCflgDSaox8KzRRSytQ4,35213
 mapteksdk/data/coordinate_systems.py,sha256=Vz8DajMmopsSS98j-CLEBSJXu4Moy9D_cbPxjuj8kzU,12020
 mapteksdk/data/edges.py,sha256=0-4AtzYEQ5aG1PU-azjRvwA8pjP37szVfx3woOLaXxo,14132
 mapteksdk/data/ellipsoid.py,sha256=HRcJ_PuIvFr8CSJitZry-mzQAwPNuv-RXexagO7LB3Q,6239
 mapteksdk/data/errors.py,sha256=NNCtBihP9iLDnUBg8T-m86-8wTO9AFqGNxd32gf1Bx4,2687
 mapteksdk/data/facets.py,sha256=GLCRKfqnk8fldiJhGITtt44SzQvx8mDyEgXXBg_48SU,13404
-mapteksdk/data/filled_polygon.py,sha256=xGGhAQXRs69rM23EU3u-u4-pFJYRcX-x9ZY-tM1WzRE,35833
+mapteksdk/data/filled_polygon.py,sha256=UaE80SRBHUUlcx87_Z-c4Yp8X79CW-6tK46ZUShlbJ8,35899
 mapteksdk/data/geotechnical.py,sha256=O9PLJAYO6xewve178ymLjnpuLgcmFuHpMgRaXPR5jrY,21286
 mapteksdk/data/image_registration.py,sha256=EjjsKDu7c_B2ttbY5Du3cfDKkN_VaHhhVpqp_tM6EOE,23064
 mapteksdk/data/image_registration_interface.py,sha256=oHPuYYJEF-ABAkLwBm0u4A8XcXExsYwpkMsQPzz5BiQ,4424
 mapteksdk/data/images.py,sha256=hoWkHfXAHflvzRjDAiKWpruO3iiRE3fEgozwCiUsKcE,22187
 mapteksdk/data/io.py,sha256=aH4alW5bLnmSp7_eDbc2vYkLKhhuEPKxZrZDLkqMT8M,10081
-mapteksdk/data/objectid.py,sha256=YX08RhVjCLBY0hdn0252-KTcln6kZMwp8xiujdXWmWg,20056
-mapteksdk/data/points.py,sha256=rXU-ey7ztiQ7xSHQuz6BDYL8gSzv93okLJ4h9u7NUnQ,15339
+mapteksdk/data/objectid.py,sha256=E45Oyp5dY2stpMX_3xDPb3fGmzQq_TprbJVpwhCTGKY,19903
+mapteksdk/data/points.py,sha256=_TI6u1t8ter1G6TYYSthb2X1FLivjjSbJbMULpCVN0U,15096
 mapteksdk/data/primitive_type.py,sha256=d6XzXWECuGDYUTUo125ZbuDuqMeWJTn2mV-bcPJQ9mc,1069
 mapteksdk/data/ribbons.py,sha256=3rxeKWbayE6lw758L6cyb0HFwvfpGkYmc8i0v993KEw,14383
 mapteksdk/data/rotation.py,sha256=WkJWRkIsLFbAZmX6bko4m26l-54ZCj81pD1vByJrBx4,10533
 mapteksdk/data/scans.py,sha256=G28FrAaJeHAb7hlCMSHWA-r_-MvpvpM8v8WP_reO0ZQ,58052
 mapteksdk/data/units.py,sha256=Cu5ProtZbfTSfYVR8nmcO52vri9N8daR81q92qe5CMY,9343
 mapteksdk/data/primitives/__init__.py,sha256=Uw5XmqwQRA-e1FI9QXDOgOIZOd0e1eqHQ6wg8NMIHhg,771
 mapteksdk/data/primitives/attribute_key.py,sha256=QHZLNLEhkvhpnQedAVkO3wuM85nEh3lW2IVwgSBwX28,13600
 mapteksdk/data/primitives/block_properties.py,sha256=c2IWPI4A2PNNTENHAPktK3EolKWUtkS11JyBhotaXj0,31898
 mapteksdk/data/primitives/cell_properties.py,sha256=Mo-pq-tHgJbxKMWIganwgzKh-dhZDxJ9dltceFM0jvg,12630
 mapteksdk/data/primitives/edge_properties.py,sha256=l0pLSCyHzE2drq96lYAeyjqbEd4a_zTQcCYtlmt_eq8,11187
 mapteksdk/data/primitives/facet_properties.py,sha256=o8TkCCYyRPW3JxR3mFCde_DfDY3G_H4sHiLR51Pgw7I,14345
 mapteksdk/data/primitives/point_properties.py,sha256=EHW_KqDhTi0ODKJd5um3-igJSEQNFB2Cc6kZ2Ikurvw,26201
 mapteksdk/data/primitives/primitive_attributes.py,sha256=-1EUn2JEDXs6ehsGdcu02MAt61k4_0inJrDve71nusk,35742
-mapteksdk/geologycore/__init__.py,sha256=Ofs58zZM2l2fimxkj8jWMYgl9GAZEG82OFl4wM6HC38,1156
-mapteksdk/geologycore/database.py,sha256=DHpjWg83-eUZqiA09RZ-xyjIb9IDdITf45kIJSUnh4M,23637
+mapteksdk/geologycore/__init__.py,sha256=5yi2IlCAAzyrwEXovVC-cVty1vo9dTJnYPCBvX_-TeM,1167
+mapteksdk/geologycore/database.py,sha256=u_23ppFniDjhXAZxkcaG-WyeXCAz7mcc9-6buUSlkaw,23783
 mapteksdk/geologycore/desurvey_method.py,sha256=yalxlFm2zOnQhXtWoVQII4IwTjlq39qoafvjWhRmYrA,3438
 mapteksdk/geologycore/drillholes.py,sha256=IBH8kptBIqnSHpVWbhM7RrAaGb2jln4GqezTdv5KgZw,27288
-mapteksdk/geologycore/errors.py,sha256=gjXyQNSUJ0bq_bSHNn301azj8bKxeL7-ZmbhiealPLE,12021
+mapteksdk/geologycore/errors.py,sha256=lMlj7HQ0jQLfugxM8uQYCin1tToJIbvrfspSNFmrYKY,12387
 mapteksdk/geologycore/fields.py,sha256=SvgWTTBPC9BOBFLLx9WFc24-VUyoR1XJ0qKP1DCDtRw,27367
-mapteksdk/geologycore/operations.py,sha256=4hKZKyyCRLBeabI9yj7ZtJ11Ik4ZC998YONZ-YmYsss,13584
-mapteksdk/geologycore/tables.py,sha256=2Ocb-2vULMetUKaCm8DM1k_jsja6FFuKhjPKD9TySf4,61557
+mapteksdk/geologycore/operations.py,sha256=ItOIECkX0am46om97mqvVT3rVXbgLZMuchBlYVsvX84,13620
+mapteksdk/geologycore/tables.py,sha256=tGvb3CkgiEG93k3RRKHIGD4XeJ3AIt4ajL4SCDZnkYU,61322
 mapteksdk/geologycore/internal/__init__.py,sha256=bTZS9mSmJOudvU0WntGFc9zeJGx698UMLi7VhJd8dxM,410
 mapteksdk/geologycore/internal/constants.py,sha256=K5NsSA2mko3TxWZwap8wJcA3pR8kLrsE1HNfUtgrDHk,1922
 mapteksdk/geologycore/internal/tables_mixin.py,sha256=mQdopA5c2KKpvWKvYuM77NSrutDWpsNdB28Kilfsz8g,11722
-mapteksdk/internal/Logging.dll,sha256=GQkSj1ZveKWfgHb2yt4YdeXVcgNatbVxpErHxiwC0hI,20992
-mapteksdk/internal/LoggingInterface.dll,sha256=4lr0rBX7W1BZiY07CW8sj-j4977k2mejUGZZY0PWQic,16384
-mapteksdk/internal/MaptekAccountBrokerConnector.dll,sha256=LE4KjNDq2fD-dLnfQplwPk5g4hcwrSQaFBvn30PT81s,98304
-mapteksdk/internal/MaptekAccountBrokerInterfaces.dll,sha256=Z_qoIZhHxql3-b33S3WGrkqH0uVfCNrVBePlEcfTXMc,40448
-mapteksdk/internal/MaptekAccountBrokerServiceInterfaces.dll,sha256=LSFkWBGOmbTdYsGcVR6nN4ALLztm7uebOy8qEWUZsm8,27136
-mapteksdk/internal/MaptekBindingSupport.dll,sha256=0TnIthx1SJIjVLp7tTNuCG_rl02Zj4U9UwqGUIld4C0,83968
-mapteksdk/internal/MaptekWCFSupport.dll,sha256=u8e18PsXHyTc2-kPwlrtRsKwVqjKLqdYOMouj2y_6vg,11776
-mapteksdk/internal/NotificationInterface.dll,sha256=lGh7uS_Erd2RvCNCevNY3UXa9VJfPfy00o0V_sgHjmw,8192
-mapteksdk/internal/ResourceManagement.dll,sha256=2smAi_s1VcecvCNkDR3tdsB9QWTwS8v7JOCLRIq_JvM,5632
+mapteksdk/internal/AssemblySupport.dll,sha256=nnpYkp1VqSq5LIV9ZscLeQILtk0gmgQ5b6YHZnkeJ4w,8704
+mapteksdk/internal/BrokerConnector.dll,sha256=CSdxvCHh6eBoaOyS6bRd0jqXyO7SIgIPDkZXs-8LhSY,16896
+mapteksdk/internal/DotNetSupport.dll,sha256=Se6sWaeO3lCEk0CUYhevsyDW_j5x9yNnIYqaO_e8gD0,22528
+mapteksdk/internal/ExceptionSupport.dll,sha256=5i8Lk1UEZeXZbq7cuUk7gycXaYPtuhE0xiF9X8s9F8U,7168
+mapteksdk/internal/FileSupport.dll,sha256=nqP4__aqubBp6KsNQL_obU3Q7t-iBh7F1SV6Kwfb6JQ,32256
+mapteksdk/internal/LoggingInterface.dll,sha256=H4cX7AYLpX8MciNEl7qGC8xN-ZoaUH_-_8-thQU2ozo,18944
+mapteksdk/internal/MaptekAccountBrokerConnector.dll,sha256=vxTvtcHPiwmIpJ_brPdYvueS2-o6HoZBK2ycjuc0ZrI,112128
+mapteksdk/internal/MaptekAccountBrokerInterfaces.dll,sha256=7pqq3B50ZqjVJemvrnBnlhVnrdr9kk43tqoXFKIccDA,53760
+mapteksdk/internal/MaptekAccountBrokerServiceInterfaces.dll,sha256=X0M7B8to-5MgmKH9PXU5r2Mc6jaZxdJfN5qwXkSEBxQ,31744
+mapteksdk/internal/MaptekBindingSupport.dll,sha256=NRtMGQhL2EQcnKEkJ8PjxFDd-3CQHIFbtaskOZvprqM,104448
+mapteksdk/internal/MaptekTelemetry.dll,sha256=KZKX7blglRu6rwbcK1dT9Y6-q86oPRHx1qodhSauLP8,42496
+mapteksdk/internal/MaptekWCFSupport.dll,sha256=y67KSWbLMUARgCls6rzOGPacvzSPbbf9abUHkJ63Gk8,17920
+mapteksdk/internal/NotificationInterface.dll,sha256=rMLNIUPFHJg46dBkW-79g75Kv995WqXBvIhyMUEJu2U,8192
+mapteksdk/internal/ProcessManagement.dll,sha256=tzIJu0p3JhehePK1pIYE71vZpBMANNz8w5ZMLFZjExE,13824
+mapteksdk/internal/ResourceManagement.dll,sha256=K6hZNkaYeipptzozKdGa3wGp-KY4rRPoQ1WxgwyRpF8,5632
 mapteksdk/internal/__init__.py,sha256=qQeJaDRkWqSDvgmpgH-CCFvSovrsW5F6UyN3UXtvqBk,449
-mapteksdk/internal/account.py,sha256=2m3RbXuSTy8piFu3x-GvEmztwNdemHM5wgNkSqkS3JE,8533
-mapteksdk/internal/backends.py,sha256=MPNwwWQHbd7XKzVCWsy412kDu_69KExUDozmIZfLjD0,17689
+mapteksdk/internal/account.py,sha256=3lEFn89O_wA49X3WX9P5lPOybbY1DC0ONQ8bKs2UYrw,9058
+mapteksdk/internal/backends.py,sha256=YK7t6hwZF_-_wdR3hGlzhj6hdkKKIaYrm5beWaSfTIo,27142
 mapteksdk/internal/before_undo_state.py,sha256=VgWujf9vPnB6gj2JCobVMGQYcEv_sIRjykNi_b7rAek,1786
 mapteksdk/internal/classproperty.py,sha256=Et4oei35u-kcnNtWZzqa46xTykZGC-O4-RGbeEWZIQQ,1876
-mapteksdk/internal/colour_map_information.py,sha256=5ZHixqkvVYN33vMXVzrydxB2MCvukJvy2n9BmAVhr-Q,3624
-mapteksdk/internal/comms.py,sha256=OlZoUCXS7o15LEk1HatrDyT50KVxevj_-leC71Qe4i4,31139
-mapteksdk/internal/compound_transaction_data.py,sha256=nidtUG2JgLw0Tjl0k5cBg1A_KwH8X63vBRxuEe_vy7I,3218
+mapteksdk/internal/colour_map_information.py,sha256=qpKgwHcTfE6yO-VQ6iJkZhRwqRJ4lDej2wulw9Ae2-8,3528
 mapteksdk/internal/data_property.py,sha256=oovd-RLVx4zYjz4cp9GaNPdlO2BPZbzQUzWANWUi134,19058
 mapteksdk/internal/data_property_interface.py,sha256=0YDWxplr9D9AbgNc8WBwi1k7OHrWY8bWrvoWAx4-K4c,3951
 mapteksdk/internal/lock.py,sha256=7NslmebhNuaCMCEsk2qOr3Om6LHustiMy1le5z6D7z0,3797
-mapteksdk/internal/logger.py,sha256=zJbzw_GmNzlnmX_F67GE01O1M3VIxcKMr-8q5H1GJyw,3375
+mapteksdk/internal/logger.py,sha256=K8YuwiNN6-eDOmZzQirMlsNy_7vAsh80tC8RKKQ-pGk,5758
 mapteksdk/internal/mapping_view.py,sha256=UP8YD_lmz1icTubezWvrD5L0ZydJYQaEQ2hzRLrP7dw,2364
-mapteksdk/internal/mcp.py,sha256=uu02Pm4RxTJEoVOlzQiB6U3jve2H2wfx7TbKuBM14ec,16819
-mapteksdk/internal/normalise_selection.py,sha256=eokI6Oao0qohjJrEj9vkThZ9Re0W8Y6i57_ZwLGU3CE,3440
-mapteksdk/internal/options.py,sha256=MyDvf7VxZ-T21fM8X2jA7AD7mLDGpnrHnxEqwRW9UvA,3291
+mapteksdk/internal/mcp.py,sha256=aSgkC6W0e0ru_zpWlmmUJ_B7-Lvh3_WClLx-pWI83ic,18150
+mapteksdk/internal/normalise_selection.py,sha256=q9PW21RouVuCJvZxKU4P6KmxZV8vXKPJX7V07MhmHXI,3452
+mapteksdk/internal/options.py,sha256=C1nbN2aUDAb-VdyHQNqzc6ljVU4-lpkGA5Rx7wtJxyQ,3631
 mapteksdk/internal/overwrite.py,sha256=OnRc7UNjqxnvrd1fQ5dbP1DUO6P37Sw74kbVErfQGn4,3995
 mapteksdk/internal/path_helpers.py,sha256=xsOvooDXVCk8HLrEOzypUzl7nH8ujrQU3W3gM6UMdL4,3110
-mapteksdk/internal/qualifiers.py,sha256=7jGgRT4sAKTnGIHT72IFS3vd2Id5d7hgekG49ngz8vo,12642
+mapteksdk/internal/project.py,sha256=vCD2q-MhHrqoulEfmqeYPTjbQCqswv0phJpr3u7Psok,5877
+mapteksdk/internal/protocol.py,sha256=EYupO99yr3qmS2MKSMsiaWoyZ-5KspMGmvSy83O1b8c,600
+mapteksdk/internal/qualifiers.py,sha256=HcAzT3EmWYriNH-kPxxumQQrXE6m2Y2Y6f7zCxZg5X0,14534
 mapteksdk/internal/rotation.py,sha256=k4uhdh3qtpueWtjipwaOYm2eF_BD0jKG8im0VKx4QVY,16315
-mapteksdk/internal/serialisation.py,sha256=ZuNhGq1FSF8B2L7K8j7J4a5q3R1Ml64-GpJiZn3qMbU,5872
+mapteksdk/internal/serialisation.py,sha256=xTsMK8pdHJ06Oo2h-oEru5AUUiMmtTLfaVTbi6e9Jrk,6868
+mapteksdk/internal/serialised_text.py,sha256=1vEt_DSAqqL9tsO7d7oDli3VUUZ1hH4Ts7NNZRZzdtg,4303
 mapteksdk/internal/shared_operations.py,sha256=1XRiMKaX9Y0T2AT4_b3oShHxAWA4HlA31f4w0lzhFhg,4620
 mapteksdk/internal/singular_data_property_read_only.py,sha256=95IM44PyJdqe3rgyCHAeP1jWtMFYhGES2TEdbrwGeAg,3098
 mapteksdk/internal/singular_data_property_read_write.py,sha256=Vae9KopIAhwKAY-czEvlnlDvXFZX1eA2M4rXW5iZ4PU,2627
 mapteksdk/internal/string_data_property.py,sha256=VsQtybjyWZ67cnjf3QwfCinpZ9XORThwbKej8FH8vas,9765
-mapteksdk/internal/transaction.py,sha256=-yZu_WDVEuRtHHxBoI7CP0ascVOgmCVJqHomhacJKBY,12639
-mapteksdk/internal/transaction_data.py,sha256=FTU-vywCosinOcH2uGotL8d_75njOa6sC-e4YbDE1pA,8432
-mapteksdk/internal/transaction_manager.py,sha256=jqyGzR-ONvNl0AJtLj0NQWOqYGdZolP0rqoV0v1mJBc,25429
-mapteksdk/internal/transaction_request_data.py,sha256=KgAEul3DXWzJIljqIXF1iLVR8ch3bJOVMu7_SDTpamc,1454
+mapteksdk/internal/transaction.py,sha256=thbBOjEP_CChwGSI1IPtikKAjz6O49PJ9Qsfgdz4-qc,12401
+mapteksdk/internal/transaction_base.py,sha256=sVwQaGWTSyHRAAnQoBUH3_7aPi6xNUeLSj4-CEkVY6M,18057
+mapteksdk/internal/transaction_compound.py,sha256=2r9IujevmLZUYrY_FT1iZsFYlvElooyPsVPH0a3SZCU,8976
+mapteksdk/internal/transaction_elemental.py,sha256=tdtQbUj7LAV48kw3xoWYqRPToNyYj4S93E6JFeRSbCU,16989
+mapteksdk/internal/transaction_errors.py,sha256=4Itnxqq74Jp7wzH1vfaafkELnY5zkAJAO-DPlb2viuE,1915
+mapteksdk/internal/transaction_manager.py,sha256=8JYPvxQESIjGZxdHbWgaigqY-ZaJi9af__4M-mtPsk8,6724
+mapteksdk/internal/transaction_messages.py,sha256=npQAyi-uR5oMfsRxoj5kgxbndpI2x-WMqYZvG0Sc7VU,7498
+mapteksdk/internal/transaction_mixins.py,sha256=DrMJzZlozSO91R9Xe1ip7GqpRT4yW0uyLT0bSWcbPBA,9964
+mapteksdk/internal/transaction_request_data.py,sha256=Ib8lxanzkG5KiAkhLRHpu-vaEh5xEFACR6_l-tCo3tE,1757
+mapteksdk/internal/transaction_state.py,sha256=PawuuVvYL872WlQmsfqjzES3_p_bqW1oKZu0wWpY2zI,1015
 mapteksdk/internal/two_sided_colouring_mixin.py,sha256=okpPi_KjhqhBI1dqyEoBn0XGrtDImHKQy7Gj-t44D0o,8143
-mapteksdk/internal/undo.py,sha256=poTv8Tt1i_yizcY_4UxhjLgWOhUK7SlN_BOc0J6e6AY,5725
+mapteksdk/internal/undo.py,sha256=uqnvBu2v50p_DGDgKYVbFPAoerdM_gAtFxVFVtxOWy0,5823
 mapteksdk/internal/util.py,sha256=SSVEudCJefUBzwh7tPt5fzP33yoXsnDFz5GE8m-4Wf8,8111
 mapteksdk/internal/view_data_property.py,sha256=sF5i4QFxjroErigXzjIjVRd7yiJaaZFuDMvnUO7bTWA,3845
-mapteksdk/internal/writable_selection.py,sha256=xaHKEghOwTshP6723_DxeNpWwIJ67dU83Cjo_yIE4Eo,3348
+mapteksdk/internal/writable_selection.py,sha256=k-PUJTTUDXptyE2Zczpq1EPUnWFQc4-_BpOJg3Ia44g,3572
+mapteksdk/internal/comms/__init__.py,sha256=cCLzNnF0CJvDbG3Cn9MAY91ZiS0hkaL4M5eJOyN4eys,935
+mapteksdk/internal/comms/base_message.py,sha256=eiX3MUJM8fKnByBUrlb09FeipZ1mj1j4p_pVekTC4FY,12397
+mapteksdk/internal/comms/default_factory.py,sha256=vS7uRaZLDFB8mM6uAxFs2kOBzIuyswhE34o3TrfzXP8,2386
+mapteksdk/internal/comms/errors.py,sha256=kJs7LBrstRxyjryG_xm9P7ZGvpDRh9gZlUSyT3ne5wA,803
+mapteksdk/internal/comms/factory_protocol.py,sha256=ghGggXGYCbwWDGoQTCCxngYnvZE928npMm4Fa0q5mbc,2296
+mapteksdk/internal/comms/inline_message.py,sha256=yoZ8doyPI4zvv7-whjMfKyripexi6g5h5Jy21Sj5Xzw,1534
+mapteksdk/internal/comms/message.py,sha256=AKL8MmuKWo9SoBWeZRIH6yuMzSOeECaZb1DkvR4oFeQ,3994
+mapteksdk/internal/comms/message_component_protocol.py,sha256=r7el6rgfaCrFX25zip-OKG1IpgbFBOaV4dhZo9fh29w,2393
+mapteksdk/internal/comms/protocols.py,sha256=5IyMbAiFWAxRE97qJiIguOcTZQHJoChbk_A1LtI_Y2o,1142
+mapteksdk/internal/comms/repeating_fields.py,sha256=PB4FKQrCOCGJKve2tyEXD7pIoyb6yV2hi7Eyrc9WlF4,3740
+mapteksdk/internal/comms/request.py,sha256=v4K7W0fTfvHYLBk4SziWZAItesvrHfasxHHioXSsvis,6618
+mapteksdk/internal/comms/sendable_message.py,sha256=5ePwC3VkshCFAfUQEpkMlwQEDr9qA6-Z4sZ-1Q-S_Xc,4599
+mapteksdk/internal/comms/sub_message.py,sha256=PHTj_sNG2jA6T248Cy-37wxPjHJnGxauyxA4JJMrrnI,1486
+mapteksdk/internal/comms/types.py,sha256=qnN5cULwRyw7D2IRCqv3Jm27uS9vQmA8_lY2buKNOQM,6246
+mapteksdk/internal/comms/_factories/__init__.py,sha256=2uUd6D2Ykl1IypEREPKwe2VPVzT55DNNVvc-rZl7n5c,2213
+mapteksdk/internal/comms/_factories/any_factory.py,sha256=73mBpeNzrVGEkFV0FGncfOpsyR234dMJD2VkARDsf2k,2673
+mapteksdk/internal/comms/_factories/compound_factory.py,sha256=K6UpBufkS_3jlbG21cA9QRDcadGBkGjb_KHhDN6eCyo,1751
+mapteksdk/internal/comms/_factories/message_component_base.py,sha256=x9L4J6Jl5_AdfNmEuNes3cMquVmcb6BSAM5YbS9Mg2M,3257
+mapteksdk/internal/comms/_factories/message_factory.py,sha256=7KXaUzu8vQUxV6_NTgUhDs8SK7w42oL4J2BjjNr6CFM,5601
+mapteksdk/internal/comms/_factories/primitive_factory.py,sha256=1J_5xRJ9TBoHyoK-mEPOKLrrkxDgLpPUynhQjdK5kBA,7907
+mapteksdk/internal/comms/_factories/repeating_field_factory.py,sha256=xpXo_xeNUS0qnm98efkP8n9JKhb88IvLcNDIBxtKjnA,2655
+mapteksdk/internal/comms/_factories/sequence_factory.py,sha256=lfFXU2PvpmFjTEmFH_xy_kFO6wbvQ3FwyYPEU9InSNE,4845
+mapteksdk/internal/comms/_factories/serialisable_factory.py,sha256=tMi0v5_ANVm3iXlPD0pI8JVE8YqJaTO7iKkjXKJ_1JE,3170
+mapteksdk/internal/comms/_factories/union_factory.py,sha256=I9Rk0z7rkulQXUmJKUQknc9LAnBTGDRQAgY9Ocl82Pk,3534
 mapteksdk/labs/__init__.py,sha256=-xjaEEGQQotCSCjAfVGDQ3sMR-QzjkxwgM2aY6wpkuM,674
 mapteksdk/labs/cells.py,sha256=g5TYxepryO_F-Vr3H4C5BDKYxYh8DDgNXW3tkYPutjI,4279
-mapteksdk/labs/view.py,sha256=vgiFwEwZGzEDf6yccvF4DJ1opMd5ilpy_J_pe08PAKs,5782
+mapteksdk/labs/view.py,sha256=A0CbTzmZLtQfK6BrWelNmbJtWouauogPW2fh-ERgM0A,5686
 mapteksdk/pointstudio/__init__.py,sha256=sKuFz_eryNyDSHPpNjui1AuHGzvcTYeXlRB5jbFeJbw,155
-mapteksdk/pointstudio/operations.py,sha256=POxGXqCt-eR6_6TPyHc4vaAUpzMfeKsYyckM90s1BM4,28130
-mapteksdk/project/__init__.py,sha256=Wr8LjF9lQw-_kITqfKHNDGhwbU8HbIhrF7KGYpQtlvI,90613
+mapteksdk/pointstudio/operations.py,sha256=397VXgK7NCLt63hXmu1mfXQTmgTZPkSW5DjqLoB9Bww,28172
+mapteksdk/project/__init__.py,sha256=8FIZtjXORJEiD_Z_nTodcmNLeMbcph_cecZHrS5Sc0c,92970
 mapteksdk/project/errors.py,sha256=cl0MBFUUWTZ-nd-bxrWMxOHfRTMl_uIDgVJDxQc_myU,2339
-mapteksdk/project/selection.py,sha256=exfHNpdEoQEW5aDsUZ5d9K7k2Fji3oaoC6fGovGrOo8,12091
+mapteksdk/project/selection.py,sha256=mMnx5eRylcm-s_0sNajZWOszDZM4zT52LLqqAWQSPgY,13910
 mapteksdk/workflows/__init__.py,sha256=QndBe4gPYOTJgbbaQ_JNQ5fKCPWFmnMohZlUexT6q7c,1081
-mapteksdk/workflows/connector_type.py,sha256=EtjzahF-mpD8WeW8EjC9YcR-KixiAzI5vP3UBDRshpM,2617
-mapteksdk/workflows/connector_types.py,sha256=K-0RUtebnwLqmGx6l6B_RzxWM7vcWMaWCJIXYXo--yY,19156
+mapteksdk/workflows/connector_type.py,sha256=NUKKW-ebqdlVIe6uoUbI5XdMYU_bpFJSNvdoSGPKzTo,3056
+mapteksdk/workflows/connector_types.py,sha256=9ZXIqi6aBDcND5hG8-FxlzXzL__v5z6B61KILAsGEv0,19301
+mapteksdk/workflows/errors.py,sha256=nvvtAyb30rSc0RqQjHKRprHmBpFpIGOvsasvl5XDShI,3389
 mapteksdk/workflows/matching.py,sha256=oqSIlJM2JvxdRggyzHha4RfVYKmIpiLOrKDjevKG7A8,3148
-mapteksdk/workflows/parser.py,sha256=Kgfa_h-oiIV4IjL5sVXduqn9LFoXYdJUoj_E0NsCoJA,43654
-mapteksdk/workflows/workflow_selection.py,sha256=dGiuo439XEzWuUOW4Vy3kIHkTRUAz6pDf3_wF9cmbX8,12129
-tests/helpers/__init__.py,sha256=lmlD_wX8VqXLNyXpj7FP6p8tkuA2VAvoSnZQOs6RWxs,257
-tests/helpers/application.py,sha256=Jaq9amjSe507Xd9lFSDrx6ABmQ5RJQTatJ7zLIggSiw,3970
-tests/helpers/assertions.py,sha256=jjcff-T7F9ZP0hdye0B3zjCcdxTPj3px86aBCaSohCs,18670
-tests/helpers/errors.py,sha256=vMENhzLYMIu3ZK_FNyUkmfZmVACJkmIuGgWmzwaW7yA,1296
-tests/helpers/fixtures.py,sha256=3hqvnOVfMXO9l8IS5cf1sIjt5Zo_IbnBeI5b8DAo5u8,12386
-tests/helpers/messages.py,sha256=e8oVtu1LvUwNQ0pDnb2InTtvFUCLdEIsU0URo77gUhk,6937
-tests/helpers/old_applications.py,sha256=_Zs7rr3byaVF723Lw2fP27DuAejsPxS1hZFSOdeBa8U,4038
-tests/helpers/project.py,sha256=yPX0_39UEkZ60IT5_q-xDB_Re3X0LWSeCI9Y7xzkFLk,8217
-tests/helpers/replay_server.py,sha256=d9pXLNbINs_jUE_JG8eYyY6Xl4gxLoxlzpLzoEe0M2U,9924
-tests/helpers/request_response_server.py,sha256=afuuxp8slo5EqmG51AvyUkwtzqHQcGjk2UbRrDxqJS0,5090
-tests/helpers/suites.py,sha256=lTowSdX6N63b5LYATE5kYiAV3mvcPHTKvY4RV5OMAQc,18885
-tests/helpers/testdata.py,sha256=me0PolGHE9TkbW9UjMK27pHKCg_GfiLQcBUpMhqS3dM,3028
-tests/helpers/undo.py,sha256=lHQJatRsEvAzF36P06NXQz7aIBBkugKAXV_w_vawJdc,2847
-tests/helpers/util.py,sha256=Q4oc7UZ10fFod9F-fTK5xlZcf2ESh8S7djUWKOKo0k0,2728
-tests/helpers/workflows.py,sha256=x9EoctXAuS3gRaif5tj6yloOjieNVLB1wOG3gbXmgEg,1932
-mapteksdk-1.6.dist-info/METADATA,sha256=UNosish7Q5swRAQB7UOIHfJ3Z9nFMCdE1FHjbOtW5Xw,9172
-mapteksdk-1.6.dist-info/WHEEL,sha256=AtBG6SXL3KF_v0NxLf0ehyVOh0cold-JbJYXNGorC6Q,92
-mapteksdk-1.6.dist-info/top_level.txt,sha256=bw49vUW_Unw5OYpJNvvdog-z2YAVugmubjRwdLKIVvw,16
-mapteksdk-1.6.dist-info/RECORD,,
+mapteksdk/workflows/parser.py,sha256=V4a2_OWFAds6907i-8aZZVoMHr1efo8wrr3u11sTy_8,52884
+mapteksdk/workflows/workflow_selection.py,sha256=dKM3dpaqCRkZYrVSe4B265xmvJEblIc8LPGajYe-Oyo,12818
+mapteksdk/workflows/internal/__init__.py,sha256=1fuDJd2IztoKzplc1pUvQIEKAAkrrYLapUcrqjNHbH4,278
+mapteksdk/workflows/internal/converters.py,sha256=5RwM-WzCJyo0CaDiDwI8IzInq9OldUK89r5vQuhu6uQ,7132
+mapteksdk/workflows/internal/schema.py,sha256=NSoO615Pn6AUL7aGSa_NZnHS55h6A18SQXz8As2tv7A,2996
+mapteksdk-1.7.dist-info/METADATA,sha256=Pgg8JR8HcJf097kyzUU9qzHbLwMxEk90p4OVq8nrjig,9064
+mapteksdk-1.7.dist-info/WHEEL,sha256=GJ7t_kWBFywbagK5eo9IoUwLW6oyOeTKmQ-9iHFVNxQ,92
+mapteksdk-1.7.dist-info/top_level.txt,sha256=OgoVdSICEm-oMDkEjpMb5CR8awKxWTTLC_3xAFz35DI,10
+mapteksdk-1.7.dist-info/RECORD,,
```

